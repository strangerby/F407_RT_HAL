ARM GAS  C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s 			page 1


   1              		.cpu cortex-m4
   2              		.eabi_attribute 20, 1
   3              		.eabi_attribute 21, 1
   4              		.eabi_attribute 23, 3
   5              		.eabi_attribute 24, 1
   6              		.eabi_attribute 25, 1
   7              		.eabi_attribute 26, 1
   8              		.eabi_attribute 30, 1
   9              		.eabi_attribute 34, 1
  10              		.eabi_attribute 18, 4
  11              		.file	"ipc.c"
  12              		.text
  13              	.Ltext0:
  14              		.cfi_sections	.debug_frame
  15              		.section	.text.rt_sem_init,"ax",%progbits
  16              		.align	1
  17              		.global	rt_sem_init
  18              		.arch armv7e-m
  19              		.syntax unified
  20              		.thumb
  21              		.thumb_func
  22              		.fpu softvfp
  24              	rt_sem_init:
  25              	.LVL0:
  26              	.LFB19:
  27              		.file 1 "RT-Thread/src/ipc.c"
   1:RT-Thread/src/ipc.c **** /*
   2:RT-Thread/src/ipc.c ****  * Copyright (c) 2006-2018, RT-Thread Development Team
   3:RT-Thread/src/ipc.c ****  *
   4:RT-Thread/src/ipc.c ****  * SPDX-License-Identifier: Apache-2.0
   5:RT-Thread/src/ipc.c ****  *
   6:RT-Thread/src/ipc.c ****  * Change Logs:
   7:RT-Thread/src/ipc.c ****  * Date           Author       Notes
   8:RT-Thread/src/ipc.c ****  * 2006-03-14     Bernard      the first version
   9:RT-Thread/src/ipc.c ****  * 2006-04-25     Bernard      implement semaphore
  10:RT-Thread/src/ipc.c ****  * 2006-05-03     Bernard      add RT_IPC_DEBUG
  11:RT-Thread/src/ipc.c ****  *                             modify the type of IPC waiting time to rt_int32_t
  12:RT-Thread/src/ipc.c ****  * 2006-05-10     Bernard      fix the semaphore take bug and add IPC object
  13:RT-Thread/src/ipc.c ****  * 2006-05-12     Bernard      implement mailbox and message queue
  14:RT-Thread/src/ipc.c ****  * 2006-05-20     Bernard      implement mutex
  15:RT-Thread/src/ipc.c ****  * 2006-05-23     Bernard      implement fast event
  16:RT-Thread/src/ipc.c ****  * 2006-05-24     Bernard      implement event
  17:RT-Thread/src/ipc.c ****  * 2006-06-03     Bernard      fix the thread timer init bug
  18:RT-Thread/src/ipc.c ****  * 2006-06-05     Bernard      fix the mutex release bug
  19:RT-Thread/src/ipc.c ****  * 2006-06-07     Bernard      fix the message queue send bug
  20:RT-Thread/src/ipc.c ****  * 2006-08-04     Bernard      add hook support
  21:RT-Thread/src/ipc.c ****  * 2009-05-21     Yi.qiu       fix the sem release bug
  22:RT-Thread/src/ipc.c ****  * 2009-07-18     Bernard      fix the event clear bug
  23:RT-Thread/src/ipc.c ****  * 2009-09-09     Bernard      remove fast event and fix ipc release bug
  24:RT-Thread/src/ipc.c ****  * 2009-10-10     Bernard      change semaphore and mutex value to unsigned value
  25:RT-Thread/src/ipc.c ****  * 2009-10-25     Bernard      change the mb/mq receive timeout to 0 if the
  26:RT-Thread/src/ipc.c ****  *                             re-calculated delta tick is a negative number.
  27:RT-Thread/src/ipc.c ****  * 2009-12-16     Bernard      fix the rt_ipc_object_suspend issue when IPC flag
  28:RT-Thread/src/ipc.c ****  *                             is RT_IPC_FLAG_PRIO
  29:RT-Thread/src/ipc.c ****  * 2010-01-20     mbbill       remove rt_ipc_object_decrease function.
  30:RT-Thread/src/ipc.c ****  * 2010-04-20     Bernard      move memcpy outside interrupt disable in mq
  31:RT-Thread/src/ipc.c ****  * 2010-10-26     yi.qiu       add module support in rt_mp_delete and rt_mq_delete
ARM GAS  C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s 			page 2


  32:RT-Thread/src/ipc.c ****  * 2010-11-10     Bernard      add IPC reset command implementation.
  33:RT-Thread/src/ipc.c ****  * 2011-12-18     Bernard      add more parameter checking in message queue
  34:RT-Thread/src/ipc.c ****  * 2013-09-14     Grissiom     add an option check in rt_event_recv
  35:RT-Thread/src/ipc.c ****  */
  36:RT-Thread/src/ipc.c **** 
  37:RT-Thread/src/ipc.c **** #include <rtthread.h>
  38:RT-Thread/src/ipc.c **** #include <rthw.h>
  39:RT-Thread/src/ipc.c **** 
  40:RT-Thread/src/ipc.c **** #ifdef RT_USING_HOOK
  41:RT-Thread/src/ipc.c **** extern void (*rt_object_trytake_hook)(struct rt_object *object);
  42:RT-Thread/src/ipc.c **** extern void (*rt_object_take_hook)(struct rt_object *object);
  43:RT-Thread/src/ipc.c **** extern void (*rt_object_put_hook)(struct rt_object *object);
  44:RT-Thread/src/ipc.c **** #endif
  45:RT-Thread/src/ipc.c **** 
  46:RT-Thread/src/ipc.c **** /**
  47:RT-Thread/src/ipc.c ****  * @addtogroup IPC
  48:RT-Thread/src/ipc.c ****  */
  49:RT-Thread/src/ipc.c **** 
  50:RT-Thread/src/ipc.c **** /**@{*/
  51:RT-Thread/src/ipc.c **** 
  52:RT-Thread/src/ipc.c **** /**
  53:RT-Thread/src/ipc.c ****  * This function will initialize an IPC object
  54:RT-Thread/src/ipc.c ****  *
  55:RT-Thread/src/ipc.c ****  * @param ipc the IPC object
  56:RT-Thread/src/ipc.c ****  *
  57:RT-Thread/src/ipc.c ****  * @return the operation status, RT_EOK on successful
  58:RT-Thread/src/ipc.c ****  */
  59:RT-Thread/src/ipc.c **** rt_inline rt_err_t rt_ipc_object_init(struct rt_ipc_object *ipc)
  60:RT-Thread/src/ipc.c **** {
  61:RT-Thread/src/ipc.c ****     /* init ipc object */
  62:RT-Thread/src/ipc.c ****     rt_list_init(&(ipc->suspend_thread));
  63:RT-Thread/src/ipc.c **** 
  64:RT-Thread/src/ipc.c ****     return RT_EOK;
  65:RT-Thread/src/ipc.c **** }
  66:RT-Thread/src/ipc.c **** 
  67:RT-Thread/src/ipc.c **** /**
  68:RT-Thread/src/ipc.c ****  * This function will suspend a thread to a specified list. IPC object or some
  69:RT-Thread/src/ipc.c ****  * double-queue object (mailbox etc.) contains this kind of list.
  70:RT-Thread/src/ipc.c ****  *
  71:RT-Thread/src/ipc.c ****  * @param list the IPC suspended thread list
  72:RT-Thread/src/ipc.c ****  * @param thread the thread object to be suspended
  73:RT-Thread/src/ipc.c ****  * @param flag the IPC object flag,
  74:RT-Thread/src/ipc.c ****  *        which shall be RT_IPC_FLAG_FIFO/RT_IPC_FLAG_PRIO.
  75:RT-Thread/src/ipc.c ****  *
  76:RT-Thread/src/ipc.c ****  * @return the operation status, RT_EOK on successful
  77:RT-Thread/src/ipc.c ****  */
  78:RT-Thread/src/ipc.c **** rt_inline rt_err_t rt_ipc_list_suspend(rt_list_t        *list,
  79:RT-Thread/src/ipc.c ****                                        struct rt_thread *thread,
  80:RT-Thread/src/ipc.c ****                                        rt_uint8_t        flag)
  81:RT-Thread/src/ipc.c **** {
  82:RT-Thread/src/ipc.c ****     /* suspend thread */
  83:RT-Thread/src/ipc.c ****     rt_thread_suspend(thread);
  84:RT-Thread/src/ipc.c **** 
  85:RT-Thread/src/ipc.c ****     switch (flag)
  86:RT-Thread/src/ipc.c ****     {
  87:RT-Thread/src/ipc.c ****     case RT_IPC_FLAG_FIFO:
  88:RT-Thread/src/ipc.c ****         rt_list_insert_before(list, &(thread->tlist));
ARM GAS  C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s 			page 3


  89:RT-Thread/src/ipc.c ****         break;
  90:RT-Thread/src/ipc.c **** 
  91:RT-Thread/src/ipc.c ****     case RT_IPC_FLAG_PRIO:
  92:RT-Thread/src/ipc.c ****         {
  93:RT-Thread/src/ipc.c ****             struct rt_list_node *n;
  94:RT-Thread/src/ipc.c ****             struct rt_thread *sthread;
  95:RT-Thread/src/ipc.c **** 
  96:RT-Thread/src/ipc.c ****             /* find a suitable position */
  97:RT-Thread/src/ipc.c ****             for (n = list->next; n != list; n = n->next)
  98:RT-Thread/src/ipc.c ****             {
  99:RT-Thread/src/ipc.c ****                 sthread = rt_list_entry(n, struct rt_thread, tlist);
 100:RT-Thread/src/ipc.c **** 
 101:RT-Thread/src/ipc.c ****                 /* find out */
 102:RT-Thread/src/ipc.c ****                 if (thread->current_priority < sthread->current_priority)
 103:RT-Thread/src/ipc.c ****                 {
 104:RT-Thread/src/ipc.c ****                     /* insert this thread before the sthread */
 105:RT-Thread/src/ipc.c ****                     rt_list_insert_before(&(sthread->tlist), &(thread->tlist));
 106:RT-Thread/src/ipc.c ****                     break;
 107:RT-Thread/src/ipc.c ****                 }
 108:RT-Thread/src/ipc.c ****             }
 109:RT-Thread/src/ipc.c **** 
 110:RT-Thread/src/ipc.c ****             /*
 111:RT-Thread/src/ipc.c ****              * not found a suitable position,
 112:RT-Thread/src/ipc.c ****              * append to the end of suspend_thread list
 113:RT-Thread/src/ipc.c ****              */
 114:RT-Thread/src/ipc.c ****             if (n == list)
 115:RT-Thread/src/ipc.c ****                 rt_list_insert_before(list, &(thread->tlist));
 116:RT-Thread/src/ipc.c ****         }
 117:RT-Thread/src/ipc.c ****         break;
 118:RT-Thread/src/ipc.c ****     }
 119:RT-Thread/src/ipc.c **** 
 120:RT-Thread/src/ipc.c ****     return RT_EOK;
 121:RT-Thread/src/ipc.c **** }
 122:RT-Thread/src/ipc.c **** 
 123:RT-Thread/src/ipc.c **** /**
 124:RT-Thread/src/ipc.c ****  * This function will resume the first thread in the list of a IPC object:
 125:RT-Thread/src/ipc.c ****  * - remove the thread from suspend queue of IPC object
 126:RT-Thread/src/ipc.c ****  * - put the thread into system ready queue
 127:RT-Thread/src/ipc.c ****  *
 128:RT-Thread/src/ipc.c ****  * @param list the thread list
 129:RT-Thread/src/ipc.c ****  *
 130:RT-Thread/src/ipc.c ****  * @return the operation status, RT_EOK on successful
 131:RT-Thread/src/ipc.c ****  */
 132:RT-Thread/src/ipc.c **** rt_inline rt_err_t rt_ipc_list_resume(rt_list_t *list)
 133:RT-Thread/src/ipc.c **** {
 134:RT-Thread/src/ipc.c ****     struct rt_thread *thread;
 135:RT-Thread/src/ipc.c **** 
 136:RT-Thread/src/ipc.c ****     /* get thread entry */
 137:RT-Thread/src/ipc.c ****     thread = rt_list_entry(list->next, struct rt_thread, tlist);
 138:RT-Thread/src/ipc.c **** 
 139:RT-Thread/src/ipc.c ****     RT_DEBUG_LOG(RT_DEBUG_IPC, ("resume thread:%s\n", thread->name));
 140:RT-Thread/src/ipc.c **** 
 141:RT-Thread/src/ipc.c ****     /* resume it */
 142:RT-Thread/src/ipc.c ****     rt_thread_resume(thread);
 143:RT-Thread/src/ipc.c **** 
 144:RT-Thread/src/ipc.c ****     return RT_EOK;
 145:RT-Thread/src/ipc.c **** }
ARM GAS  C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s 			page 4


 146:RT-Thread/src/ipc.c **** 
 147:RT-Thread/src/ipc.c **** /**
 148:RT-Thread/src/ipc.c ****  * This function will resume all suspended threads in a list, including
 149:RT-Thread/src/ipc.c ****  * suspend list of IPC object and private list of mailbox etc.
 150:RT-Thread/src/ipc.c ****  *
 151:RT-Thread/src/ipc.c ****  * @param list of the threads to resume
 152:RT-Thread/src/ipc.c ****  *
 153:RT-Thread/src/ipc.c ****  * @return the operation status, RT_EOK on successful
 154:RT-Thread/src/ipc.c ****  */
 155:RT-Thread/src/ipc.c **** rt_inline rt_err_t rt_ipc_list_resume_all(rt_list_t *list)
 156:RT-Thread/src/ipc.c **** {
 157:RT-Thread/src/ipc.c ****     struct rt_thread *thread;
 158:RT-Thread/src/ipc.c ****     register rt_ubase_t temp;
 159:RT-Thread/src/ipc.c **** 
 160:RT-Thread/src/ipc.c ****     /* wakeup all suspend threads */
 161:RT-Thread/src/ipc.c ****     while (!rt_list_isempty(list))
 162:RT-Thread/src/ipc.c ****     {
 163:RT-Thread/src/ipc.c ****         /* disable interrupt */
 164:RT-Thread/src/ipc.c ****         temp = rt_hw_interrupt_disable();
 165:RT-Thread/src/ipc.c **** 
 166:RT-Thread/src/ipc.c ****         /* get next suspend thread */
 167:RT-Thread/src/ipc.c ****         thread = rt_list_entry(list->next, struct rt_thread, tlist);
 168:RT-Thread/src/ipc.c ****         /* set error code to RT_ERROR */
 169:RT-Thread/src/ipc.c ****         thread->error = -RT_ERROR;
 170:RT-Thread/src/ipc.c **** 
 171:RT-Thread/src/ipc.c ****         /*
 172:RT-Thread/src/ipc.c ****          * resume thread
 173:RT-Thread/src/ipc.c ****          * In rt_thread_resume function, it will remove current thread from
 174:RT-Thread/src/ipc.c ****          * suspend list
 175:RT-Thread/src/ipc.c ****          */
 176:RT-Thread/src/ipc.c ****         rt_thread_resume(thread);
 177:RT-Thread/src/ipc.c **** 
 178:RT-Thread/src/ipc.c ****         /* enable interrupt */
 179:RT-Thread/src/ipc.c ****         rt_hw_interrupt_enable(temp);
 180:RT-Thread/src/ipc.c ****     }
 181:RT-Thread/src/ipc.c **** 
 182:RT-Thread/src/ipc.c ****     return RT_EOK;
 183:RT-Thread/src/ipc.c **** }
 184:RT-Thread/src/ipc.c **** 
 185:RT-Thread/src/ipc.c **** #ifdef RT_USING_SEMAPHORE
 186:RT-Thread/src/ipc.c **** /**
 187:RT-Thread/src/ipc.c ****  * This function will initialize a semaphore and put it under control of
 188:RT-Thread/src/ipc.c ****  * resource management.
 189:RT-Thread/src/ipc.c ****  *
 190:RT-Thread/src/ipc.c ****  * @param sem the semaphore object
 191:RT-Thread/src/ipc.c ****  * @param name the name of semaphore
 192:RT-Thread/src/ipc.c ****  * @param value the init value of semaphore
 193:RT-Thread/src/ipc.c ****  * @param flag the flag of semaphore
 194:RT-Thread/src/ipc.c ****  *
 195:RT-Thread/src/ipc.c ****  * @return the operation status, RT_EOK on successful
 196:RT-Thread/src/ipc.c ****  */
 197:RT-Thread/src/ipc.c **** rt_err_t rt_sem_init(rt_sem_t    sem,
 198:RT-Thread/src/ipc.c ****                      const char *name,
 199:RT-Thread/src/ipc.c ****                      rt_uint32_t value,
 200:RT-Thread/src/ipc.c ****                      rt_uint8_t  flag)
 201:RT-Thread/src/ipc.c **** {
  28              		.loc 1 201 1 view -0
ARM GAS  C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s 			page 5


  29              		.cfi_startproc
  30              		@ args = 0, pretend = 0, frame = 0
  31              		@ frame_needed = 0, uses_anonymous_args = 0
  32              		.loc 1 201 1 is_stmt 0 view .LVU1
  33 0000 70B5     		push	{r4, r5, r6, lr}
  34              	.LCFI0:
  35              		.cfi_def_cfa_offset 16
  36              		.cfi_offset 4, -16
  37              		.cfi_offset 5, -12
  38              		.cfi_offset 6, -8
  39              		.cfi_offset 14, -4
  40 0002 0446     		mov	r4, r0
  41 0004 1646     		mov	r6, r2
  42 0006 1D46     		mov	r5, r3
 202:RT-Thread/src/ipc.c ****     RT_ASSERT(sem != RT_NULL);
  43              		.loc 1 202 30 is_stmt 1 view .LVU2
 203:RT-Thread/src/ipc.c ****     RT_ASSERT(value < 0x10000U);
  44              		.loc 1 203 32 view .LVU3
 204:RT-Thread/src/ipc.c **** 
 205:RT-Thread/src/ipc.c ****     /* init object */
 206:RT-Thread/src/ipc.c ****     rt_object_init(&(sem->parent.parent), RT_Object_Class_Semaphore, name);
  45              		.loc 1 206 5 view .LVU4
  46 0008 0A46     		mov	r2, r1
  47              	.LVL1:
  48              		.loc 1 206 5 is_stmt 0 view .LVU5
  49 000a 0221     		movs	r1, #2
  50              	.LVL2:
  51              		.loc 1 206 5 view .LVU6
  52 000c FFF7FEFF 		bl	rt_object_init
  53              	.LVL3:
 207:RT-Thread/src/ipc.c **** 
 208:RT-Thread/src/ipc.c ****     /* init ipc object */
 209:RT-Thread/src/ipc.c ****     rt_ipc_object_init(&(sem->parent));
  54              		.loc 1 209 5 is_stmt 1 view .LVU7
  55              	.LBB47:
  56              	.LBI47:
  59:RT-Thread/src/ipc.c **** {
  57              		.loc 1 59 20 view .LVU8
  58              	.LBB48:
  62:RT-Thread/src/ipc.c **** 
  59              		.loc 1 62 5 view .LVU9
  60 0010 04F11403 		add	r3, r4, #20
  61              	.LVL4:
  62              	.LBB49:
  63              	.LBI49:
  64              		.file 2 "RT-Thread/include/rtservice.h"
   1:RT-Thread/include/rtservice.h **** /*
   2:RT-Thread/include/rtservice.h ****  * Copyright (c) 2006-2018, RT-Thread Development Team
   3:RT-Thread/include/rtservice.h ****  *
   4:RT-Thread/include/rtservice.h ****  * SPDX-License-Identifier: Apache-2.0
   5:RT-Thread/include/rtservice.h ****  *
   6:RT-Thread/include/rtservice.h ****  * Change Logs:
   7:RT-Thread/include/rtservice.h ****  * Date           Author       Notes
   8:RT-Thread/include/rtservice.h ****  * 2006-03-16     Bernard      the first version
   9:RT-Thread/include/rtservice.h ****  * 2006-09-07     Bernard      move the kservice APIs to rtthread.h
  10:RT-Thread/include/rtservice.h ****  * 2007-06-27     Bernard      fix the rt_list_remove bug
  11:RT-Thread/include/rtservice.h ****  * 2012-03-22     Bernard      rename kservice.h to rtservice.h
ARM GAS  C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s 			page 6


  12:RT-Thread/include/rtservice.h ****  * 2017-11-15     JasonJia     Modify rt_slist_foreach to rt_slist_for_each_entry.
  13:RT-Thread/include/rtservice.h ****  *                             Make code cleanup.
  14:RT-Thread/include/rtservice.h ****  */
  15:RT-Thread/include/rtservice.h **** 
  16:RT-Thread/include/rtservice.h **** #ifndef __RT_SERVICE_H__
  17:RT-Thread/include/rtservice.h **** #define __RT_SERVICE_H__
  18:RT-Thread/include/rtservice.h **** 
  19:RT-Thread/include/rtservice.h **** #ifdef __cplusplus
  20:RT-Thread/include/rtservice.h **** extern "C" {
  21:RT-Thread/include/rtservice.h **** #endif
  22:RT-Thread/include/rtservice.h **** 
  23:RT-Thread/include/rtservice.h **** /**
  24:RT-Thread/include/rtservice.h ****  * @addtogroup KernelService
  25:RT-Thread/include/rtservice.h ****  */
  26:RT-Thread/include/rtservice.h **** 
  27:RT-Thread/include/rtservice.h **** /**@{*/
  28:RT-Thread/include/rtservice.h **** 
  29:RT-Thread/include/rtservice.h **** /**
  30:RT-Thread/include/rtservice.h ****  * rt_container_of - return the member address of ptr, if the type of ptr is the
  31:RT-Thread/include/rtservice.h ****  * struct type.
  32:RT-Thread/include/rtservice.h ****  */
  33:RT-Thread/include/rtservice.h **** #define rt_container_of(ptr, type, member) \
  34:RT-Thread/include/rtservice.h ****     ((type *)((char *)(ptr) - (unsigned long)(&((type *)0)->member)))
  35:RT-Thread/include/rtservice.h **** 
  36:RT-Thread/include/rtservice.h **** 
  37:RT-Thread/include/rtservice.h **** /**
  38:RT-Thread/include/rtservice.h ****  * @brief initialize a list object
  39:RT-Thread/include/rtservice.h ****  */
  40:RT-Thread/include/rtservice.h **** #define RT_LIST_OBJECT_INIT(object) { &(object), &(object) }
  41:RT-Thread/include/rtservice.h **** 
  42:RT-Thread/include/rtservice.h **** /**
  43:RT-Thread/include/rtservice.h ****  * @brief initialize a list
  44:RT-Thread/include/rtservice.h ****  *
  45:RT-Thread/include/rtservice.h ****  * @param l list to be initialized
  46:RT-Thread/include/rtservice.h ****  */
  47:RT-Thread/include/rtservice.h **** rt_inline void rt_list_init(rt_list_t *l)
  65              		.loc 2 47 16 view .LVU10
  66              	.LBB50:
  48:RT-Thread/include/rtservice.h **** {
  49:RT-Thread/include/rtservice.h ****     l->next = l->prev = l;
  67              		.loc 2 49 5 view .LVU11
  68              		.loc 2 49 23 is_stmt 0 view .LVU12
  69 0014 A361     		str	r3, [r4, #24]
  70              		.loc 2 49 13 view .LVU13
  71 0016 6361     		str	r3, [r4, #20]
  72              	.LVL5:
  73              		.loc 2 49 13 view .LVU14
  74              	.LBE50:
  75              	.LBE49:
  64:RT-Thread/src/ipc.c **** }
  76              		.loc 1 64 5 is_stmt 1 view .LVU15
  64:RT-Thread/src/ipc.c **** }
  77              		.loc 1 64 5 is_stmt 0 view .LVU16
  78              	.LBE48:
  79              	.LBE47:
 210:RT-Thread/src/ipc.c **** 
 211:RT-Thread/src/ipc.c ****     /* set init value */
ARM GAS  C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s 			page 7


 212:RT-Thread/src/ipc.c ****     sem->value = (rt_uint16_t)value;
  80              		.loc 1 212 5 is_stmt 1 view .LVU17
  81              		.loc 1 212 16 is_stmt 0 view .LVU18
  82 0018 A683     		strh	r6, [r4, #28]	@ movhi
 213:RT-Thread/src/ipc.c **** 
 214:RT-Thread/src/ipc.c ****     /* set parent */
 215:RT-Thread/src/ipc.c ****     sem->parent.parent.flag = flag;
  83              		.loc 1 215 5 is_stmt 1 view .LVU19
  84              		.loc 1 215 29 is_stmt 0 view .LVU20
  85 001a 6572     		strb	r5, [r4, #9]
 216:RT-Thread/src/ipc.c **** 
 217:RT-Thread/src/ipc.c ****     return RT_EOK;
  86              		.loc 1 217 5 is_stmt 1 view .LVU21
 218:RT-Thread/src/ipc.c **** }
  87              		.loc 1 218 1 is_stmt 0 view .LVU22
  88 001c 0020     		movs	r0, #0
  89 001e 70BD     		pop	{r4, r5, r6, pc}
  90              		.loc 1 218 1 view .LVU23
  91              		.cfi_endproc
  92              	.LFE19:
  94              		.section	.text.rt_sem_detach,"ax",%progbits
  95              		.align	1
  96              		.global	rt_sem_detach
  97              		.syntax unified
  98              		.thumb
  99              		.thumb_func
 100              		.fpu softvfp
 102              	rt_sem_detach:
 103              	.LVL6:
 104              	.LFB20:
 219:RT-Thread/src/ipc.c **** RTM_EXPORT(rt_sem_init);
 220:RT-Thread/src/ipc.c **** 
 221:RT-Thread/src/ipc.c **** /**
 222:RT-Thread/src/ipc.c ****  * This function will detach a semaphore from resource management
 223:RT-Thread/src/ipc.c ****  *
 224:RT-Thread/src/ipc.c ****  * @param sem the semaphore object
 225:RT-Thread/src/ipc.c ****  *
 226:RT-Thread/src/ipc.c ****  * @return the operation status, RT_EOK on successful
 227:RT-Thread/src/ipc.c ****  *
 228:RT-Thread/src/ipc.c ****  * @see rt_sem_delete
 229:RT-Thread/src/ipc.c ****  */
 230:RT-Thread/src/ipc.c **** rt_err_t rt_sem_detach(rt_sem_t sem)
 231:RT-Thread/src/ipc.c **** {
 105              		.loc 1 231 1 is_stmt 1 view -0
 106              		.cfi_startproc
 107              		@ args = 0, pretend = 0, frame = 0
 108              		@ frame_needed = 0, uses_anonymous_args = 0
 109              		.loc 1 231 1 is_stmt 0 view .LVU25
 110 0000 70B5     		push	{r4, r5, r6, lr}
 111              	.LCFI1:
 112              		.cfi_def_cfa_offset 16
 113              		.cfi_offset 4, -16
 114              		.cfi_offset 5, -12
 115              		.cfi_offset 6, -8
 116              		.cfi_offset 14, -4
 117 0002 0446     		mov	r4, r0
 232:RT-Thread/src/ipc.c ****     /* parameter check */
ARM GAS  C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s 			page 8


 233:RT-Thread/src/ipc.c ****     RT_ASSERT(sem != RT_NULL);
 118              		.loc 1 233 30 is_stmt 1 view .LVU26
 234:RT-Thread/src/ipc.c ****     RT_ASSERT(rt_object_get_type(&sem->parent.parent) == RT_Object_Class_Semaphore);
 119              		.loc 1 234 84 view .LVU27
 235:RT-Thread/src/ipc.c ****     RT_ASSERT(rt_object_is_systemobject(&sem->parent.parent));
 120              		.loc 1 235 62 view .LVU28
 236:RT-Thread/src/ipc.c **** 
 237:RT-Thread/src/ipc.c ****     /* wakeup all suspend threads */
 238:RT-Thread/src/ipc.c ****     rt_ipc_list_resume_all(&(sem->parent.suspend_thread));
 121              		.loc 1 238 5 view .LVU29
 122 0004 00F11405 		add	r5, r0, #20
 123              	.LVL7:
 124              	.LBB55:
 125              	.LBI55:
 155:RT-Thread/src/ipc.c **** {
 126              		.loc 1 155 20 view .LVU30
 127              	.LBB56:
 157:RT-Thread/src/ipc.c ****     register rt_ubase_t temp;
 128              		.loc 1 157 5 view .LVU31
 158:RT-Thread/src/ipc.c **** 
 129              		.loc 1 158 5 view .LVU32
 161:RT-Thread/src/ipc.c ****     {
 130              		.loc 1 161 5 view .LVU33
 131              	.L4:
 161:RT-Thread/src/ipc.c ****     {
 132              		.loc 1 161 11 view .LVU34
 133              	.LBB57:
 134              	.LBI57:
  50:RT-Thread/include/rtservice.h **** }
  51:RT-Thread/include/rtservice.h **** 
  52:RT-Thread/include/rtservice.h **** /**
  53:RT-Thread/include/rtservice.h ****  * @brief insert a node after a list
  54:RT-Thread/include/rtservice.h ****  *
  55:RT-Thread/include/rtservice.h ****  * @param l list to insert it
  56:RT-Thread/include/rtservice.h ****  * @param n new node to be inserted
  57:RT-Thread/include/rtservice.h ****  */
  58:RT-Thread/include/rtservice.h **** rt_inline void rt_list_insert_after(rt_list_t *l, rt_list_t *n)
  59:RT-Thread/include/rtservice.h **** {
  60:RT-Thread/include/rtservice.h ****     l->next->prev = n;
  61:RT-Thread/include/rtservice.h ****     n->next = l->next;
  62:RT-Thread/include/rtservice.h **** 
  63:RT-Thread/include/rtservice.h ****     l->next = n;
  64:RT-Thread/include/rtservice.h ****     n->prev = l;
  65:RT-Thread/include/rtservice.h **** }
  66:RT-Thread/include/rtservice.h **** 
  67:RT-Thread/include/rtservice.h **** /**
  68:RT-Thread/include/rtservice.h ****  * @brief insert a node before a list
  69:RT-Thread/include/rtservice.h ****  *
  70:RT-Thread/include/rtservice.h ****  * @param n new node to be inserted
  71:RT-Thread/include/rtservice.h ****  * @param l list to insert it
  72:RT-Thread/include/rtservice.h ****  */
  73:RT-Thread/include/rtservice.h **** rt_inline void rt_list_insert_before(rt_list_t *l, rt_list_t *n)
  74:RT-Thread/include/rtservice.h **** {
  75:RT-Thread/include/rtservice.h ****     l->prev->next = n;
  76:RT-Thread/include/rtservice.h ****     n->prev = l->prev;
  77:RT-Thread/include/rtservice.h **** 
  78:RT-Thread/include/rtservice.h ****     l->prev = n;
ARM GAS  C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s 			page 9


  79:RT-Thread/include/rtservice.h ****     n->next = l;
  80:RT-Thread/include/rtservice.h **** }
  81:RT-Thread/include/rtservice.h **** 
  82:RT-Thread/include/rtservice.h **** /**
  83:RT-Thread/include/rtservice.h ****  * @brief remove node from list.
  84:RT-Thread/include/rtservice.h ****  * @param n the node to remove from the list.
  85:RT-Thread/include/rtservice.h ****  */
  86:RT-Thread/include/rtservice.h **** rt_inline void rt_list_remove(rt_list_t *n)
  87:RT-Thread/include/rtservice.h **** {
  88:RT-Thread/include/rtservice.h ****     n->next->prev = n->prev;
  89:RT-Thread/include/rtservice.h ****     n->prev->next = n->next;
  90:RT-Thread/include/rtservice.h **** 
  91:RT-Thread/include/rtservice.h ****     n->next = n->prev = n;
  92:RT-Thread/include/rtservice.h **** }
  93:RT-Thread/include/rtservice.h **** 
  94:RT-Thread/include/rtservice.h **** /**
  95:RT-Thread/include/rtservice.h ****  * @brief tests whether a list is empty
  96:RT-Thread/include/rtservice.h ****  * @param l the list to test.
  97:RT-Thread/include/rtservice.h ****  */
  98:RT-Thread/include/rtservice.h **** rt_inline int rt_list_isempty(const rt_list_t *l)
 135              		.loc 2 98 15 view .LVU35
 136              	.LBB58:
  99:RT-Thread/include/rtservice.h **** {
 100:RT-Thread/include/rtservice.h ****     return l->next == l;
 137              		.loc 2 100 5 view .LVU36
 138              		.loc 2 100 13 is_stmt 0 view .LVU37
 139 0008 2B68     		ldr	r3, [r5]
 140              	.LVL8:
 141              		.loc 2 100 13 view .LVU38
 142              	.LBE58:
 143              	.LBE57:
 161:RT-Thread/src/ipc.c ****     {
 144              		.loc 1 161 11 view .LVU39
 145 000a 9D42     		cmp	r5, r3
 146 000c 0DD0     		beq	.L7
 164:RT-Thread/src/ipc.c **** 
 147              		.loc 1 164 9 is_stmt 1 view .LVU40
 164:RT-Thread/src/ipc.c **** 
 148              		.loc 1 164 16 is_stmt 0 view .LVU41
 149 000e FFF7FEFF 		bl	rt_hw_interrupt_disable
 150              	.LVL9:
 151 0012 0646     		mov	r6, r0
 152              	.LVL10:
 167:RT-Thread/src/ipc.c ****         /* set error code to RT_ERROR */
 153              		.loc 1 167 9 is_stmt 1 view .LVU42
 167:RT-Thread/src/ipc.c ****         /* set error code to RT_ERROR */
 154              		.loc 1 167 18 is_stmt 0 view .LVU43
 155 0014 2868     		ldr	r0, [r5]
 156              	.LVL11:
 169:RT-Thread/src/ipc.c **** 
 157              		.loc 1 169 9 is_stmt 1 view .LVU44
 169:RT-Thread/src/ipc.c **** 
 158              		.loc 1 169 23 is_stmt 0 view .LVU45
 159 0016 4FF0FF33 		mov	r3, #-1
 160 001a C361     		str	r3, [r0, #28]
 176:RT-Thread/src/ipc.c **** 
 161              		.loc 1 176 9 is_stmt 1 view .LVU46
ARM GAS  C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s 			page 10


 162 001c 1438     		subs	r0, r0, #20
 163              	.LVL12:
 176:RT-Thread/src/ipc.c **** 
 164              		.loc 1 176 9 is_stmt 0 view .LVU47
 165 001e FFF7FEFF 		bl	rt_thread_resume
 166              	.LVL13:
 179:RT-Thread/src/ipc.c ****     }
 167              		.loc 1 179 9 is_stmt 1 view .LVU48
 168 0022 3046     		mov	r0, r6
 169 0024 FFF7FEFF 		bl	rt_hw_interrupt_enable
 170              	.LVL14:
 171 0028 EEE7     		b	.L4
 172              	.LVL15:
 173              	.L7:
 182:RT-Thread/src/ipc.c **** }
 174              		.loc 1 182 5 view .LVU49
 182:RT-Thread/src/ipc.c **** }
 175              		.loc 1 182 5 is_stmt 0 view .LVU50
 176              	.LBE56:
 177              	.LBE55:
 239:RT-Thread/src/ipc.c **** 
 240:RT-Thread/src/ipc.c ****     /* detach semaphore object */
 241:RT-Thread/src/ipc.c ****     rt_object_detach(&(sem->parent.parent));
 178              		.loc 1 241 5 is_stmt 1 view .LVU51
 179 002a 2046     		mov	r0, r4
 180 002c FFF7FEFF 		bl	rt_object_detach
 181              	.LVL16:
 242:RT-Thread/src/ipc.c **** 
 243:RT-Thread/src/ipc.c ****     return RT_EOK;
 182              		.loc 1 243 5 view .LVU52
 244:RT-Thread/src/ipc.c **** }
 183              		.loc 1 244 1 is_stmt 0 view .LVU53
 184 0030 0020     		movs	r0, #0
 185 0032 70BD     		pop	{r4, r5, r6, pc}
 186              		.loc 1 244 1 view .LVU54
 187              		.cfi_endproc
 188              	.LFE20:
 190              		.section	.text.rt_sem_create,"ax",%progbits
 191              		.align	1
 192              		.global	rt_sem_create
 193              		.syntax unified
 194              		.thumb
 195              		.thumb_func
 196              		.fpu softvfp
 198              	rt_sem_create:
 199              	.LVL17:
 200              	.LFB21:
 245:RT-Thread/src/ipc.c **** RTM_EXPORT(rt_sem_detach);
 246:RT-Thread/src/ipc.c **** 
 247:RT-Thread/src/ipc.c **** #ifdef RT_USING_HEAP
 248:RT-Thread/src/ipc.c **** /**
 249:RT-Thread/src/ipc.c ****  * This function will create a semaphore from system resource
 250:RT-Thread/src/ipc.c ****  *
 251:RT-Thread/src/ipc.c ****  * @param name the name of semaphore
 252:RT-Thread/src/ipc.c ****  * @param value the init value of semaphore
 253:RT-Thread/src/ipc.c ****  * @param flag the flag of semaphore
 254:RT-Thread/src/ipc.c ****  *
ARM GAS  C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s 			page 11


 255:RT-Thread/src/ipc.c ****  * @return the created semaphore, RT_NULL on error happen
 256:RT-Thread/src/ipc.c ****  *
 257:RT-Thread/src/ipc.c ****  * @see rt_sem_init
 258:RT-Thread/src/ipc.c ****  */
 259:RT-Thread/src/ipc.c **** rt_sem_t rt_sem_create(const char *name, rt_uint32_t value, rt_uint8_t flag)
 260:RT-Thread/src/ipc.c **** {
 201              		.loc 1 260 1 is_stmt 1 view -0
 202              		.cfi_startproc
 203              		@ args = 0, pretend = 0, frame = 0
 204              		@ frame_needed = 0, uses_anonymous_args = 0
 205              		.loc 1 260 1 is_stmt 0 view .LVU56
 206 0000 38B5     		push	{r3, r4, r5, lr}
 207              	.LCFI2:
 208              		.cfi_def_cfa_offset 16
 209              		.cfi_offset 3, -16
 210              		.cfi_offset 4, -12
 211              		.cfi_offset 5, -8
 212              		.cfi_offset 14, -4
 213 0002 0D46     		mov	r5, r1
 214 0004 1446     		mov	r4, r2
 261:RT-Thread/src/ipc.c ****     rt_sem_t sem;
 215              		.loc 1 261 5 is_stmt 1 view .LVU57
 262:RT-Thread/src/ipc.c **** 
 263:RT-Thread/src/ipc.c ****     RT_DEBUG_NOT_IN_INTERRUPT;
 216              		.loc 1 263 30 view .LVU58
 264:RT-Thread/src/ipc.c ****     RT_ASSERT(value < 0x10000U);
 217              		.loc 1 264 32 view .LVU59
 265:RT-Thread/src/ipc.c **** 
 266:RT-Thread/src/ipc.c ****     /* allocate object */
 267:RT-Thread/src/ipc.c ****     sem = (rt_sem_t)rt_object_allocate(RT_Object_Class_Semaphore, name);
 218              		.loc 1 267 5 view .LVU60
 219              		.loc 1 267 21 is_stmt 0 view .LVU61
 220 0006 0146     		mov	r1, r0
 221              	.LVL18:
 222              		.loc 1 267 21 view .LVU62
 223 0008 0220     		movs	r0, #2
 224              	.LVL19:
 225              		.loc 1 267 21 view .LVU63
 226 000a FFF7FEFF 		bl	rt_object_allocate
 227              	.LVL20:
 268:RT-Thread/src/ipc.c ****     if (sem == RT_NULL)
 228              		.loc 1 268 5 is_stmt 1 view .LVU64
 229              		.loc 1 268 8 is_stmt 0 view .LVU65
 230 000e 0346     		mov	r3, r0
 231 0010 28B1     		cbz	r0, .L8
 269:RT-Thread/src/ipc.c ****         return sem;
 270:RT-Thread/src/ipc.c **** 
 271:RT-Thread/src/ipc.c ****     /* init ipc object */
 272:RT-Thread/src/ipc.c ****     rt_ipc_object_init(&(sem->parent));
 232              		.loc 1 272 5 is_stmt 1 view .LVU66
 233              	.LVL21:
 234              	.LBB59:
 235              	.LBI59:
  59:RT-Thread/src/ipc.c **** {
 236              		.loc 1 59 20 view .LVU67
 237              	.LBB60:
  62:RT-Thread/src/ipc.c **** 
ARM GAS  C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s 			page 12


 238              		.loc 1 62 5 view .LVU68
 239 0012 00F11402 		add	r2, r0, #20
 240              	.LVL22:
 241              	.LBB61:
 242              	.LBI61:
  47:RT-Thread/include/rtservice.h **** {
 243              		.loc 2 47 16 view .LVU69
 244              	.LBB62:
  49:RT-Thread/include/rtservice.h **** }
 245              		.loc 2 49 5 view .LVU70
  49:RT-Thread/include/rtservice.h **** }
 246              		.loc 2 49 23 is_stmt 0 view .LVU71
 247 0016 8261     		str	r2, [r0, #24]
  49:RT-Thread/include/rtservice.h **** }
 248              		.loc 2 49 13 view .LVU72
 249 0018 4261     		str	r2, [r0, #20]
 250              	.LVL23:
  49:RT-Thread/include/rtservice.h **** }
 251              		.loc 2 49 13 view .LVU73
 252              	.LBE62:
 253              	.LBE61:
  64:RT-Thread/src/ipc.c **** }
 254              		.loc 1 64 5 is_stmt 1 view .LVU74
  64:RT-Thread/src/ipc.c **** }
 255              		.loc 1 64 5 is_stmt 0 view .LVU75
 256              	.LBE60:
 257              	.LBE59:
 273:RT-Thread/src/ipc.c **** 
 274:RT-Thread/src/ipc.c ****     /* set init value */
 275:RT-Thread/src/ipc.c ****     sem->value = value;
 258              		.loc 1 275 5 is_stmt 1 view .LVU76
 259              		.loc 1 275 16 is_stmt 0 view .LVU77
 260 001a 8583     		strh	r5, [r0, #28]	@ movhi
 276:RT-Thread/src/ipc.c **** 
 277:RT-Thread/src/ipc.c ****     /* set parent */
 278:RT-Thread/src/ipc.c ****     sem->parent.parent.flag = flag;
 261              		.loc 1 278 5 is_stmt 1 view .LVU78
 262              		.loc 1 278 29 is_stmt 0 view .LVU79
 263 001c 4472     		strb	r4, [r0, #9]
 279:RT-Thread/src/ipc.c **** 
 280:RT-Thread/src/ipc.c ****     return sem;
 264              		.loc 1 280 5 is_stmt 1 view .LVU80
 265              	.L8:
 281:RT-Thread/src/ipc.c **** }
 266              		.loc 1 281 1 is_stmt 0 view .LVU81
 267 001e 1846     		mov	r0, r3
 268              	.LVL24:
 269              		.loc 1 281 1 view .LVU82
 270 0020 38BD     		pop	{r3, r4, r5, pc}
 271              		.loc 1 281 1 view .LVU83
 272              		.cfi_endproc
 273              	.LFE21:
 275              		.section	.text.rt_sem_delete,"ax",%progbits
 276              		.align	1
 277              		.global	rt_sem_delete
 278              		.syntax unified
 279              		.thumb
ARM GAS  C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s 			page 13


 280              		.thumb_func
 281              		.fpu softvfp
 283              	rt_sem_delete:
 284              	.LVL25:
 285              	.LFB22:
 282:RT-Thread/src/ipc.c **** RTM_EXPORT(rt_sem_create);
 283:RT-Thread/src/ipc.c **** 
 284:RT-Thread/src/ipc.c **** /**
 285:RT-Thread/src/ipc.c ****  * This function will delete a semaphore object and release the memory
 286:RT-Thread/src/ipc.c ****  *
 287:RT-Thread/src/ipc.c ****  * @param sem the semaphore object
 288:RT-Thread/src/ipc.c ****  *
 289:RT-Thread/src/ipc.c ****  * @return the error code
 290:RT-Thread/src/ipc.c ****  *
 291:RT-Thread/src/ipc.c ****  * @see rt_sem_detach
 292:RT-Thread/src/ipc.c ****  */
 293:RT-Thread/src/ipc.c **** rt_err_t rt_sem_delete(rt_sem_t sem)
 294:RT-Thread/src/ipc.c **** {
 286              		.loc 1 294 1 is_stmt 1 view -0
 287              		.cfi_startproc
 288              		@ args = 0, pretend = 0, frame = 0
 289              		@ frame_needed = 0, uses_anonymous_args = 0
 290              		.loc 1 294 1 is_stmt 0 view .LVU85
 291 0000 70B5     		push	{r4, r5, r6, lr}
 292              	.LCFI3:
 293              		.cfi_def_cfa_offset 16
 294              		.cfi_offset 4, -16
 295              		.cfi_offset 5, -12
 296              		.cfi_offset 6, -8
 297              		.cfi_offset 14, -4
 298 0002 0446     		mov	r4, r0
 295:RT-Thread/src/ipc.c ****     RT_DEBUG_NOT_IN_INTERRUPT;
 299              		.loc 1 295 30 is_stmt 1 view .LVU86
 296:RT-Thread/src/ipc.c **** 
 297:RT-Thread/src/ipc.c ****     /* parameter check */
 298:RT-Thread/src/ipc.c ****     RT_ASSERT(sem != RT_NULL);
 300              		.loc 1 298 30 view .LVU87
 299:RT-Thread/src/ipc.c ****     RT_ASSERT(rt_object_get_type(&sem->parent.parent) == RT_Object_Class_Semaphore);
 301              		.loc 1 299 84 view .LVU88
 300:RT-Thread/src/ipc.c ****     RT_ASSERT(rt_object_is_systemobject(&sem->parent.parent) == RT_FALSE);
 302              		.loc 1 300 74 view .LVU89
 301:RT-Thread/src/ipc.c **** 
 302:RT-Thread/src/ipc.c ****     /* wakeup all suspend threads */
 303:RT-Thread/src/ipc.c ****     rt_ipc_list_resume_all(&(sem->parent.suspend_thread));
 303              		.loc 1 303 5 view .LVU90
 304 0004 00F11405 		add	r5, r0, #20
 305              	.LVL26:
 306              	.LBB67:
 307              	.LBI67:
 155:RT-Thread/src/ipc.c **** {
 308              		.loc 1 155 20 view .LVU91
 309              	.LBB68:
 157:RT-Thread/src/ipc.c ****     register rt_ubase_t temp;
 310              		.loc 1 157 5 view .LVU92
 158:RT-Thread/src/ipc.c **** 
 311              		.loc 1 158 5 view .LVU93
 161:RT-Thread/src/ipc.c ****     {
ARM GAS  C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s 			page 14


 312              		.loc 1 161 5 view .LVU94
 313              	.L12:
 161:RT-Thread/src/ipc.c ****     {
 314              		.loc 1 161 11 view .LVU95
 315              	.LBB69:
 316              	.LBI69:
  98:RT-Thread/include/rtservice.h **** {
 317              		.loc 2 98 15 view .LVU96
 318              	.LBB70:
 319              		.loc 2 100 5 view .LVU97
 320              		.loc 2 100 13 is_stmt 0 view .LVU98
 321 0008 2B68     		ldr	r3, [r5]
 322              	.LVL27:
 323              		.loc 2 100 13 view .LVU99
 324              	.LBE70:
 325              	.LBE69:
 161:RT-Thread/src/ipc.c ****     {
 326              		.loc 1 161 11 view .LVU100
 327 000a 9D42     		cmp	r5, r3
 328 000c 0DD0     		beq	.L15
 164:RT-Thread/src/ipc.c **** 
 329              		.loc 1 164 9 is_stmt 1 view .LVU101
 164:RT-Thread/src/ipc.c **** 
 330              		.loc 1 164 16 is_stmt 0 view .LVU102
 331 000e FFF7FEFF 		bl	rt_hw_interrupt_disable
 332              	.LVL28:
 333 0012 0646     		mov	r6, r0
 334              	.LVL29:
 167:RT-Thread/src/ipc.c ****         /* set error code to RT_ERROR */
 335              		.loc 1 167 9 is_stmt 1 view .LVU103
 167:RT-Thread/src/ipc.c ****         /* set error code to RT_ERROR */
 336              		.loc 1 167 18 is_stmt 0 view .LVU104
 337 0014 2868     		ldr	r0, [r5]
 338              	.LVL30:
 169:RT-Thread/src/ipc.c **** 
 339              		.loc 1 169 9 is_stmt 1 view .LVU105
 169:RT-Thread/src/ipc.c **** 
 340              		.loc 1 169 23 is_stmt 0 view .LVU106
 341 0016 4FF0FF33 		mov	r3, #-1
 342 001a C361     		str	r3, [r0, #28]
 176:RT-Thread/src/ipc.c **** 
 343              		.loc 1 176 9 is_stmt 1 view .LVU107
 344 001c 1438     		subs	r0, r0, #20
 345              	.LVL31:
 176:RT-Thread/src/ipc.c **** 
 346              		.loc 1 176 9 is_stmt 0 view .LVU108
 347 001e FFF7FEFF 		bl	rt_thread_resume
 348              	.LVL32:
 179:RT-Thread/src/ipc.c ****     }
 349              		.loc 1 179 9 is_stmt 1 view .LVU109
 350 0022 3046     		mov	r0, r6
 351 0024 FFF7FEFF 		bl	rt_hw_interrupt_enable
 352              	.LVL33:
 353 0028 EEE7     		b	.L12
 354              	.LVL34:
 355              	.L15:
 182:RT-Thread/src/ipc.c **** }
ARM GAS  C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s 			page 15


 356              		.loc 1 182 5 view .LVU110
 182:RT-Thread/src/ipc.c **** }
 357              		.loc 1 182 5 is_stmt 0 view .LVU111
 358              	.LBE68:
 359              	.LBE67:
 304:RT-Thread/src/ipc.c **** 
 305:RT-Thread/src/ipc.c ****     /* delete semaphore object */
 306:RT-Thread/src/ipc.c ****     rt_object_delete(&(sem->parent.parent));
 360              		.loc 1 306 5 is_stmt 1 view .LVU112
 361 002a 2046     		mov	r0, r4
 362 002c FFF7FEFF 		bl	rt_object_delete
 363              	.LVL35:
 307:RT-Thread/src/ipc.c **** 
 308:RT-Thread/src/ipc.c ****     return RT_EOK;
 364              		.loc 1 308 5 view .LVU113
 309:RT-Thread/src/ipc.c **** }
 365              		.loc 1 309 1 is_stmt 0 view .LVU114
 366 0030 0020     		movs	r0, #0
 367 0032 70BD     		pop	{r4, r5, r6, pc}
 368              		.loc 1 309 1 view .LVU115
 369              		.cfi_endproc
 370              	.LFE22:
 372              		.section	.text.rt_sem_take,"ax",%progbits
 373              		.align	1
 374              		.global	rt_sem_take
 375              		.syntax unified
 376              		.thumb
 377              		.thumb_func
 378              		.fpu softvfp
 380              	rt_sem_take:
 381              	.LVL36:
 382              	.LFB23:
 310:RT-Thread/src/ipc.c **** RTM_EXPORT(rt_sem_delete);
 311:RT-Thread/src/ipc.c **** #endif
 312:RT-Thread/src/ipc.c **** 
 313:RT-Thread/src/ipc.c **** /**
 314:RT-Thread/src/ipc.c ****  * This function will take a semaphore, if the semaphore is unavailable, the
 315:RT-Thread/src/ipc.c ****  * thread shall wait for a specified time.
 316:RT-Thread/src/ipc.c ****  *
 317:RT-Thread/src/ipc.c ****  * @param sem the semaphore object
 318:RT-Thread/src/ipc.c ****  * @param time the waiting time
 319:RT-Thread/src/ipc.c ****  *
 320:RT-Thread/src/ipc.c ****  * @return the error code
 321:RT-Thread/src/ipc.c ****  */
 322:RT-Thread/src/ipc.c **** rt_err_t rt_sem_take(rt_sem_t sem, rt_int32_t time)
 323:RT-Thread/src/ipc.c **** {
 383              		.loc 1 323 1 is_stmt 1 view -0
 384              		.cfi_startproc
 385              		@ args = 0, pretend = 0, frame = 8
 386              		@ frame_needed = 0, uses_anonymous_args = 0
 387              		.loc 1 323 1 is_stmt 0 view .LVU117
 388 0000 2DE9F041 		push	{r4, r5, r6, r7, r8, lr}
 389              	.LCFI4:
 390              		.cfi_def_cfa_offset 24
 391              		.cfi_offset 4, -24
 392              		.cfi_offset 5, -20
 393              		.cfi_offset 6, -16
ARM GAS  C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s 			page 16


 394              		.cfi_offset 7, -12
 395              		.cfi_offset 8, -8
 396              		.cfi_offset 14, -4
 397 0004 82B0     		sub	sp, sp, #8
 398              	.LCFI5:
 399              		.cfi_def_cfa_offset 32
 400 0006 0446     		mov	r4, r0
 401 0008 0191     		str	r1, [sp, #4]
 324:RT-Thread/src/ipc.c ****     register rt_base_t temp;
 402              		.loc 1 324 5 is_stmt 1 view .LVU118
 325:RT-Thread/src/ipc.c ****     struct rt_thread *thread;
 403              		.loc 1 325 5 view .LVU119
 326:RT-Thread/src/ipc.c **** 
 327:RT-Thread/src/ipc.c ****     /* parameter check */
 328:RT-Thread/src/ipc.c ****     RT_ASSERT(sem != RT_NULL);
 404              		.loc 1 328 30 view .LVU120
 329:RT-Thread/src/ipc.c ****     RT_ASSERT(rt_object_get_type(&sem->parent.parent) == RT_Object_Class_Semaphore);
 405              		.loc 1 329 84 view .LVU121
 330:RT-Thread/src/ipc.c **** 
 331:RT-Thread/src/ipc.c ****     RT_OBJECT_HOOK_CALL(rt_object_trytake_hook, (&(sem->parent.parent)));
 406              		.loc 1 331 73 view .LVU122
 332:RT-Thread/src/ipc.c **** 
 333:RT-Thread/src/ipc.c ****     /* disable interrupt */
 334:RT-Thread/src/ipc.c ****     temp = rt_hw_interrupt_disable();
 407              		.loc 1 334 5 view .LVU123
 408              		.loc 1 334 12 is_stmt 0 view .LVU124
 409 000a FFF7FEFF 		bl	rt_hw_interrupt_disable
 410              	.LVL37:
 411              		.loc 1 334 12 view .LVU125
 412 000e 0746     		mov	r7, r0
 413              	.LVL38:
 335:RT-Thread/src/ipc.c **** 
 336:RT-Thread/src/ipc.c ****     RT_DEBUG_LOG(RT_DEBUG_IPC, ("thread %s take sem:%s, which value is: %d\n",
 337:RT-Thread/src/ipc.c ****                                 rt_thread_self()->name,
 338:RT-Thread/src/ipc.c ****                                 ((struct rt_object *)sem)->name,
 339:RT-Thread/src/ipc.c ****                                 sem->value));
 414              		.loc 1 339 45 is_stmt 1 view .LVU126
 340:RT-Thread/src/ipc.c **** 
 341:RT-Thread/src/ipc.c ****     if (sem->value > 0)
 415              		.loc 1 341 5 view .LVU127
 416              		.loc 1 341 12 is_stmt 0 view .LVU128
 417 0010 A38B     		ldrh	r3, [r4, #28]
 418              		.loc 1 341 8 view .LVU129
 419 0012 F3B9     		cbnz	r3, .L29
 342:RT-Thread/src/ipc.c ****     {
 343:RT-Thread/src/ipc.c ****         /* semaphore is available */
 344:RT-Thread/src/ipc.c ****         sem->value --;
 345:RT-Thread/src/ipc.c **** 
 346:RT-Thread/src/ipc.c ****         /* enable interrupt */
 347:RT-Thread/src/ipc.c ****         rt_hw_interrupt_enable(temp);
 348:RT-Thread/src/ipc.c ****     }
 349:RT-Thread/src/ipc.c ****     else
 350:RT-Thread/src/ipc.c ****     {
 351:RT-Thread/src/ipc.c ****         /* no waiting, return with timeout */
 352:RT-Thread/src/ipc.c ****         if (time == 0)
 420              		.loc 1 352 9 is_stmt 1 view .LVU130
 421              		.loc 1 352 18 is_stmt 0 view .LVU131
ARM GAS  C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s 			page 17


 422 0014 019B     		ldr	r3, [sp, #4]
 423              		.loc 1 352 12 view .LVU132
 424 0016 13B3     		cbz	r3, .L30
 353:RT-Thread/src/ipc.c ****         {
 354:RT-Thread/src/ipc.c ****             rt_hw_interrupt_enable(temp);
 355:RT-Thread/src/ipc.c **** 
 356:RT-Thread/src/ipc.c ****             return -RT_ETIMEOUT;
 357:RT-Thread/src/ipc.c ****         }
 358:RT-Thread/src/ipc.c ****         else
 359:RT-Thread/src/ipc.c ****         {
 360:RT-Thread/src/ipc.c ****             /* current context checking */
 361:RT-Thread/src/ipc.c ****             RT_DEBUG_IN_THREAD_CONTEXT;
 425              		.loc 1 361 39 is_stmt 1 view .LVU133
 362:RT-Thread/src/ipc.c **** 
 363:RT-Thread/src/ipc.c ****             /* semaphore is unavailable, push to suspend list */
 364:RT-Thread/src/ipc.c ****             /* get current thread */
 365:RT-Thread/src/ipc.c ****             thread = rt_thread_self();
 426              		.loc 1 365 13 view .LVU134
 427              		.loc 1 365 22 is_stmt 0 view .LVU135
 428 0018 FFF7FEFF 		bl	rt_thread_self
 429              	.LVL39:
 430              		.loc 1 365 22 view .LVU136
 431 001c 0646     		mov	r6, r0
 432              	.LVL40:
 366:RT-Thread/src/ipc.c **** 
 367:RT-Thread/src/ipc.c ****             /* reset thread error number */
 368:RT-Thread/src/ipc.c ****             thread->error = RT_EOK;
 433              		.loc 1 368 13 is_stmt 1 view .LVU137
 434              		.loc 1 368 27 is_stmt 0 view .LVU138
 435 001e 0023     		movs	r3, #0
 436 0020 0363     		str	r3, [r0, #48]
 369:RT-Thread/src/ipc.c **** 
 370:RT-Thread/src/ipc.c ****             RT_DEBUG_LOG(RT_DEBUG_IPC, ("sem take: suspend thread - %s\n",
 371:RT-Thread/src/ipc.c ****                                         thread->name));
 437              		.loc 1 371 55 is_stmt 1 view .LVU139
 372:RT-Thread/src/ipc.c **** 
 373:RT-Thread/src/ipc.c ****             /* suspend thread */
 374:RT-Thread/src/ipc.c ****             rt_ipc_list_suspend(&(sem->parent.suspend_thread),
 438              		.loc 1 374 13 view .LVU140
 439 0022 04F11405 		add	r5, r4, #20
 440 0026 94F80980 		ldrb	r8, [r4, #9]	@ zero_extendqisi2
 441              	.LVL41:
 442              	.LBB80:
 443              	.LBI80:
  78:RT-Thread/src/ipc.c ****                                        struct rt_thread *thread,
 444              		.loc 1 78 20 view .LVU141
 445              	.LBB81:
  83:RT-Thread/src/ipc.c **** 
 446              		.loc 1 83 5 view .LVU142
 447 002a FFF7FEFF 		bl	rt_thread_suspend
 448              	.LVL42:
  85:RT-Thread/src/ipc.c ****     {
 449              		.loc 1 85 5 view .LVU143
 450 002e B8F1000F 		cmp	r8, #0
 451 0032 19D0     		beq	.L20
 452 0034 B8F1010F 		cmp	r8, #1
 453 0038 1FD0     		beq	.L21
ARM GAS  C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s 			page 18


 454              	.L22:
 120:RT-Thread/src/ipc.c **** }
 455              		.loc 1 120 5 view .LVU144
 456              	.LVL43:
 120:RT-Thread/src/ipc.c **** }
 457              		.loc 1 120 5 is_stmt 0 view .LVU145
 458              	.LBE81:
 459              	.LBE80:
 375:RT-Thread/src/ipc.c ****                                 thread,
 376:RT-Thread/src/ipc.c ****                                 sem->parent.parent.flag);
 377:RT-Thread/src/ipc.c **** 
 378:RT-Thread/src/ipc.c ****             /* has waiting time, start thread timer */
 379:RT-Thread/src/ipc.c ****             if (time > 0)
 460              		.loc 1 379 13 is_stmt 1 view .LVU146
 461              		.loc 1 379 22 is_stmt 0 view .LVU147
 462 003a 019B     		ldr	r3, [sp, #4]
 463              		.loc 1 379 16 view .LVU148
 464 003c 002B     		cmp	r3, #0
 465 003e 3ADC     		bgt	.L31
 466              	.LVL44:
 467              	.L27:
 380:RT-Thread/src/ipc.c ****             {
 381:RT-Thread/src/ipc.c ****                 RT_DEBUG_LOG(RT_DEBUG_IPC, ("set thread:%s to timer list\n",
 382:RT-Thread/src/ipc.c ****                                             thread->name));
 383:RT-Thread/src/ipc.c **** 
 384:RT-Thread/src/ipc.c ****                 /* reset the timeout of thread timer and start it */
 385:RT-Thread/src/ipc.c ****                 rt_timer_control(&(thread->thread_timer),
 386:RT-Thread/src/ipc.c ****                                  RT_TIMER_CTRL_SET_TIME,
 387:RT-Thread/src/ipc.c ****                                  &time);
 388:RT-Thread/src/ipc.c ****                 rt_timer_start(&(thread->thread_timer));
 389:RT-Thread/src/ipc.c ****             }
 390:RT-Thread/src/ipc.c **** 
 391:RT-Thread/src/ipc.c ****             /* enable interrupt */
 392:RT-Thread/src/ipc.c ****             rt_hw_interrupt_enable(temp);
 468              		.loc 1 392 13 is_stmt 1 view .LVU149
 469 0040 3846     		mov	r0, r7
 470 0042 FFF7FEFF 		bl	rt_hw_interrupt_enable
 471              	.LVL45:
 393:RT-Thread/src/ipc.c **** 
 394:RT-Thread/src/ipc.c ****             /* do schedule */
 395:RT-Thread/src/ipc.c ****             rt_schedule();
 472              		.loc 1 395 13 view .LVU150
 473 0046 FFF7FEFF 		bl	rt_schedule
 474              	.LVL46:
 396:RT-Thread/src/ipc.c **** 
 397:RT-Thread/src/ipc.c ****             if (thread->error != RT_EOK)
 475              		.loc 1 397 13 view .LVU151
 476              		.loc 1 397 23 is_stmt 0 view .LVU152
 477 004a 306B     		ldr	r0, [r6, #48]
 478              	.LVL47:
 479              	.L16:
 398:RT-Thread/src/ipc.c ****             {
 399:RT-Thread/src/ipc.c ****                 return thread->error;
 400:RT-Thread/src/ipc.c ****             }
 401:RT-Thread/src/ipc.c ****         }
 402:RT-Thread/src/ipc.c ****     }
 403:RT-Thread/src/ipc.c **** 
ARM GAS  C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s 			page 19


 404:RT-Thread/src/ipc.c ****     RT_OBJECT_HOOK_CALL(rt_object_take_hook, (&(sem->parent.parent)));
 405:RT-Thread/src/ipc.c **** 
 406:RT-Thread/src/ipc.c ****     return RT_EOK;
 407:RT-Thread/src/ipc.c **** }
 480              		.loc 1 407 1 view .LVU153
 481 004c 02B0     		add	sp, sp, #8
 482              	.LCFI6:
 483              		.cfi_remember_state
 484              		.cfi_def_cfa_offset 24
 485              		@ sp needed
 486 004e BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 487              	.LVL48:
 488              	.L29:
 489              	.LCFI7:
 490              		.cfi_restore_state
 344:RT-Thread/src/ipc.c **** 
 491              		.loc 1 344 9 is_stmt 1 view .LVU154
 344:RT-Thread/src/ipc.c **** 
 492              		.loc 1 344 20 is_stmt 0 view .LVU155
 493 0052 013B     		subs	r3, r3, #1
 494 0054 A383     		strh	r3, [r4, #28]	@ movhi
 347:RT-Thread/src/ipc.c ****     }
 495              		.loc 1 347 9 is_stmt 1 view .LVU156
 496 0056 FFF7FEFF 		bl	rt_hw_interrupt_enable
 497              	.LVL49:
 406:RT-Thread/src/ipc.c **** }
 498              		.loc 1 406 12 is_stmt 0 view .LVU157
 499 005a 0020     		movs	r0, #0
 500 005c F6E7     		b	.L16
 501              	.LVL50:
 502              	.L30:
 354:RT-Thread/src/ipc.c **** 
 503              		.loc 1 354 13 is_stmt 1 view .LVU158
 504 005e FFF7FEFF 		bl	rt_hw_interrupt_enable
 505              	.LVL51:
 356:RT-Thread/src/ipc.c ****         }
 506              		.loc 1 356 13 view .LVU159
 356:RT-Thread/src/ipc.c ****         }
 507              		.loc 1 356 20 is_stmt 0 view .LVU160
 508 0062 6FF00100 		mvn	r0, #1
 509 0066 F1E7     		b	.L16
 510              	.LVL52:
 511              	.L20:
 512              	.LBB90:
 513              	.LBB89:
  88:RT-Thread/src/ipc.c ****         break;
 514              		.loc 1 88 9 is_stmt 1 view .LVU161
 515 0068 06F11403 		add	r3, r6, #20
 516              	.LVL53:
 517              	.LBB82:
 518              	.LBI82:
  73:RT-Thread/include/rtservice.h **** {
 519              		.loc 2 73 16 view .LVU162
 520              	.LBB83:
  75:RT-Thread/include/rtservice.h ****     n->prev = l->prev;
 521              		.loc 2 75 5 view .LVU163
  75:RT-Thread/include/rtservice.h ****     n->prev = l->prev;
ARM GAS  C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s 			page 20


 522              		.loc 2 75 6 is_stmt 0 view .LVU164
 523 006c 6A68     		ldr	r2, [r5, #4]
  75:RT-Thread/include/rtservice.h ****     n->prev = l->prev;
 524              		.loc 2 75 19 view .LVU165
 525 006e 1360     		str	r3, [r2]
  76:RT-Thread/include/rtservice.h **** 
 526              		.loc 2 76 5 is_stmt 1 view .LVU166
  76:RT-Thread/include/rtservice.h **** 
 527              		.loc 2 76 16 is_stmt 0 view .LVU167
 528 0070 6A68     		ldr	r2, [r5, #4]
  76:RT-Thread/include/rtservice.h **** 
 529              		.loc 2 76 13 view .LVU168
 530 0072 B261     		str	r2, [r6, #24]
  78:RT-Thread/include/rtservice.h ****     n->next = l;
 531              		.loc 2 78 5 is_stmt 1 view .LVU169
  78:RT-Thread/include/rtservice.h ****     n->next = l;
 532              		.loc 2 78 13 is_stmt 0 view .LVU170
 533 0074 6B60     		str	r3, [r5, #4]
  79:RT-Thread/include/rtservice.h **** }
 534              		.loc 2 79 5 is_stmt 1 view .LVU171
  79:RT-Thread/include/rtservice.h **** }
 535              		.loc 2 79 13 is_stmt 0 view .LVU172
 536 0076 7561     		str	r5, [r6, #20]
  80:RT-Thread/include/rtservice.h **** 
 537              		.loc 2 80 1 view .LVU173
 538 0078 DFE7     		b	.L22
 539              	.LVL54:
 540              	.L21:
  80:RT-Thread/include/rtservice.h **** 
 541              		.loc 2 80 1 view .LVU174
 542              	.LBE83:
 543              	.LBE82:
 544              	.LBB84:
  93:RT-Thread/src/ipc.c ****             struct rt_thread *sthread;
 545              		.loc 1 93 13 is_stmt 1 view .LVU175
  94:RT-Thread/src/ipc.c **** 
 546              		.loc 1 94 13 view .LVU176
  97:RT-Thread/src/ipc.c ****             {
 547              		.loc 1 97 13 view .LVU177
  97:RT-Thread/src/ipc.c ****             {
 548              		.loc 1 97 20 is_stmt 0 view .LVU178
 549 007a 6369     		ldr	r3, [r4, #20]
 550              	.LVL55:
 551              	.L23:
  97:RT-Thread/src/ipc.c ****             {
 552              		.loc 1 97 34 is_stmt 1 view .LVU179
  97:RT-Thread/src/ipc.c ****             {
 553              		.loc 1 97 13 is_stmt 0 view .LVU180
 554 007c 9D42     		cmp	r5, r3
 555 007e 0FD0     		beq	.L25
  99:RT-Thread/src/ipc.c **** 
 556              		.loc 1 99 17 is_stmt 1 view .LVU181
 557              	.LVL56:
 102:RT-Thread/src/ipc.c ****                 {
 558              		.loc 1 102 17 view .LVU182
 102:RT-Thread/src/ipc.c ****                 {
 559              		.loc 1 102 27 is_stmt 0 view .LVU183
ARM GAS  C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s 			page 21


 560 0080 96F83510 		ldrb	r1, [r6, #53]	@ zero_extendqisi2
 102:RT-Thread/src/ipc.c ****                 {
 561              		.loc 1 102 55 view .LVU184
 562 0084 93F82120 		ldrb	r2, [r3, #33]	@ zero_extendqisi2
 102:RT-Thread/src/ipc.c ****                 {
 563              		.loc 1 102 20 view .LVU185
 564 0088 9142     		cmp	r1, r2
 565 008a 01D3     		bcc	.L32
  97:RT-Thread/src/ipc.c ****             {
 566              		.loc 1 97 45 is_stmt 1 view .LVU186
  97:RT-Thread/src/ipc.c ****             {
 567              		.loc 1 97 47 is_stmt 0 view .LVU187
 568 008c 1B68     		ldr	r3, [r3]
 569              	.LVL57:
  97:RT-Thread/src/ipc.c ****             {
 570              		.loc 1 97 47 view .LVU188
 571 008e F5E7     		b	.L23
 572              	.LVL58:
 573              	.L32:
 105:RT-Thread/src/ipc.c ****                     break;
 574              		.loc 1 105 21 is_stmt 1 view .LVU189
 575 0090 06F11402 		add	r2, r6, #20
 576              	.LVL59:
 577              	.LBB85:
 578              	.LBI85:
  73:RT-Thread/include/rtservice.h **** {
 579              		.loc 2 73 16 view .LVU190
 580              	.LBB86:
  75:RT-Thread/include/rtservice.h ****     n->prev = l->prev;
 581              		.loc 2 75 5 view .LVU191
  75:RT-Thread/include/rtservice.h ****     n->prev = l->prev;
 582              		.loc 2 75 6 is_stmt 0 view .LVU192
 583 0094 5968     		ldr	r1, [r3, #4]
  75:RT-Thread/include/rtservice.h ****     n->prev = l->prev;
 584              		.loc 2 75 19 view .LVU193
 585 0096 0A60     		str	r2, [r1]
  76:RT-Thread/include/rtservice.h **** 
 586              		.loc 2 76 5 is_stmt 1 view .LVU194
  76:RT-Thread/include/rtservice.h **** 
 587              		.loc 2 76 16 is_stmt 0 view .LVU195
 588 0098 5968     		ldr	r1, [r3, #4]
  76:RT-Thread/include/rtservice.h **** 
 589              		.loc 2 76 13 view .LVU196
 590 009a B161     		str	r1, [r6, #24]
  78:RT-Thread/include/rtservice.h ****     n->next = l;
 591              		.loc 2 78 5 is_stmt 1 view .LVU197
  78:RT-Thread/include/rtservice.h ****     n->next = l;
 592              		.loc 2 78 13 is_stmt 0 view .LVU198
 593 009c 5A60     		str	r2, [r3, #4]
  79:RT-Thread/include/rtservice.h **** }
 594              		.loc 2 79 5 is_stmt 1 view .LVU199
  79:RT-Thread/include/rtservice.h **** }
 595              		.loc 2 79 13 is_stmt 0 view .LVU200
 596 009e 7361     		str	r3, [r6, #20]
 597              	.LVL60:
 598              	.L25:
  79:RT-Thread/include/rtservice.h **** }
ARM GAS  C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s 			page 22


 599              		.loc 2 79 13 view .LVU201
 600              	.LBE86:
 601              	.LBE85:
 114:RT-Thread/src/ipc.c ****                 rt_list_insert_before(list, &(thread->tlist));
 602              		.loc 1 114 13 is_stmt 1 view .LVU202
 114:RT-Thread/src/ipc.c ****                 rt_list_insert_before(list, &(thread->tlist));
 603              		.loc 1 114 16 is_stmt 0 view .LVU203
 604 00a0 9D42     		cmp	r5, r3
 605 00a2 CAD1     		bne	.L22
 115:RT-Thread/src/ipc.c ****         }
 606              		.loc 1 115 17 is_stmt 1 view .LVU204
 607 00a4 06F11403 		add	r3, r6, #20
 608              	.LVL61:
 609              	.LBB87:
 610              	.LBI87:
  73:RT-Thread/include/rtservice.h **** {
 611              		.loc 2 73 16 view .LVU205
 612              	.LBB88:
  75:RT-Thread/include/rtservice.h ****     n->prev = l->prev;
 613              		.loc 2 75 5 view .LVU206
  75:RT-Thread/include/rtservice.h ****     n->prev = l->prev;
 614              		.loc 2 75 6 is_stmt 0 view .LVU207
 615 00a8 6A68     		ldr	r2, [r5, #4]
  75:RT-Thread/include/rtservice.h ****     n->prev = l->prev;
 616              		.loc 2 75 19 view .LVU208
 617 00aa 1360     		str	r3, [r2]
  76:RT-Thread/include/rtservice.h **** 
 618              		.loc 2 76 5 is_stmt 1 view .LVU209
  76:RT-Thread/include/rtservice.h **** 
 619              		.loc 2 76 16 is_stmt 0 view .LVU210
 620 00ac 6A68     		ldr	r2, [r5, #4]
  76:RT-Thread/include/rtservice.h **** 
 621              		.loc 2 76 13 view .LVU211
 622 00ae B261     		str	r2, [r6, #24]
  78:RT-Thread/include/rtservice.h ****     n->next = l;
 623              		.loc 2 78 5 is_stmt 1 view .LVU212
  78:RT-Thread/include/rtservice.h ****     n->next = l;
 624              		.loc 2 78 13 is_stmt 0 view .LVU213
 625 00b0 6B60     		str	r3, [r5, #4]
  79:RT-Thread/include/rtservice.h **** }
 626              		.loc 2 79 5 is_stmt 1 view .LVU214
  79:RT-Thread/include/rtservice.h **** }
 627              		.loc 2 79 13 is_stmt 0 view .LVU215
 628 00b2 7561     		str	r5, [r6, #20]
  80:RT-Thread/include/rtservice.h **** 
 629              		.loc 2 80 1 view .LVU216
 630 00b4 C1E7     		b	.L22
 631              	.LVL62:
 632              	.L31:
  80:RT-Thread/include/rtservice.h **** 
 633              		.loc 2 80 1 view .LVU217
 634              	.LBE88:
 635              	.LBE87:
 636              	.LBE84:
 637              	.LBE89:
 638              	.LBE90:
 382:RT-Thread/src/ipc.c **** 
ARM GAS  C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s 			page 23


 639              		.loc 1 382 59 is_stmt 1 view .LVU218
 385:RT-Thread/src/ipc.c ****                                  RT_TIMER_CTRL_SET_TIME,
 640              		.loc 1 385 17 view .LVU219
 641 00b6 06F15004 		add	r4, r6, #80
 642              	.LVL63:
 385:RT-Thread/src/ipc.c ****                                  RT_TIMER_CTRL_SET_TIME,
 643              		.loc 1 385 17 is_stmt 0 view .LVU220
 644 00ba 01AA     		add	r2, sp, #4
 645 00bc 0021     		movs	r1, #0
 646 00be 2046     		mov	r0, r4
 647 00c0 FFF7FEFF 		bl	rt_timer_control
 648              	.LVL64:
 388:RT-Thread/src/ipc.c ****             }
 649              		.loc 1 388 17 is_stmt 1 view .LVU221
 650 00c4 2046     		mov	r0, r4
 651 00c6 FFF7FEFF 		bl	rt_timer_start
 652              	.LVL65:
 653 00ca B9E7     		b	.L27
 654              		.cfi_endproc
 655              	.LFE23:
 657              		.section	.text.rt_sem_trytake,"ax",%progbits
 658              		.align	1
 659              		.global	rt_sem_trytake
 660              		.syntax unified
 661              		.thumb
 662              		.thumb_func
 663              		.fpu softvfp
 665              	rt_sem_trytake:
 666              	.LVL66:
 667              	.LFB24:
 408:RT-Thread/src/ipc.c **** RTM_EXPORT(rt_sem_take);
 409:RT-Thread/src/ipc.c **** 
 410:RT-Thread/src/ipc.c **** /**
 411:RT-Thread/src/ipc.c ****  * This function will try to take a semaphore and immediately return
 412:RT-Thread/src/ipc.c ****  *
 413:RT-Thread/src/ipc.c ****  * @param sem the semaphore object
 414:RT-Thread/src/ipc.c ****  *
 415:RT-Thread/src/ipc.c ****  * @return the error code
 416:RT-Thread/src/ipc.c ****  */
 417:RT-Thread/src/ipc.c **** rt_err_t rt_sem_trytake(rt_sem_t sem)
 418:RT-Thread/src/ipc.c **** {
 668              		.loc 1 418 1 view -0
 669              		.cfi_startproc
 670              		@ args = 0, pretend = 0, frame = 0
 671              		@ frame_needed = 0, uses_anonymous_args = 0
 672              		.loc 1 418 1 is_stmt 0 view .LVU223
 673 0000 08B5     		push	{r3, lr}
 674              	.LCFI8:
 675              		.cfi_def_cfa_offset 8
 676              		.cfi_offset 3, -8
 677              		.cfi_offset 14, -4
 419:RT-Thread/src/ipc.c ****     return rt_sem_take(sem, 0);
 678              		.loc 1 419 5 is_stmt 1 view .LVU224
 679              		.loc 1 419 12 is_stmt 0 view .LVU225
 680 0002 0021     		movs	r1, #0
 681 0004 FFF7FEFF 		bl	rt_sem_take
 682              	.LVL67:
ARM GAS  C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s 			page 24


 420:RT-Thread/src/ipc.c **** }
 683              		.loc 1 420 1 view .LVU226
 684 0008 08BD     		pop	{r3, pc}
 685              		.cfi_endproc
 686              	.LFE24:
 688              		.section	.text.rt_sem_release,"ax",%progbits
 689              		.align	1
 690              		.global	rt_sem_release
 691              		.syntax unified
 692              		.thumb
 693              		.thumb_func
 694              		.fpu softvfp
 696              	rt_sem_release:
 697              	.LVL68:
 698              	.LFB25:
 421:RT-Thread/src/ipc.c **** RTM_EXPORT(rt_sem_trytake);
 422:RT-Thread/src/ipc.c **** 
 423:RT-Thread/src/ipc.c **** /**
 424:RT-Thread/src/ipc.c ****  * This function will release a semaphore, if there are threads suspended on
 425:RT-Thread/src/ipc.c ****  * semaphore, it will be waked up.
 426:RT-Thread/src/ipc.c ****  *
 427:RT-Thread/src/ipc.c ****  * @param sem the semaphore object
 428:RT-Thread/src/ipc.c ****  *
 429:RT-Thread/src/ipc.c ****  * @return the error code
 430:RT-Thread/src/ipc.c ****  */
 431:RT-Thread/src/ipc.c **** rt_err_t rt_sem_release(rt_sem_t sem)
 432:RT-Thread/src/ipc.c **** {
 699              		.loc 1 432 1 is_stmt 1 view -0
 700              		.cfi_startproc
 701              		@ args = 0, pretend = 0, frame = 0
 702              		@ frame_needed = 0, uses_anonymous_args = 0
 703              		.loc 1 432 1 is_stmt 0 view .LVU228
 704 0000 38B5     		push	{r3, r4, r5, lr}
 705              	.LCFI9:
 706              		.cfi_def_cfa_offset 16
 707              		.cfi_offset 3, -16
 708              		.cfi_offset 4, -12
 709              		.cfi_offset 5, -8
 710              		.cfi_offset 14, -4
 711 0002 0446     		mov	r4, r0
 433:RT-Thread/src/ipc.c ****     register rt_base_t temp;
 712              		.loc 1 433 5 is_stmt 1 view .LVU229
 434:RT-Thread/src/ipc.c ****     register rt_bool_t need_schedule;
 713              		.loc 1 434 5 view .LVU230
 435:RT-Thread/src/ipc.c **** 
 436:RT-Thread/src/ipc.c ****     /* parameter check */
 437:RT-Thread/src/ipc.c ****     RT_ASSERT(sem != RT_NULL);
 714              		.loc 1 437 30 view .LVU231
 438:RT-Thread/src/ipc.c ****     RT_ASSERT(rt_object_get_type(&sem->parent.parent) == RT_Object_Class_Semaphore);
 715              		.loc 1 438 84 view .LVU232
 439:RT-Thread/src/ipc.c **** 
 440:RT-Thread/src/ipc.c ****     RT_OBJECT_HOOK_CALL(rt_object_put_hook, (&(sem->parent.parent)));
 716              		.loc 1 440 69 view .LVU233
 441:RT-Thread/src/ipc.c **** 
 442:RT-Thread/src/ipc.c ****     need_schedule = RT_FALSE;
 717              		.loc 1 442 5 view .LVU234
 718              	.LVL69:
ARM GAS  C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s 			page 25


 443:RT-Thread/src/ipc.c **** 
 444:RT-Thread/src/ipc.c ****     /* disable interrupt */
 445:RT-Thread/src/ipc.c ****     temp = rt_hw_interrupt_disable();
 719              		.loc 1 445 5 view .LVU235
 720              		.loc 1 445 12 is_stmt 0 view .LVU236
 721 0004 FFF7FEFF 		bl	rt_hw_interrupt_disable
 722              	.LVL70:
 723              		.loc 1 445 12 view .LVU237
 724 0008 0546     		mov	r5, r0
 725              	.LVL71:
 446:RT-Thread/src/ipc.c **** 
 447:RT-Thread/src/ipc.c ****     RT_DEBUG_LOG(RT_DEBUG_IPC, ("thread %s releases sem:%s, which value is: %d\n",
 448:RT-Thread/src/ipc.c ****                                 rt_thread_self()->name,
 449:RT-Thread/src/ipc.c ****                                 ((struct rt_object *)sem)->name,
 450:RT-Thread/src/ipc.c ****                                 sem->value));
 726              		.loc 1 450 45 is_stmt 1 view .LVU238
 451:RT-Thread/src/ipc.c **** 
 452:RT-Thread/src/ipc.c ****     if (!rt_list_isempty(&sem->parent.suspend_thread))
 727              		.loc 1 452 5 view .LVU239
 728              		.loc 1 452 26 is_stmt 0 view .LVU240
 729 000a 04F11403 		add	r3, r4, #20
 730              	.LVL72:
 731              	.LBB91:
 732              	.LBI91:
  98:RT-Thread/include/rtservice.h **** {
 733              		.loc 2 98 15 is_stmt 1 view .LVU241
 734              	.LBB92:
 735              		.loc 2 100 5 view .LVU242
 736              		.loc 2 100 13 is_stmt 0 view .LVU243
 737 000e 6069     		ldr	r0, [r4, #20]
 738              	.LVL73:
 739              		.loc 2 100 13 view .LVU244
 740              	.LBE92:
 741              	.LBE91:
 742              		.loc 1 452 8 view .LVU245
 743 0010 8342     		cmp	r3, r0
 744 0012 09D0     		beq	.L36
 453:RT-Thread/src/ipc.c ****     {
 454:RT-Thread/src/ipc.c ****         /* resume the suspended thread */
 455:RT-Thread/src/ipc.c ****         rt_ipc_list_resume(&(sem->parent.suspend_thread));
 745              		.loc 1 455 9 is_stmt 1 view .LVU246
 746              	.LVL74:
 747              	.LBB93:
 748              	.LBI93:
 132:RT-Thread/src/ipc.c **** {
 749              		.loc 1 132 20 view .LVU247
 750              	.LBB94:
 134:RT-Thread/src/ipc.c **** 
 751              		.loc 1 134 5 view .LVU248
 137:RT-Thread/src/ipc.c **** 
 752              		.loc 1 137 5 view .LVU249
 139:RT-Thread/src/ipc.c **** 
 753              		.loc 1 139 69 view .LVU250
 142:RT-Thread/src/ipc.c **** 
 754              		.loc 1 142 5 view .LVU251
 755 0014 1438     		subs	r0, r0, #20
 756              	.LVL75:
ARM GAS  C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s 			page 26


 142:RT-Thread/src/ipc.c **** 
 757              		.loc 1 142 5 is_stmt 0 view .LVU252
 758 0016 FFF7FEFF 		bl	rt_thread_resume
 759              	.LVL76:
 144:RT-Thread/src/ipc.c **** }
 760              		.loc 1 144 5 is_stmt 1 view .LVU253
 144:RT-Thread/src/ipc.c **** }
 761              		.loc 1 144 5 is_stmt 0 view .LVU254
 762              	.LBE94:
 763              	.LBE93:
 456:RT-Thread/src/ipc.c ****         need_schedule = RT_TRUE;
 764              		.loc 1 456 9 is_stmt 1 view .LVU255
 765              		.loc 1 456 23 is_stmt 0 view .LVU256
 766 001a 0124     		movs	r4, #1
 767              	.LVL77:
 768              	.L37:
 457:RT-Thread/src/ipc.c ****     }
 458:RT-Thread/src/ipc.c ****     else
 459:RT-Thread/src/ipc.c ****         sem->value ++; /* increase value */
 460:RT-Thread/src/ipc.c **** 
 461:RT-Thread/src/ipc.c ****     /* enable interrupt */
 462:RT-Thread/src/ipc.c ****     rt_hw_interrupt_enable(temp);
 769              		.loc 1 462 5 is_stmt 1 view .LVU257
 770 001c 2846     		mov	r0, r5
 771 001e FFF7FEFF 		bl	rt_hw_interrupt_enable
 772              	.LVL78:
 463:RT-Thread/src/ipc.c **** 
 464:RT-Thread/src/ipc.c ****     /* resume a thread, re-schedule */
 465:RT-Thread/src/ipc.c ****     if (need_schedule == RT_TRUE)
 773              		.loc 1 465 5 view .LVU258
 774              		.loc 1 465 8 is_stmt 0 view .LVU259
 775 0022 34B9     		cbnz	r4, .L40
 776              	.L38:
 466:RT-Thread/src/ipc.c ****         rt_schedule();
 467:RT-Thread/src/ipc.c **** 
 468:RT-Thread/src/ipc.c ****     return RT_EOK;
 777              		.loc 1 468 5 is_stmt 1 view .LVU260
 469:RT-Thread/src/ipc.c **** }
 778              		.loc 1 469 1 is_stmt 0 view .LVU261
 779 0024 0020     		movs	r0, #0
 780 0026 38BD     		pop	{r3, r4, r5, pc}
 781              	.LVL79:
 782              	.L36:
 459:RT-Thread/src/ipc.c **** 
 783              		.loc 1 459 9 is_stmt 1 view .LVU262
 459:RT-Thread/src/ipc.c **** 
 784              		.loc 1 459 12 is_stmt 0 view .LVU263
 785 0028 A38B     		ldrh	r3, [r4, #28]
 459:RT-Thread/src/ipc.c **** 
 786              		.loc 1 459 20 view .LVU264
 787 002a 0133     		adds	r3, r3, #1
 788 002c A383     		strh	r3, [r4, #28]	@ movhi
 442:RT-Thread/src/ipc.c **** 
 789              		.loc 1 442 19 view .LVU265
 790 002e 0024     		movs	r4, #0
 791              	.LVL80:
 442:RT-Thread/src/ipc.c **** 
ARM GAS  C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s 			page 27


 792              		.loc 1 442 19 view .LVU266
 793 0030 F4E7     		b	.L37
 794              	.LVL81:
 795              	.L40:
 466:RT-Thread/src/ipc.c **** 
 796              		.loc 1 466 9 is_stmt 1 view .LVU267
 797 0032 FFF7FEFF 		bl	rt_schedule
 798              	.LVL82:
 799 0036 F5E7     		b	.L38
 800              		.cfi_endproc
 801              	.LFE25:
 803              		.section	.text.rt_sem_control,"ax",%progbits
 804              		.align	1
 805              		.global	rt_sem_control
 806              		.syntax unified
 807              		.thumb
 808              		.thumb_func
 809              		.fpu softvfp
 811              	rt_sem_control:
 812              	.LVL83:
 813              	.LFB26:
 470:RT-Thread/src/ipc.c **** RTM_EXPORT(rt_sem_release);
 471:RT-Thread/src/ipc.c **** 
 472:RT-Thread/src/ipc.c **** /**
 473:RT-Thread/src/ipc.c ****  * This function can get or set some extra attributions of a semaphore object.
 474:RT-Thread/src/ipc.c ****  *
 475:RT-Thread/src/ipc.c ****  * @param sem the semaphore object
 476:RT-Thread/src/ipc.c ****  * @param cmd the execution command
 477:RT-Thread/src/ipc.c ****  * @param arg the execution argument
 478:RT-Thread/src/ipc.c ****  *
 479:RT-Thread/src/ipc.c ****  * @return the error code
 480:RT-Thread/src/ipc.c ****  */
 481:RT-Thread/src/ipc.c **** rt_err_t rt_sem_control(rt_sem_t sem, int cmd, void *arg)
 482:RT-Thread/src/ipc.c **** {
 814              		.loc 1 482 1 view -0
 815              		.cfi_startproc
 816              		@ args = 0, pretend = 0, frame = 0
 817              		@ frame_needed = 0, uses_anonymous_args = 0
 483:RT-Thread/src/ipc.c ****     rt_ubase_t level;
 818              		.loc 1 483 5 view .LVU269
 484:RT-Thread/src/ipc.c **** 
 485:RT-Thread/src/ipc.c ****     /* parameter check */
 486:RT-Thread/src/ipc.c ****     RT_ASSERT(sem != RT_NULL);
 819              		.loc 1 486 30 view .LVU270
 487:RT-Thread/src/ipc.c ****     RT_ASSERT(rt_object_get_type(&sem->parent.parent) == RT_Object_Class_Semaphore);
 820              		.loc 1 487 84 view .LVU271
 488:RT-Thread/src/ipc.c **** 
 489:RT-Thread/src/ipc.c ****     if (cmd == RT_IPC_CMD_RESET)
 821              		.loc 1 489 5 view .LVU272
 822              		.loc 1 489 8 is_stmt 0 view .LVU273
 823 0000 0129     		cmp	r1, #1
 824 0002 23D1     		bne	.L45
 482:RT-Thread/src/ipc.c ****     rt_ubase_t level;
 825              		.loc 1 482 1 view .LVU274
 826 0004 2DE9F041 		push	{r4, r5, r6, r7, r8, lr}
 827              	.LCFI10:
 828              		.cfi_def_cfa_offset 24
ARM GAS  C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s 			page 28


 829              		.cfi_offset 4, -24
 830              		.cfi_offset 5, -20
 831              		.cfi_offset 6, -16
 832              		.cfi_offset 7, -12
 833              		.cfi_offset 8, -8
 834              		.cfi_offset 14, -4
 835 0008 0446     		mov	r4, r0
 836 000a 9046     		mov	r8, r2
 837              	.LBB100:
 490:RT-Thread/src/ipc.c ****     {
 491:RT-Thread/src/ipc.c ****         rt_uint32_t value;
 838              		.loc 1 491 9 is_stmt 1 view .LVU275
 492:RT-Thread/src/ipc.c **** 
 493:RT-Thread/src/ipc.c ****         /* get value */
 494:RT-Thread/src/ipc.c ****         value = (rt_uint32_t)arg;
 839              		.loc 1 494 9 view .LVU276
 840              	.LVL84:
 495:RT-Thread/src/ipc.c ****         /* disable interrupt */
 496:RT-Thread/src/ipc.c ****         level = rt_hw_interrupt_disable();
 841              		.loc 1 496 9 view .LVU277
 842              		.loc 1 496 17 is_stmt 0 view .LVU278
 843 000c FFF7FEFF 		bl	rt_hw_interrupt_disable
 844              	.LVL85:
 845              		.loc 1 496 17 view .LVU279
 846 0010 0746     		mov	r7, r0
 847              	.LVL86:
 497:RT-Thread/src/ipc.c **** 
 498:RT-Thread/src/ipc.c ****         /* resume all waiting thread */
 499:RT-Thread/src/ipc.c ****         rt_ipc_list_resume_all(&sem->parent.suspend_thread);
 848              		.loc 1 499 9 is_stmt 1 view .LVU280
 849 0012 04F11406 		add	r6, r4, #20
 850              	.LVL87:
 851              	.LBB101:
 852              	.LBI101:
 155:RT-Thread/src/ipc.c **** {
 853              		.loc 1 155 20 view .LVU281
 854              	.LBB102:
 157:RT-Thread/src/ipc.c ****     register rt_ubase_t temp;
 855              		.loc 1 157 5 view .LVU282
 158:RT-Thread/src/ipc.c **** 
 856              		.loc 1 158 5 view .LVU283
 161:RT-Thread/src/ipc.c ****     {
 857              		.loc 1 161 5 view .LVU284
 161:RT-Thread/src/ipc.c ****     {
 858              		.loc 1 161 11 is_stmt 0 view .LVU285
 859 0016 0CE0     		b	.L43
 860              	.LVL88:
 861              	.L44:
 164:RT-Thread/src/ipc.c **** 
 862              		.loc 1 164 9 is_stmt 1 view .LVU286
 164:RT-Thread/src/ipc.c **** 
 863              		.loc 1 164 16 is_stmt 0 view .LVU287
 864 0018 FFF7FEFF 		bl	rt_hw_interrupt_disable
 865              	.LVL89:
 866 001c 0546     		mov	r5, r0
 867              	.LVL90:
 167:RT-Thread/src/ipc.c ****         /* set error code to RT_ERROR */
ARM GAS  C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s 			page 29


 868              		.loc 1 167 9 is_stmt 1 view .LVU288
 167:RT-Thread/src/ipc.c ****         /* set error code to RT_ERROR */
 869              		.loc 1 167 18 is_stmt 0 view .LVU289
 870 001e 3068     		ldr	r0, [r6]
 871              	.LVL91:
 169:RT-Thread/src/ipc.c **** 
 872              		.loc 1 169 9 is_stmt 1 view .LVU290
 169:RT-Thread/src/ipc.c **** 
 873              		.loc 1 169 23 is_stmt 0 view .LVU291
 874 0020 4FF0FF33 		mov	r3, #-1
 875 0024 C361     		str	r3, [r0, #28]
 176:RT-Thread/src/ipc.c **** 
 876              		.loc 1 176 9 is_stmt 1 view .LVU292
 877 0026 1438     		subs	r0, r0, #20
 878              	.LVL92:
 176:RT-Thread/src/ipc.c **** 
 879              		.loc 1 176 9 is_stmt 0 view .LVU293
 880 0028 FFF7FEFF 		bl	rt_thread_resume
 881              	.LVL93:
 179:RT-Thread/src/ipc.c ****     }
 882              		.loc 1 179 9 is_stmt 1 view .LVU294
 883 002c 2846     		mov	r0, r5
 884 002e FFF7FEFF 		bl	rt_hw_interrupt_enable
 885              	.LVL94:
 886              	.L43:
 161:RT-Thread/src/ipc.c ****     {
 887              		.loc 1 161 11 view .LVU295
 888              	.LBB103:
 889              	.LBI103:
  98:RT-Thread/include/rtservice.h **** {
 890              		.loc 2 98 15 view .LVU296
 891              	.LBB104:
 892              		.loc 2 100 5 view .LVU297
 893              		.loc 2 100 13 is_stmt 0 view .LVU298
 894 0032 3368     		ldr	r3, [r6]
 895              	.LVL95:
 896              		.loc 2 100 13 view .LVU299
 897              	.LBE104:
 898              	.LBE103:
 161:RT-Thread/src/ipc.c ****     {
 899              		.loc 1 161 11 view .LVU300
 900 0034 9E42     		cmp	r6, r3
 901 0036 EFD1     		bne	.L44
 182:RT-Thread/src/ipc.c **** }
 902              		.loc 1 182 5 is_stmt 1 view .LVU301
 903              	.LVL96:
 182:RT-Thread/src/ipc.c **** }
 904              		.loc 1 182 5 is_stmt 0 view .LVU302
 905              	.LBE102:
 906              	.LBE101:
 500:RT-Thread/src/ipc.c **** 
 501:RT-Thread/src/ipc.c ****         /* set new value */
 502:RT-Thread/src/ipc.c ****         sem->value = (rt_uint16_t)value;
 907              		.loc 1 502 9 is_stmt 1 view .LVU303
 908              		.loc 1 502 20 is_stmt 0 view .LVU304
 909 0038 A4F81C80 		strh	r8, [r4, #28]	@ movhi
 503:RT-Thread/src/ipc.c **** 
ARM GAS  C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s 			page 30


 504:RT-Thread/src/ipc.c ****         /* enable interrupt */
 505:RT-Thread/src/ipc.c ****         rt_hw_interrupt_enable(level);
 910              		.loc 1 505 9 is_stmt 1 view .LVU305
 911 003c 3846     		mov	r0, r7
 912 003e FFF7FEFF 		bl	rt_hw_interrupt_enable
 913              	.LVL97:
 506:RT-Thread/src/ipc.c **** 
 507:RT-Thread/src/ipc.c ****         rt_schedule();
 914              		.loc 1 507 9 view .LVU306
 915 0042 FFF7FEFF 		bl	rt_schedule
 916              	.LVL98:
 508:RT-Thread/src/ipc.c **** 
 509:RT-Thread/src/ipc.c ****         return RT_EOK;
 917              		.loc 1 509 9 view .LVU307
 918              		.loc 1 509 16 is_stmt 0 view .LVU308
 919 0046 0020     		movs	r0, #0
 920              	.LBE100:
 510:RT-Thread/src/ipc.c ****     }
 511:RT-Thread/src/ipc.c **** 
 512:RT-Thread/src/ipc.c ****     return -RT_ERROR;
 513:RT-Thread/src/ipc.c **** }
 921              		.loc 1 513 1 view .LVU309
 922 0048 BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 923              	.LVL99:
 924              	.L45:
 925              	.LCFI11:
 926              		.cfi_def_cfa_offset 0
 927              		.cfi_restore 4
 928              		.cfi_restore 5
 929              		.cfi_restore 6
 930              		.cfi_restore 7
 931              		.cfi_restore 8
 932              		.cfi_restore 14
 512:RT-Thread/src/ipc.c **** }
 933              		.loc 1 512 12 view .LVU310
 934 004c 4FF0FF30 		mov	r0, #-1
 935              	.LVL100:
 936              		.loc 1 513 1 view .LVU311
 937 0050 7047     		bx	lr
 938              		.cfi_endproc
 939              	.LFE26:
 941              		.section	.text.rt_mutex_init,"ax",%progbits
 942              		.align	1
 943              		.global	rt_mutex_init
 944              		.syntax unified
 945              		.thumb
 946              		.thumb_func
 947              		.fpu softvfp
 949              	rt_mutex_init:
 950              	.LVL101:
 951              	.LFB27:
 514:RT-Thread/src/ipc.c **** RTM_EXPORT(rt_sem_control);
 515:RT-Thread/src/ipc.c **** #endif /* end of RT_USING_SEMAPHORE */
 516:RT-Thread/src/ipc.c **** 
 517:RT-Thread/src/ipc.c **** #ifdef RT_USING_MUTEX
 518:RT-Thread/src/ipc.c **** /**
 519:RT-Thread/src/ipc.c ****  * This function will initialize a mutex and put it under control of resource
ARM GAS  C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s 			page 31


 520:RT-Thread/src/ipc.c ****  * management.
 521:RT-Thread/src/ipc.c ****  *
 522:RT-Thread/src/ipc.c ****  * @param mutex the mutex object
 523:RT-Thread/src/ipc.c ****  * @param name the name of mutex
 524:RT-Thread/src/ipc.c ****  * @param flag the flag of mutex
 525:RT-Thread/src/ipc.c ****  *
 526:RT-Thread/src/ipc.c ****  * @return the operation status, RT_EOK on successful
 527:RT-Thread/src/ipc.c ****  */
 528:RT-Thread/src/ipc.c **** rt_err_t rt_mutex_init(rt_mutex_t mutex, const char *name, rt_uint8_t flag)
 529:RT-Thread/src/ipc.c **** {
 952              		.loc 1 529 1 is_stmt 1 view -0
 953              		.cfi_startproc
 954              		@ args = 0, pretend = 0, frame = 0
 955              		@ frame_needed = 0, uses_anonymous_args = 0
 956              		.loc 1 529 1 is_stmt 0 view .LVU313
 957 0000 38B5     		push	{r3, r4, r5, lr}
 958              	.LCFI12:
 959              		.cfi_def_cfa_offset 16
 960              		.cfi_offset 3, -16
 961              		.cfi_offset 4, -12
 962              		.cfi_offset 5, -8
 963              		.cfi_offset 14, -4
 964 0002 0446     		mov	r4, r0
 965 0004 1546     		mov	r5, r2
 530:RT-Thread/src/ipc.c ****     /* parameter check */
 531:RT-Thread/src/ipc.c ****     RT_ASSERT(mutex != RT_NULL);
 966              		.loc 1 531 32 is_stmt 1 view .LVU314
 532:RT-Thread/src/ipc.c **** 
 533:RT-Thread/src/ipc.c ****     /* init object */
 534:RT-Thread/src/ipc.c ****     rt_object_init(&(mutex->parent.parent), RT_Object_Class_Mutex, name);
 967              		.loc 1 534 5 view .LVU315
 968 0006 0A46     		mov	r2, r1
 969              	.LVL102:
 970              		.loc 1 534 5 is_stmt 0 view .LVU316
 971 0008 0321     		movs	r1, #3
 972              	.LVL103:
 973              		.loc 1 534 5 view .LVU317
 974 000a FFF7FEFF 		bl	rt_object_init
 975              	.LVL104:
 535:RT-Thread/src/ipc.c **** 
 536:RT-Thread/src/ipc.c ****     /* init ipc object */
 537:RT-Thread/src/ipc.c ****     rt_ipc_object_init(&(mutex->parent));
 976              		.loc 1 537 5 is_stmt 1 view .LVU318
 977              	.LBB105:
 978              	.LBI105:
  59:RT-Thread/src/ipc.c **** {
 979              		.loc 1 59 20 view .LVU319
 980              	.LBB106:
  62:RT-Thread/src/ipc.c **** 
 981              		.loc 1 62 5 view .LVU320
 982 000e 04F11403 		add	r3, r4, #20
 983              	.LVL105:
 984              	.LBB107:
 985              	.LBI107:
  47:RT-Thread/include/rtservice.h **** {
 986              		.loc 2 47 16 view .LVU321
 987              	.LBB108:
ARM GAS  C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s 			page 32


  49:RT-Thread/include/rtservice.h **** }
 988              		.loc 2 49 5 view .LVU322
  49:RT-Thread/include/rtservice.h **** }
 989              		.loc 2 49 23 is_stmt 0 view .LVU323
 990 0012 A361     		str	r3, [r4, #24]
  49:RT-Thread/include/rtservice.h **** }
 991              		.loc 2 49 13 view .LVU324
 992 0014 6361     		str	r3, [r4, #20]
 993              	.LVL106:
  49:RT-Thread/include/rtservice.h **** }
 994              		.loc 2 49 13 view .LVU325
 995              	.LBE108:
 996              	.LBE107:
  64:RT-Thread/src/ipc.c **** }
 997              		.loc 1 64 5 is_stmt 1 view .LVU326
  64:RT-Thread/src/ipc.c **** }
 998              		.loc 1 64 5 is_stmt 0 view .LVU327
 999              	.LBE106:
 1000              	.LBE105:
 538:RT-Thread/src/ipc.c **** 
 539:RT-Thread/src/ipc.c ****     mutex->value = 1;
 1001              		.loc 1 539 5 is_stmt 1 view .LVU328
 1002              		.loc 1 539 18 is_stmt 0 view .LVU329
 1003 0016 0123     		movs	r3, #1
 1004 0018 A383     		strh	r3, [r4, #28]	@ movhi
 540:RT-Thread/src/ipc.c ****     mutex->owner = RT_NULL;
 1005              		.loc 1 540 5 is_stmt 1 view .LVU330
 1006              		.loc 1 540 18 is_stmt 0 view .LVU331
 1007 001a 0020     		movs	r0, #0
 1008 001c 2062     		str	r0, [r4, #32]
 541:RT-Thread/src/ipc.c ****     mutex->original_priority = 0xFF;
 1009              		.loc 1 541 5 is_stmt 1 view .LVU332
 1010              		.loc 1 541 30 is_stmt 0 view .LVU333
 1011 001e FF23     		movs	r3, #255
 1012 0020 A377     		strb	r3, [r4, #30]
 542:RT-Thread/src/ipc.c ****     mutex->hold  = 0;
 1013              		.loc 1 542 5 is_stmt 1 view .LVU334
 1014              		.loc 1 542 18 is_stmt 0 view .LVU335
 1015 0022 E077     		strb	r0, [r4, #31]
 543:RT-Thread/src/ipc.c **** 
 544:RT-Thread/src/ipc.c ****     /* set flag */
 545:RT-Thread/src/ipc.c ****     mutex->parent.parent.flag = flag;
 1016              		.loc 1 545 5 is_stmt 1 view .LVU336
 1017              		.loc 1 545 31 is_stmt 0 view .LVU337
 1018 0024 6572     		strb	r5, [r4, #9]
 546:RT-Thread/src/ipc.c **** 
 547:RT-Thread/src/ipc.c ****     return RT_EOK;
 1019              		.loc 1 547 5 is_stmt 1 view .LVU338
 548:RT-Thread/src/ipc.c **** }
 1020              		.loc 1 548 1 is_stmt 0 view .LVU339
 1021 0026 38BD     		pop	{r3, r4, r5, pc}
 1022              		.loc 1 548 1 view .LVU340
 1023              		.cfi_endproc
 1024              	.LFE27:
 1026              		.section	.text.rt_mutex_detach,"ax",%progbits
 1027              		.align	1
 1028              		.global	rt_mutex_detach
ARM GAS  C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s 			page 33


 1029              		.syntax unified
 1030              		.thumb
 1031              		.thumb_func
 1032              		.fpu softvfp
 1034              	rt_mutex_detach:
 1035              	.LVL107:
 1036              	.LFB28:
 549:RT-Thread/src/ipc.c **** RTM_EXPORT(rt_mutex_init);
 550:RT-Thread/src/ipc.c **** 
 551:RT-Thread/src/ipc.c **** /**
 552:RT-Thread/src/ipc.c ****  * This function will detach a mutex from resource management
 553:RT-Thread/src/ipc.c ****  *
 554:RT-Thread/src/ipc.c ****  * @param mutex the mutex object
 555:RT-Thread/src/ipc.c ****  *
 556:RT-Thread/src/ipc.c ****  * @return the operation status, RT_EOK on successful
 557:RT-Thread/src/ipc.c ****  *
 558:RT-Thread/src/ipc.c ****  * @see rt_mutex_delete
 559:RT-Thread/src/ipc.c ****  */
 560:RT-Thread/src/ipc.c **** rt_err_t rt_mutex_detach(rt_mutex_t mutex)
 561:RT-Thread/src/ipc.c **** {
 1037              		.loc 1 561 1 is_stmt 1 view -0
 1038              		.cfi_startproc
 1039              		@ args = 0, pretend = 0, frame = 0
 1040              		@ frame_needed = 0, uses_anonymous_args = 0
 1041              		.loc 1 561 1 is_stmt 0 view .LVU342
 1042 0000 70B5     		push	{r4, r5, r6, lr}
 1043              	.LCFI13:
 1044              		.cfi_def_cfa_offset 16
 1045              		.cfi_offset 4, -16
 1046              		.cfi_offset 5, -12
 1047              		.cfi_offset 6, -8
 1048              		.cfi_offset 14, -4
 1049 0002 0446     		mov	r4, r0
 562:RT-Thread/src/ipc.c ****     /* parameter check */
 563:RT-Thread/src/ipc.c ****     RT_ASSERT(mutex != RT_NULL);
 1050              		.loc 1 563 32 is_stmt 1 view .LVU343
 564:RT-Thread/src/ipc.c ****     RT_ASSERT(rt_object_get_type(&mutex->parent.parent) == RT_Object_Class_Mutex);
 1051              		.loc 1 564 82 view .LVU344
 565:RT-Thread/src/ipc.c ****     RT_ASSERT(rt_object_is_systemobject(&mutex->parent.parent));
 1052              		.loc 1 565 64 view .LVU345
 566:RT-Thread/src/ipc.c **** 
 567:RT-Thread/src/ipc.c ****     /* wakeup all suspend threads */
 568:RT-Thread/src/ipc.c ****     rt_ipc_list_resume_all(&(mutex->parent.suspend_thread));
 1053              		.loc 1 568 5 view .LVU346
 1054 0004 00F11405 		add	r5, r0, #20
 1055              	.LVL108:
 1056              	.LBB113:
 1057              	.LBI113:
 155:RT-Thread/src/ipc.c **** {
 1058              		.loc 1 155 20 view .LVU347
 1059              	.LBB114:
 157:RT-Thread/src/ipc.c ****     register rt_ubase_t temp;
 1060              		.loc 1 157 5 view .LVU348
 158:RT-Thread/src/ipc.c **** 
 1061              		.loc 1 158 5 view .LVU349
 161:RT-Thread/src/ipc.c ****     {
 1062              		.loc 1 161 5 view .LVU350
ARM GAS  C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s 			page 34


 1063              	.L53:
 161:RT-Thread/src/ipc.c ****     {
 1064              		.loc 1 161 11 view .LVU351
 1065              	.LBB115:
 1066              	.LBI115:
  98:RT-Thread/include/rtservice.h **** {
 1067              		.loc 2 98 15 view .LVU352
 1068              	.LBB116:
 1069              		.loc 2 100 5 view .LVU353
 1070              		.loc 2 100 13 is_stmt 0 view .LVU354
 1071 0008 2B68     		ldr	r3, [r5]
 1072              	.LVL109:
 1073              		.loc 2 100 13 view .LVU355
 1074              	.LBE116:
 1075              	.LBE115:
 161:RT-Thread/src/ipc.c ****     {
 1076              		.loc 1 161 11 view .LVU356
 1077 000a 9D42     		cmp	r5, r3
 1078 000c 0DD0     		beq	.L56
 164:RT-Thread/src/ipc.c **** 
 1079              		.loc 1 164 9 is_stmt 1 view .LVU357
 164:RT-Thread/src/ipc.c **** 
 1080              		.loc 1 164 16 is_stmt 0 view .LVU358
 1081 000e FFF7FEFF 		bl	rt_hw_interrupt_disable
 1082              	.LVL110:
 1083 0012 0646     		mov	r6, r0
 1084              	.LVL111:
 167:RT-Thread/src/ipc.c ****         /* set error code to RT_ERROR */
 1085              		.loc 1 167 9 is_stmt 1 view .LVU359
 167:RT-Thread/src/ipc.c ****         /* set error code to RT_ERROR */
 1086              		.loc 1 167 18 is_stmt 0 view .LVU360
 1087 0014 2868     		ldr	r0, [r5]
 1088              	.LVL112:
 169:RT-Thread/src/ipc.c **** 
 1089              		.loc 1 169 9 is_stmt 1 view .LVU361
 169:RT-Thread/src/ipc.c **** 
 1090              		.loc 1 169 23 is_stmt 0 view .LVU362
 1091 0016 4FF0FF33 		mov	r3, #-1
 1092 001a C361     		str	r3, [r0, #28]
 176:RT-Thread/src/ipc.c **** 
 1093              		.loc 1 176 9 is_stmt 1 view .LVU363
 1094 001c 1438     		subs	r0, r0, #20
 1095              	.LVL113:
 176:RT-Thread/src/ipc.c **** 
 1096              		.loc 1 176 9 is_stmt 0 view .LVU364
 1097 001e FFF7FEFF 		bl	rt_thread_resume
 1098              	.LVL114:
 179:RT-Thread/src/ipc.c ****     }
 1099              		.loc 1 179 9 is_stmt 1 view .LVU365
 1100 0022 3046     		mov	r0, r6
 1101 0024 FFF7FEFF 		bl	rt_hw_interrupt_enable
 1102              	.LVL115:
 1103 0028 EEE7     		b	.L53
 1104              	.LVL116:
 1105              	.L56:
 182:RT-Thread/src/ipc.c **** }
 1106              		.loc 1 182 5 view .LVU366
ARM GAS  C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s 			page 35


 182:RT-Thread/src/ipc.c **** }
 1107              		.loc 1 182 5 is_stmt 0 view .LVU367
 1108              	.LBE114:
 1109              	.LBE113:
 569:RT-Thread/src/ipc.c **** 
 570:RT-Thread/src/ipc.c ****     /* detach semaphore object */
 571:RT-Thread/src/ipc.c ****     rt_object_detach(&(mutex->parent.parent));
 1110              		.loc 1 571 5 is_stmt 1 view .LVU368
 1111 002a 2046     		mov	r0, r4
 1112 002c FFF7FEFF 		bl	rt_object_detach
 1113              	.LVL117:
 572:RT-Thread/src/ipc.c **** 
 573:RT-Thread/src/ipc.c ****     return RT_EOK;
 1114              		.loc 1 573 5 view .LVU369
 574:RT-Thread/src/ipc.c **** }
 1115              		.loc 1 574 1 is_stmt 0 view .LVU370
 1116 0030 0020     		movs	r0, #0
 1117 0032 70BD     		pop	{r4, r5, r6, pc}
 1118              		.loc 1 574 1 view .LVU371
 1119              		.cfi_endproc
 1120              	.LFE28:
 1122              		.section	.text.rt_mutex_create,"ax",%progbits
 1123              		.align	1
 1124              		.global	rt_mutex_create
 1125              		.syntax unified
 1126              		.thumb
 1127              		.thumb_func
 1128              		.fpu softvfp
 1130              	rt_mutex_create:
 1131              	.LVL118:
 1132              	.LFB29:
 575:RT-Thread/src/ipc.c **** RTM_EXPORT(rt_mutex_detach);
 576:RT-Thread/src/ipc.c **** 
 577:RT-Thread/src/ipc.c **** #ifdef RT_USING_HEAP
 578:RT-Thread/src/ipc.c **** /**
 579:RT-Thread/src/ipc.c ****  * This function will create a mutex from system resource
 580:RT-Thread/src/ipc.c ****  *
 581:RT-Thread/src/ipc.c ****  * @param name the name of mutex
 582:RT-Thread/src/ipc.c ****  * @param flag the flag of mutex
 583:RT-Thread/src/ipc.c ****  *
 584:RT-Thread/src/ipc.c ****  * @return the created mutex, RT_NULL on error happen
 585:RT-Thread/src/ipc.c ****  *
 586:RT-Thread/src/ipc.c ****  * @see rt_mutex_init
 587:RT-Thread/src/ipc.c ****  */
 588:RT-Thread/src/ipc.c **** rt_mutex_t rt_mutex_create(const char *name, rt_uint8_t flag)
 589:RT-Thread/src/ipc.c **** {
 1133              		.loc 1 589 1 is_stmt 1 view -0
 1134              		.cfi_startproc
 1135              		@ args = 0, pretend = 0, frame = 0
 1136              		@ frame_needed = 0, uses_anonymous_args = 0
 1137              		.loc 1 589 1 is_stmt 0 view .LVU373
 1138 0000 10B5     		push	{r4, lr}
 1139              	.LCFI14:
 1140              		.cfi_def_cfa_offset 8
 1141              		.cfi_offset 4, -8
 1142              		.cfi_offset 14, -4
 1143 0002 0C46     		mov	r4, r1
ARM GAS  C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s 			page 36


 590:RT-Thread/src/ipc.c ****     struct rt_mutex *mutex;
 1144              		.loc 1 590 5 is_stmt 1 view .LVU374
 591:RT-Thread/src/ipc.c **** 
 592:RT-Thread/src/ipc.c ****     RT_DEBUG_NOT_IN_INTERRUPT;
 1145              		.loc 1 592 30 view .LVU375
 593:RT-Thread/src/ipc.c **** 
 594:RT-Thread/src/ipc.c ****     /* allocate object */
 595:RT-Thread/src/ipc.c ****     mutex = (rt_mutex_t)rt_object_allocate(RT_Object_Class_Mutex, name);
 1146              		.loc 1 595 5 view .LVU376
 1147              		.loc 1 595 25 is_stmt 0 view .LVU377
 1148 0004 0146     		mov	r1, r0
 1149              	.LVL119:
 1150              		.loc 1 595 25 view .LVU378
 1151 0006 0320     		movs	r0, #3
 1152              	.LVL120:
 1153              		.loc 1 595 25 view .LVU379
 1154 0008 FFF7FEFF 		bl	rt_object_allocate
 1155              	.LVL121:
 596:RT-Thread/src/ipc.c ****     if (mutex == RT_NULL)
 1156              		.loc 1 596 5 is_stmt 1 view .LVU380
 1157              		.loc 1 596 8 is_stmt 0 view .LVU381
 1158 000c 0346     		mov	r3, r0
 1159 000e 58B1     		cbz	r0, .L57
 597:RT-Thread/src/ipc.c ****         return mutex;
 598:RT-Thread/src/ipc.c **** 
 599:RT-Thread/src/ipc.c ****     /* init ipc object */
 600:RT-Thread/src/ipc.c ****     rt_ipc_object_init(&(mutex->parent));
 1160              		.loc 1 600 5 is_stmt 1 view .LVU382
 1161              	.LVL122:
 1162              	.LBB117:
 1163              	.LBI117:
  59:RT-Thread/src/ipc.c **** {
 1164              		.loc 1 59 20 view .LVU383
 1165              	.LBB118:
  62:RT-Thread/src/ipc.c **** 
 1166              		.loc 1 62 5 view .LVU384
 1167 0010 00F11402 		add	r2, r0, #20
 1168              	.LVL123:
 1169              	.LBB119:
 1170              	.LBI119:
  47:RT-Thread/include/rtservice.h **** {
 1171              		.loc 2 47 16 view .LVU385
 1172              	.LBB120:
  49:RT-Thread/include/rtservice.h **** }
 1173              		.loc 2 49 5 view .LVU386
  49:RT-Thread/include/rtservice.h **** }
 1174              		.loc 2 49 23 is_stmt 0 view .LVU387
 1175 0014 8261     		str	r2, [r0, #24]
  49:RT-Thread/include/rtservice.h **** }
 1176              		.loc 2 49 13 view .LVU388
 1177 0016 4261     		str	r2, [r0, #20]
 1178              	.LVL124:
  49:RT-Thread/include/rtservice.h **** }
 1179              		.loc 2 49 13 view .LVU389
 1180              	.LBE120:
 1181              	.LBE119:
  64:RT-Thread/src/ipc.c **** }
ARM GAS  C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s 			page 37


 1182              		.loc 1 64 5 is_stmt 1 view .LVU390
  64:RT-Thread/src/ipc.c **** }
 1183              		.loc 1 64 5 is_stmt 0 view .LVU391
 1184              	.LBE118:
 1185              	.LBE117:
 601:RT-Thread/src/ipc.c **** 
 602:RT-Thread/src/ipc.c ****     mutex->value              = 1;
 1186              		.loc 1 602 5 is_stmt 1 view .LVU392
 1187              		.loc 1 602 31 is_stmt 0 view .LVU393
 1188 0018 0122     		movs	r2, #1
 1189 001a 8283     		strh	r2, [r0, #28]	@ movhi
 603:RT-Thread/src/ipc.c ****     mutex->owner              = RT_NULL;
 1190              		.loc 1 603 5 is_stmt 1 view .LVU394
 1191              		.loc 1 603 31 is_stmt 0 view .LVU395
 1192 001c 0022     		movs	r2, #0
 1193 001e 0262     		str	r2, [r0, #32]
 604:RT-Thread/src/ipc.c ****     mutex->original_priority  = 0xFF;
 1194              		.loc 1 604 5 is_stmt 1 view .LVU396
 1195              		.loc 1 604 31 is_stmt 0 view .LVU397
 1196 0020 FF21     		movs	r1, #255
 1197 0022 8177     		strb	r1, [r0, #30]
 605:RT-Thread/src/ipc.c ****     mutex->hold               = 0;
 1198              		.loc 1 605 5 is_stmt 1 view .LVU398
 1199              		.loc 1 605 31 is_stmt 0 view .LVU399
 1200 0024 C277     		strb	r2, [r0, #31]
 606:RT-Thread/src/ipc.c **** 
 607:RT-Thread/src/ipc.c ****     /* set flag */
 608:RT-Thread/src/ipc.c ****     mutex->parent.parent.flag = flag;
 1201              		.loc 1 608 5 is_stmt 1 view .LVU400
 1202              		.loc 1 608 31 is_stmt 0 view .LVU401
 1203 0026 4472     		strb	r4, [r0, #9]
 609:RT-Thread/src/ipc.c **** 
 610:RT-Thread/src/ipc.c ****     return mutex;
 1204              		.loc 1 610 5 is_stmt 1 view .LVU402
 1205              	.L57:
 611:RT-Thread/src/ipc.c **** }
 1206              		.loc 1 611 1 is_stmt 0 view .LVU403
 1207 0028 1846     		mov	r0, r3
 1208              	.LVL125:
 1209              		.loc 1 611 1 view .LVU404
 1210 002a 10BD     		pop	{r4, pc}
 1211              		.cfi_endproc
 1212              	.LFE29:
 1214              		.section	.text.rt_mutex_delete,"ax",%progbits
 1215              		.align	1
 1216              		.global	rt_mutex_delete
 1217              		.syntax unified
 1218              		.thumb
 1219              		.thumb_func
 1220              		.fpu softvfp
 1222              	rt_mutex_delete:
 1223              	.LVL126:
 1224              	.LFB30:
 612:RT-Thread/src/ipc.c **** RTM_EXPORT(rt_mutex_create);
 613:RT-Thread/src/ipc.c **** 
 614:RT-Thread/src/ipc.c **** /**
 615:RT-Thread/src/ipc.c ****  * This function will delete a mutex object and release the memory
ARM GAS  C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s 			page 38


 616:RT-Thread/src/ipc.c ****  *
 617:RT-Thread/src/ipc.c ****  * @param mutex the mutex object
 618:RT-Thread/src/ipc.c ****  *
 619:RT-Thread/src/ipc.c ****  * @return the error code
 620:RT-Thread/src/ipc.c ****  *
 621:RT-Thread/src/ipc.c ****  * @see rt_mutex_detach
 622:RT-Thread/src/ipc.c ****  */
 623:RT-Thread/src/ipc.c **** rt_err_t rt_mutex_delete(rt_mutex_t mutex)
 624:RT-Thread/src/ipc.c **** {
 1225              		.loc 1 624 1 is_stmt 1 view -0
 1226              		.cfi_startproc
 1227              		@ args = 0, pretend = 0, frame = 0
 1228              		@ frame_needed = 0, uses_anonymous_args = 0
 1229              		.loc 1 624 1 is_stmt 0 view .LVU406
 1230 0000 70B5     		push	{r4, r5, r6, lr}
 1231              	.LCFI15:
 1232              		.cfi_def_cfa_offset 16
 1233              		.cfi_offset 4, -16
 1234              		.cfi_offset 5, -12
 1235              		.cfi_offset 6, -8
 1236              		.cfi_offset 14, -4
 1237 0002 0446     		mov	r4, r0
 625:RT-Thread/src/ipc.c ****     RT_DEBUG_NOT_IN_INTERRUPT;
 1238              		.loc 1 625 30 is_stmt 1 view .LVU407
 626:RT-Thread/src/ipc.c **** 
 627:RT-Thread/src/ipc.c ****     /* parameter check */
 628:RT-Thread/src/ipc.c ****     RT_ASSERT(mutex != RT_NULL);
 1239              		.loc 1 628 32 view .LVU408
 629:RT-Thread/src/ipc.c ****     RT_ASSERT(rt_object_get_type(&mutex->parent.parent) == RT_Object_Class_Mutex);
 1240              		.loc 1 629 82 view .LVU409
 630:RT-Thread/src/ipc.c ****     RT_ASSERT(rt_object_is_systemobject(&mutex->parent.parent) == RT_FALSE);
 1241              		.loc 1 630 76 view .LVU410
 631:RT-Thread/src/ipc.c **** 
 632:RT-Thread/src/ipc.c ****     /* wakeup all suspend threads */
 633:RT-Thread/src/ipc.c ****     rt_ipc_list_resume_all(&(mutex->parent.suspend_thread));
 1242              		.loc 1 633 5 view .LVU411
 1243 0004 00F11405 		add	r5, r0, #20
 1244              	.LVL127:
 1245              	.LBB125:
 1246              	.LBI125:
 155:RT-Thread/src/ipc.c **** {
 1247              		.loc 1 155 20 view .LVU412
 1248              	.LBB126:
 157:RT-Thread/src/ipc.c ****     register rt_ubase_t temp;
 1249              		.loc 1 157 5 view .LVU413
 158:RT-Thread/src/ipc.c **** 
 1250              		.loc 1 158 5 view .LVU414
 161:RT-Thread/src/ipc.c ****     {
 1251              		.loc 1 161 5 view .LVU415
 1252              	.L61:
 161:RT-Thread/src/ipc.c ****     {
 1253              		.loc 1 161 11 view .LVU416
 1254              	.LBB127:
 1255              	.LBI127:
  98:RT-Thread/include/rtservice.h **** {
 1256              		.loc 2 98 15 view .LVU417
 1257              	.LBB128:
ARM GAS  C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s 			page 39


 1258              		.loc 2 100 5 view .LVU418
 1259              		.loc 2 100 13 is_stmt 0 view .LVU419
 1260 0008 2B68     		ldr	r3, [r5]
 1261              	.LVL128:
 1262              		.loc 2 100 13 view .LVU420
 1263              	.LBE128:
 1264              	.LBE127:
 161:RT-Thread/src/ipc.c ****     {
 1265              		.loc 1 161 11 view .LVU421
 1266 000a 9D42     		cmp	r5, r3
 1267 000c 0DD0     		beq	.L64
 164:RT-Thread/src/ipc.c **** 
 1268              		.loc 1 164 9 is_stmt 1 view .LVU422
 164:RT-Thread/src/ipc.c **** 
 1269              		.loc 1 164 16 is_stmt 0 view .LVU423
 1270 000e FFF7FEFF 		bl	rt_hw_interrupt_disable
 1271              	.LVL129:
 1272 0012 0646     		mov	r6, r0
 1273              	.LVL130:
 167:RT-Thread/src/ipc.c ****         /* set error code to RT_ERROR */
 1274              		.loc 1 167 9 is_stmt 1 view .LVU424
 167:RT-Thread/src/ipc.c ****         /* set error code to RT_ERROR */
 1275              		.loc 1 167 18 is_stmt 0 view .LVU425
 1276 0014 2868     		ldr	r0, [r5]
 1277              	.LVL131:
 169:RT-Thread/src/ipc.c **** 
 1278              		.loc 1 169 9 is_stmt 1 view .LVU426
 169:RT-Thread/src/ipc.c **** 
 1279              		.loc 1 169 23 is_stmt 0 view .LVU427
 1280 0016 4FF0FF33 		mov	r3, #-1
 1281 001a C361     		str	r3, [r0, #28]
 176:RT-Thread/src/ipc.c **** 
 1282              		.loc 1 176 9 is_stmt 1 view .LVU428
 1283 001c 1438     		subs	r0, r0, #20
 1284              	.LVL132:
 176:RT-Thread/src/ipc.c **** 
 1285              		.loc 1 176 9 is_stmt 0 view .LVU429
 1286 001e FFF7FEFF 		bl	rt_thread_resume
 1287              	.LVL133:
 179:RT-Thread/src/ipc.c ****     }
 1288              		.loc 1 179 9 is_stmt 1 view .LVU430
 1289 0022 3046     		mov	r0, r6
 1290 0024 FFF7FEFF 		bl	rt_hw_interrupt_enable
 1291              	.LVL134:
 1292 0028 EEE7     		b	.L61
 1293              	.LVL135:
 1294              	.L64:
 182:RT-Thread/src/ipc.c **** }
 1295              		.loc 1 182 5 view .LVU431
 182:RT-Thread/src/ipc.c **** }
 1296              		.loc 1 182 5 is_stmt 0 view .LVU432
 1297              	.LBE126:
 1298              	.LBE125:
 634:RT-Thread/src/ipc.c **** 
 635:RT-Thread/src/ipc.c ****     /* delete semaphore object */
 636:RT-Thread/src/ipc.c ****     rt_object_delete(&(mutex->parent.parent));
 1299              		.loc 1 636 5 is_stmt 1 view .LVU433
ARM GAS  C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s 			page 40


 1300 002a 2046     		mov	r0, r4
 1301 002c FFF7FEFF 		bl	rt_object_delete
 1302              	.LVL136:
 637:RT-Thread/src/ipc.c **** 
 638:RT-Thread/src/ipc.c ****     return RT_EOK;
 1303              		.loc 1 638 5 view .LVU434
 639:RT-Thread/src/ipc.c **** }
 1304              		.loc 1 639 1 is_stmt 0 view .LVU435
 1305 0030 0020     		movs	r0, #0
 1306 0032 70BD     		pop	{r4, r5, r6, pc}
 1307              		.loc 1 639 1 view .LVU436
 1308              		.cfi_endproc
 1309              	.LFE30:
 1311              		.section	.text.rt_mutex_take,"ax",%progbits
 1312              		.align	1
 1313              		.global	rt_mutex_take
 1314              		.syntax unified
 1315              		.thumb
 1316              		.thumb_func
 1317              		.fpu softvfp
 1319              	rt_mutex_take:
 1320              	.LVL137:
 1321              	.LFB31:
 640:RT-Thread/src/ipc.c **** RTM_EXPORT(rt_mutex_delete);
 641:RT-Thread/src/ipc.c **** #endif
 642:RT-Thread/src/ipc.c **** 
 643:RT-Thread/src/ipc.c **** /**
 644:RT-Thread/src/ipc.c ****  * This function will take a mutex, if the mutex is unavailable, the
 645:RT-Thread/src/ipc.c ****  * thread shall wait for a specified time.
 646:RT-Thread/src/ipc.c ****  *
 647:RT-Thread/src/ipc.c ****  * @param mutex the mutex object
 648:RT-Thread/src/ipc.c ****  * @param time the waiting time
 649:RT-Thread/src/ipc.c ****  *
 650:RT-Thread/src/ipc.c ****  * @return the error code
 651:RT-Thread/src/ipc.c ****  */
 652:RT-Thread/src/ipc.c **** rt_err_t rt_mutex_take(rt_mutex_t mutex, rt_int32_t time)
 653:RT-Thread/src/ipc.c **** {
 1322              		.loc 1 653 1 is_stmt 1 view -0
 1323              		.cfi_startproc
 1324              		@ args = 0, pretend = 0, frame = 8
 1325              		@ frame_needed = 0, uses_anonymous_args = 0
 1326              		.loc 1 653 1 is_stmt 0 view .LVU438
 1327 0000 2DE9F041 		push	{r4, r5, r6, r7, r8, lr}
 1328              	.LCFI16:
 1329              		.cfi_def_cfa_offset 24
 1330              		.cfi_offset 4, -24
 1331              		.cfi_offset 5, -20
 1332              		.cfi_offset 6, -16
 1333              		.cfi_offset 7, -12
 1334              		.cfi_offset 8, -8
 1335              		.cfi_offset 14, -4
 1336 0004 82B0     		sub	sp, sp, #8
 1337              	.LCFI17:
 1338              		.cfi_def_cfa_offset 32
 1339 0006 0546     		mov	r5, r0
 1340 0008 0191     		str	r1, [sp, #4]
 654:RT-Thread/src/ipc.c ****     register rt_base_t temp;
ARM GAS  C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s 			page 41


 1341              		.loc 1 654 5 is_stmt 1 view .LVU439
 655:RT-Thread/src/ipc.c ****     struct rt_thread *thread;
 1342              		.loc 1 655 5 view .LVU440
 656:RT-Thread/src/ipc.c **** 
 657:RT-Thread/src/ipc.c ****     /* this function must not be used in interrupt even if time = 0 */
 658:RT-Thread/src/ipc.c ****     RT_DEBUG_IN_THREAD_CONTEXT;
 1343              		.loc 1 658 31 view .LVU441
 659:RT-Thread/src/ipc.c **** 
 660:RT-Thread/src/ipc.c ****     /* parameter check */
 661:RT-Thread/src/ipc.c ****     RT_ASSERT(mutex != RT_NULL);
 1344              		.loc 1 661 32 view .LVU442
 662:RT-Thread/src/ipc.c ****     RT_ASSERT(rt_object_get_type(&mutex->parent.parent) == RT_Object_Class_Mutex);
 1345              		.loc 1 662 82 view .LVU443
 663:RT-Thread/src/ipc.c **** 
 664:RT-Thread/src/ipc.c ****     /* get current thread */
 665:RT-Thread/src/ipc.c ****     thread = rt_thread_self();
 1346              		.loc 1 665 5 view .LVU444
 1347              		.loc 1 665 14 is_stmt 0 view .LVU445
 1348 000a FFF7FEFF 		bl	rt_thread_self
 1349              	.LVL138:
 1350              		.loc 1 665 14 view .LVU446
 1351 000e 0446     		mov	r4, r0
 1352              	.LVL139:
 666:RT-Thread/src/ipc.c **** 
 667:RT-Thread/src/ipc.c ****     /* disable interrupt */
 668:RT-Thread/src/ipc.c ****     temp = rt_hw_interrupt_disable();
 1353              		.loc 1 668 5 is_stmt 1 view .LVU447
 1354              		.loc 1 668 12 is_stmt 0 view .LVU448
 1355 0010 FFF7FEFF 		bl	rt_hw_interrupt_disable
 1356              	.LVL140:
 1357              		.loc 1 668 12 view .LVU449
 1358 0014 8046     		mov	r8, r0
 1359              	.LVL141:
 669:RT-Thread/src/ipc.c **** 
 670:RT-Thread/src/ipc.c ****     RT_OBJECT_HOOK_CALL(rt_object_trytake_hook, (&(mutex->parent.parent)));
 1360              		.loc 1 670 75 is_stmt 1 view .LVU450
 671:RT-Thread/src/ipc.c **** 
 672:RT-Thread/src/ipc.c ****     RT_DEBUG_LOG(RT_DEBUG_IPC,
 673:RT-Thread/src/ipc.c ****                  ("mutex_take: current thread %s, mutex value: %d, hold: %d\n",
 674:RT-Thread/src/ipc.c ****                   thread->name, mutex->value, mutex->hold));
 1361              		.loc 1 674 60 view .LVU451
 675:RT-Thread/src/ipc.c **** 
 676:RT-Thread/src/ipc.c ****     /* reset thread error */
 677:RT-Thread/src/ipc.c ****     thread->error = RT_EOK;
 1362              		.loc 1 677 5 view .LVU452
 1363              		.loc 1 677 19 is_stmt 0 view .LVU453
 1364 0016 0023     		movs	r3, #0
 1365 0018 2363     		str	r3, [r4, #48]
 678:RT-Thread/src/ipc.c **** 
 679:RT-Thread/src/ipc.c ****     if (mutex->owner == thread)
 1366              		.loc 1 679 5 is_stmt 1 view .LVU454
 1367              		.loc 1 679 14 is_stmt 0 view .LVU455
 1368 001a 2B6A     		ldr	r3, [r5, #32]
 1369              		.loc 1 679 8 view .LVU456
 1370 001c A342     		cmp	r3, r4
 1371 001e 37D1     		bne	.L66
 680:RT-Thread/src/ipc.c ****     {
ARM GAS  C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s 			page 42


 681:RT-Thread/src/ipc.c ****         /* it's the same thread */
 682:RT-Thread/src/ipc.c ****         mutex->hold ++;
 1372              		.loc 1 682 9 is_stmt 1 view .LVU457
 1373              		.loc 1 682 14 is_stmt 0 view .LVU458
 1374 0020 EB7F     		ldrb	r3, [r5, #31]	@ zero_extendqisi2
 1375              		.loc 1 682 21 view .LVU459
 1376 0022 0133     		adds	r3, r3, #1
 1377 0024 EB77     		strb	r3, [r5, #31]
 1378              	.LVL142:
 1379              	.L67:
 683:RT-Thread/src/ipc.c ****     }
 684:RT-Thread/src/ipc.c ****     else
 685:RT-Thread/src/ipc.c ****     {
 686:RT-Thread/src/ipc.c **** __again:
 687:RT-Thread/src/ipc.c ****         /* The value of mutex is 1 in initial status. Therefore, if the
 688:RT-Thread/src/ipc.c ****          * value is great than 0, it indicates the mutex is avaible.
 689:RT-Thread/src/ipc.c ****          */
 690:RT-Thread/src/ipc.c ****         if (mutex->value > 0)
 691:RT-Thread/src/ipc.c ****         {
 692:RT-Thread/src/ipc.c ****             /* mutex is available */
 693:RT-Thread/src/ipc.c ****             mutex->value --;
 694:RT-Thread/src/ipc.c **** 
 695:RT-Thread/src/ipc.c ****             /* set mutex owner and original priority */
 696:RT-Thread/src/ipc.c ****             mutex->owner             = thread;
 697:RT-Thread/src/ipc.c ****             mutex->original_priority = thread->current_priority;
 698:RT-Thread/src/ipc.c ****             mutex->hold ++;
 699:RT-Thread/src/ipc.c ****         }
 700:RT-Thread/src/ipc.c ****         else
 701:RT-Thread/src/ipc.c ****         {
 702:RT-Thread/src/ipc.c ****             /* no waiting, return with timeout */
 703:RT-Thread/src/ipc.c ****             if (time == 0)
 704:RT-Thread/src/ipc.c ****             {
 705:RT-Thread/src/ipc.c ****                 /* set error as timeout */
 706:RT-Thread/src/ipc.c ****                 thread->error = -RT_ETIMEOUT;
 707:RT-Thread/src/ipc.c **** 
 708:RT-Thread/src/ipc.c ****                 /* enable interrupt */
 709:RT-Thread/src/ipc.c ****                 rt_hw_interrupt_enable(temp);
 710:RT-Thread/src/ipc.c **** 
 711:RT-Thread/src/ipc.c ****                 return -RT_ETIMEOUT;
 712:RT-Thread/src/ipc.c ****             }
 713:RT-Thread/src/ipc.c ****             else
 714:RT-Thread/src/ipc.c ****             {
 715:RT-Thread/src/ipc.c ****                 /* mutex is unavailable, push to suspend list */
 716:RT-Thread/src/ipc.c ****                 RT_DEBUG_LOG(RT_DEBUG_IPC, ("mutex_take: suspend thread: %s\n",
 717:RT-Thread/src/ipc.c ****                                             thread->name));
 718:RT-Thread/src/ipc.c **** 
 719:RT-Thread/src/ipc.c ****                 /* change the owner thread priority of mutex */
 720:RT-Thread/src/ipc.c ****                 if (thread->current_priority < mutex->owner->current_priority)
 721:RT-Thread/src/ipc.c ****                 {
 722:RT-Thread/src/ipc.c ****                     /* change the owner thread priority */
 723:RT-Thread/src/ipc.c ****                     rt_thread_control(mutex->owner,
 724:RT-Thread/src/ipc.c ****                                       RT_THREAD_CTRL_CHANGE_PRIORITY,
 725:RT-Thread/src/ipc.c ****                                       &thread->current_priority);
 726:RT-Thread/src/ipc.c ****                 }
 727:RT-Thread/src/ipc.c **** 
 728:RT-Thread/src/ipc.c ****                 /* suspend current thread */
 729:RT-Thread/src/ipc.c ****                 rt_ipc_list_suspend(&(mutex->parent.suspend_thread),
ARM GAS  C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s 			page 43


 730:RT-Thread/src/ipc.c ****                                     thread,
 731:RT-Thread/src/ipc.c ****                                     mutex->parent.parent.flag);
 732:RT-Thread/src/ipc.c **** 
 733:RT-Thread/src/ipc.c ****                 /* has waiting time, start thread timer */
 734:RT-Thread/src/ipc.c ****                 if (time > 0)
 735:RT-Thread/src/ipc.c ****                 {
 736:RT-Thread/src/ipc.c ****                     RT_DEBUG_LOG(RT_DEBUG_IPC,
 737:RT-Thread/src/ipc.c ****                                  ("mutex_take: start the timer of thread:%s\n",
 738:RT-Thread/src/ipc.c ****                                   thread->name));
 739:RT-Thread/src/ipc.c **** 
 740:RT-Thread/src/ipc.c ****                     /* reset the timeout of thread timer and start it */
 741:RT-Thread/src/ipc.c ****                     rt_timer_control(&(thread->thread_timer),
 742:RT-Thread/src/ipc.c ****                                      RT_TIMER_CTRL_SET_TIME,
 743:RT-Thread/src/ipc.c ****                                      &time);
 744:RT-Thread/src/ipc.c ****                     rt_timer_start(&(thread->thread_timer));
 745:RT-Thread/src/ipc.c ****                 }
 746:RT-Thread/src/ipc.c **** 
 747:RT-Thread/src/ipc.c ****                 /* enable interrupt */
 748:RT-Thread/src/ipc.c ****                 rt_hw_interrupt_enable(temp);
 749:RT-Thread/src/ipc.c **** 
 750:RT-Thread/src/ipc.c ****                 /* do schedule */
 751:RT-Thread/src/ipc.c ****                 rt_schedule();
 752:RT-Thread/src/ipc.c **** 
 753:RT-Thread/src/ipc.c ****                 if (thread->error != RT_EOK)
 754:RT-Thread/src/ipc.c ****                 {
 755:RT-Thread/src/ipc.c ****                     /* interrupt by signal, try it again */
 756:RT-Thread/src/ipc.c ****                     if (thread->error == -RT_EINTR) goto __again;
 757:RT-Thread/src/ipc.c **** 
 758:RT-Thread/src/ipc.c ****                     /* return error */
 759:RT-Thread/src/ipc.c ****                     return thread->error;
 760:RT-Thread/src/ipc.c ****                 }
 761:RT-Thread/src/ipc.c ****                 else
 762:RT-Thread/src/ipc.c ****                 {
 763:RT-Thread/src/ipc.c ****                     /* the mutex is taken successfully. */
 764:RT-Thread/src/ipc.c ****                     /* disable interrupt */
 765:RT-Thread/src/ipc.c ****                     temp = rt_hw_interrupt_disable();
 766:RT-Thread/src/ipc.c ****                 }
 767:RT-Thread/src/ipc.c ****             }
 768:RT-Thread/src/ipc.c ****         }
 769:RT-Thread/src/ipc.c ****     }
 770:RT-Thread/src/ipc.c **** 
 771:RT-Thread/src/ipc.c ****     /* enable interrupt */
 772:RT-Thread/src/ipc.c ****     rt_hw_interrupt_enable(temp);
 1380              		.loc 1 772 5 is_stmt 1 view .LVU460
 1381 0026 4046     		mov	r0, r8
 1382 0028 FFF7FEFF 		bl	rt_hw_interrupt_enable
 1383              	.LVL143:
 773:RT-Thread/src/ipc.c **** 
 774:RT-Thread/src/ipc.c ****     RT_OBJECT_HOOK_CALL(rt_object_take_hook, (&(mutex->parent.parent)));
 1384              		.loc 1 774 72 view .LVU461
 775:RT-Thread/src/ipc.c **** 
 776:RT-Thread/src/ipc.c ****     return RT_EOK;
 1385              		.loc 1 776 5 view .LVU462
 1386              		.loc 1 776 12 is_stmt 0 view .LVU463
 1387 002c 0020     		movs	r0, #0
 1388              	.LVL144:
 1389              	.L65:
ARM GAS  C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s 			page 44


 777:RT-Thread/src/ipc.c **** }
 1390              		.loc 1 777 1 view .LVU464
 1391 002e 02B0     		add	sp, sp, #8
 1392              	.LCFI18:
 1393              		.cfi_remember_state
 1394              		.cfi_def_cfa_offset 24
 1395              		@ sp needed
 1396 0030 BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 1397              	.LVL145:
 1398              	.L83:
 1399              	.LCFI19:
 1400              		.cfi_restore_state
 693:RT-Thread/src/ipc.c **** 
 1401              		.loc 1 693 13 is_stmt 1 view .LVU465
 693:RT-Thread/src/ipc.c **** 
 1402              		.loc 1 693 26 is_stmt 0 view .LVU466
 1403 0034 013B     		subs	r3, r3, #1
 1404 0036 AB83     		strh	r3, [r5, #28]	@ movhi
 696:RT-Thread/src/ipc.c ****             mutex->original_priority = thread->current_priority;
 1405              		.loc 1 696 13 is_stmt 1 view .LVU467
 696:RT-Thread/src/ipc.c ****             mutex->original_priority = thread->current_priority;
 1406              		.loc 1 696 38 is_stmt 0 view .LVU468
 1407 0038 2C62     		str	r4, [r5, #32]
 697:RT-Thread/src/ipc.c ****             mutex->hold ++;
 1408              		.loc 1 697 13 is_stmt 1 view .LVU469
 697:RT-Thread/src/ipc.c ****             mutex->hold ++;
 1409              		.loc 1 697 46 is_stmt 0 view .LVU470
 1410 003a 94F83530 		ldrb	r3, [r4, #53]	@ zero_extendqisi2
 697:RT-Thread/src/ipc.c ****             mutex->hold ++;
 1411              		.loc 1 697 38 view .LVU471
 1412 003e AB77     		strb	r3, [r5, #30]
 698:RT-Thread/src/ipc.c ****         }
 1413              		.loc 1 698 13 is_stmt 1 view .LVU472
 698:RT-Thread/src/ipc.c ****         }
 1414              		.loc 1 698 18 is_stmt 0 view .LVU473
 1415 0040 EB7F     		ldrb	r3, [r5, #31]	@ zero_extendqisi2
 698:RT-Thread/src/ipc.c ****         }
 1416              		.loc 1 698 25 view .LVU474
 1417 0042 0133     		adds	r3, r3, #1
 1418 0044 EB77     		strb	r3, [r5, #31]
 1419 0046 EEE7     		b	.L67
 1420              	.L84:
 706:RT-Thread/src/ipc.c **** 
 1421              		.loc 1 706 17 is_stmt 1 view .LVU475
 706:RT-Thread/src/ipc.c **** 
 1422              		.loc 1 706 31 is_stmt 0 view .LVU476
 1423 0048 6FF00105 		mvn	r5, #1
 1424              	.LVL146:
 706:RT-Thread/src/ipc.c **** 
 1425              		.loc 1 706 31 view .LVU477
 1426 004c 2563     		str	r5, [r4, #48]
 709:RT-Thread/src/ipc.c **** 
 1427              		.loc 1 709 17 is_stmt 1 view .LVU478
 1428 004e 4046     		mov	r0, r8
 1429 0050 FFF7FEFF 		bl	rt_hw_interrupt_enable
 1430              	.LVL147:
 711:RT-Thread/src/ipc.c ****             }
ARM GAS  C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s 			page 45


 1431              		.loc 1 711 17 view .LVU479
 711:RT-Thread/src/ipc.c ****             }
 1432              		.loc 1 711 24 is_stmt 0 view .LVU480
 1433 0054 2846     		mov	r0, r5
 1434 0056 EAE7     		b	.L65
 1435              	.LVL148:
 1436              	.L85:
 723:RT-Thread/src/ipc.c ****                                       RT_THREAD_CTRL_CHANGE_PRIORITY,
 1437              		.loc 1 723 21 is_stmt 1 view .LVU481
 1438 0058 04F13502 		add	r2, r4, #53
 1439 005c 0221     		movs	r1, #2
 1440 005e FFF7FEFF 		bl	rt_thread_control
 1441              	.LVL149:
 1442 0062 22E0     		b	.L71
 1443              	.LVL150:
 1444              	.L72:
 1445              	.LBB138:
 1446              	.LBB139:
  88:RT-Thread/src/ipc.c ****         break;
 1447              		.loc 1 88 9 view .LVU482
 1448 0064 04F11403 		add	r3, r4, #20
 1449              	.LVL151:
 1450              	.LBB140:
 1451              	.LBI140:
  73:RT-Thread/include/rtservice.h **** {
 1452              		.loc 2 73 16 view .LVU483
 1453              	.LBB141:
  75:RT-Thread/include/rtservice.h ****     n->prev = l->prev;
 1454              		.loc 2 75 5 view .LVU484
  75:RT-Thread/include/rtservice.h ****     n->prev = l->prev;
 1455              		.loc 2 75 6 is_stmt 0 view .LVU485
 1456 0068 7268     		ldr	r2, [r6, #4]
  75:RT-Thread/include/rtservice.h ****     n->prev = l->prev;
 1457              		.loc 2 75 19 view .LVU486
 1458 006a 1360     		str	r3, [r2]
  76:RT-Thread/include/rtservice.h **** 
 1459              		.loc 2 76 5 is_stmt 1 view .LVU487
  76:RT-Thread/include/rtservice.h **** 
 1460              		.loc 2 76 16 is_stmt 0 view .LVU488
 1461 006c 7268     		ldr	r2, [r6, #4]
  76:RT-Thread/include/rtservice.h **** 
 1462              		.loc 2 76 13 view .LVU489
 1463 006e A261     		str	r2, [r4, #24]
  78:RT-Thread/include/rtservice.h ****     n->next = l;
 1464              		.loc 2 78 5 is_stmt 1 view .LVU490
  78:RT-Thread/include/rtservice.h ****     n->next = l;
 1465              		.loc 2 78 13 is_stmt 0 view .LVU491
 1466 0070 7360     		str	r3, [r6, #4]
  79:RT-Thread/include/rtservice.h **** }
 1467              		.loc 2 79 5 is_stmt 1 view .LVU492
  79:RT-Thread/include/rtservice.h **** }
 1468              		.loc 2 79 13 is_stmt 0 view .LVU493
 1469 0072 6661     		str	r6, [r4, #20]
 1470              	.LVL152:
 1471              	.L74:
  79:RT-Thread/include/rtservice.h **** }
 1472              		.loc 2 79 13 view .LVU494
ARM GAS  C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s 			page 46


 1473              	.LBE141:
 1474              	.LBE140:
 120:RT-Thread/src/ipc.c **** }
 1475              		.loc 1 120 5 is_stmt 1 view .LVU495
 120:RT-Thread/src/ipc.c **** }
 1476              		.loc 1 120 5 is_stmt 0 view .LVU496
 1477              	.LBE139:
 1478              	.LBE138:
 734:RT-Thread/src/ipc.c ****                 {
 1479              		.loc 1 734 17 is_stmt 1 view .LVU497
 734:RT-Thread/src/ipc.c ****                 {
 1480              		.loc 1 734 26 is_stmt 0 view .LVU498
 1481 0074 019B     		ldr	r3, [sp, #4]
 734:RT-Thread/src/ipc.c ****                 {
 1482              		.loc 1 734 20 view .LVU499
 1483 0076 002B     		cmp	r3, #0
 1484 0078 3FDC     		bgt	.L82
 1485              	.L79:
 748:RT-Thread/src/ipc.c **** 
 1486              		.loc 1 748 17 is_stmt 1 view .LVU500
 1487 007a 4046     		mov	r0, r8
 1488 007c FFF7FEFF 		bl	rt_hw_interrupt_enable
 1489              	.LVL153:
 751:RT-Thread/src/ipc.c **** 
 1490              		.loc 1 751 17 view .LVU501
 1491 0080 FFF7FEFF 		bl	rt_schedule
 1492              	.LVL154:
 753:RT-Thread/src/ipc.c ****                 {
 1493              		.loc 1 753 17 view .LVU502
 753:RT-Thread/src/ipc.c ****                 {
 1494              		.loc 1 753 27 is_stmt 0 view .LVU503
 1495 0084 206B     		ldr	r0, [r4, #48]
 753:RT-Thread/src/ipc.c ****                 {
 1496              		.loc 1 753 20 view .LVU504
 1497 0086 0028     		cmp	r0, #0
 1498 0088 42D0     		beq	.L80
 756:RT-Thread/src/ipc.c **** 
 1499              		.loc 1 756 21 is_stmt 1 view .LVU505
 756:RT-Thread/src/ipc.c **** 
 1500              		.loc 1 756 24 is_stmt 0 view .LVU506
 1501 008a 10F1090F 		cmn	r0, #9
 1502 008e CED1     		bne	.L65
 1503              	.L66:
 690:RT-Thread/src/ipc.c ****         {
 1504              		.loc 1 690 9 is_stmt 1 view .LVU507
 690:RT-Thread/src/ipc.c ****         {
 1505              		.loc 1 690 18 is_stmt 0 view .LVU508
 1506 0090 AB8B     		ldrh	r3, [r5, #28]
 690:RT-Thread/src/ipc.c ****         {
 1507              		.loc 1 690 12 view .LVU509
 1508 0092 002B     		cmp	r3, #0
 1509 0094 CED1     		bne	.L83
 703:RT-Thread/src/ipc.c ****             {
 1510              		.loc 1 703 13 is_stmt 1 view .LVU510
 703:RT-Thread/src/ipc.c ****             {
 1511              		.loc 1 703 22 is_stmt 0 view .LVU511
 1512 0096 019B     		ldr	r3, [sp, #4]
ARM GAS  C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s 			page 47


 703:RT-Thread/src/ipc.c ****             {
 1513              		.loc 1 703 16 view .LVU512
 1514 0098 002B     		cmp	r3, #0
 1515 009a D5D0     		beq	.L84
 717:RT-Thread/src/ipc.c **** 
 1516              		.loc 1 717 59 is_stmt 1 view .LVU513
 720:RT-Thread/src/ipc.c ****                 {
 1517              		.loc 1 720 17 view .LVU514
 720:RT-Thread/src/ipc.c ****                 {
 1518              		.loc 1 720 27 is_stmt 0 view .LVU515
 1519 009c 94F83520 		ldrb	r2, [r4, #53]	@ zero_extendqisi2
 720:RT-Thread/src/ipc.c ****                 {
 1520              		.loc 1 720 53 view .LVU516
 1521 00a0 286A     		ldr	r0, [r5, #32]
 720:RT-Thread/src/ipc.c ****                 {
 1522              		.loc 1 720 60 view .LVU517
 1523 00a2 90F83530 		ldrb	r3, [r0, #53]	@ zero_extendqisi2
 720:RT-Thread/src/ipc.c ****                 {
 1524              		.loc 1 720 20 view .LVU518
 1525 00a6 9A42     		cmp	r2, r3
 1526 00a8 D6D3     		bcc	.L85
 1527              	.L71:
 729:RT-Thread/src/ipc.c ****                                     thread,
 1528              		.loc 1 729 17 is_stmt 1 view .LVU519
 1529 00aa 05F11406 		add	r6, r5, #20
 1530 00ae 6F7A     		ldrb	r7, [r5, #9]	@ zero_extendqisi2
 1531              	.LVL155:
 1532              	.LBB148:
 1533              	.LBI138:
  78:RT-Thread/src/ipc.c ****                                        struct rt_thread *thread,
 1534              		.loc 1 78 20 view .LVU520
 1535              	.LBB147:
  83:RT-Thread/src/ipc.c **** 
 1536              		.loc 1 83 5 view .LVU521
 1537 00b0 2046     		mov	r0, r4
 1538 00b2 FFF7FEFF 		bl	rt_thread_suspend
 1539              	.LVL156:
  85:RT-Thread/src/ipc.c ****     {
 1540              		.loc 1 85 5 view .LVU522
 1541 00b6 002F     		cmp	r7, #0
 1542 00b8 D4D0     		beq	.L72
 1543 00ba 012F     		cmp	r7, #1
 1544 00bc DAD1     		bne	.L74
 1545              	.LBB142:
  93:RT-Thread/src/ipc.c ****             struct rt_thread *sthread;
 1546              		.loc 1 93 13 view .LVU523
  94:RT-Thread/src/ipc.c **** 
 1547              		.loc 1 94 13 view .LVU524
  97:RT-Thread/src/ipc.c ****             {
 1548              		.loc 1 97 13 view .LVU525
  97:RT-Thread/src/ipc.c ****             {
 1549              		.loc 1 97 20 is_stmt 0 view .LVU526
 1550 00be 6B69     		ldr	r3, [r5, #20]
 1551              	.LVL157:
 1552              	.L75:
  97:RT-Thread/src/ipc.c ****             {
 1553              		.loc 1 97 34 is_stmt 1 view .LVU527
ARM GAS  C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s 			page 48


  97:RT-Thread/src/ipc.c ****             {
 1554              		.loc 1 97 13 is_stmt 0 view .LVU528
 1555 00c0 9E42     		cmp	r6, r3
 1556 00c2 0FD0     		beq	.L77
  99:RT-Thread/src/ipc.c **** 
 1557              		.loc 1 99 17 is_stmt 1 view .LVU529
 1558              	.LVL158:
 102:RT-Thread/src/ipc.c ****                 {
 1559              		.loc 1 102 17 view .LVU530
 102:RT-Thread/src/ipc.c ****                 {
 1560              		.loc 1 102 27 is_stmt 0 view .LVU531
 1561 00c4 94F83510 		ldrb	r1, [r4, #53]	@ zero_extendqisi2
 102:RT-Thread/src/ipc.c ****                 {
 1562              		.loc 1 102 55 view .LVU532
 1563 00c8 93F82120 		ldrb	r2, [r3, #33]	@ zero_extendqisi2
 102:RT-Thread/src/ipc.c ****                 {
 1564              		.loc 1 102 20 view .LVU533
 1565 00cc 9142     		cmp	r1, r2
 1566 00ce 01D3     		bcc	.L86
  97:RT-Thread/src/ipc.c ****             {
 1567              		.loc 1 97 45 is_stmt 1 view .LVU534
  97:RT-Thread/src/ipc.c ****             {
 1568              		.loc 1 97 47 is_stmt 0 view .LVU535
 1569 00d0 1B68     		ldr	r3, [r3]
 1570              	.LVL159:
  97:RT-Thread/src/ipc.c ****             {
 1571              		.loc 1 97 47 view .LVU536
 1572 00d2 F5E7     		b	.L75
 1573              	.LVL160:
 1574              	.L86:
 105:RT-Thread/src/ipc.c ****                     break;
 1575              		.loc 1 105 21 is_stmt 1 view .LVU537
 1576 00d4 04F11402 		add	r2, r4, #20
 1577              	.LVL161:
 1578              	.LBB143:
 1579              	.LBI143:
  73:RT-Thread/include/rtservice.h **** {
 1580              		.loc 2 73 16 view .LVU538
 1581              	.LBB144:
  75:RT-Thread/include/rtservice.h ****     n->prev = l->prev;
 1582              		.loc 2 75 5 view .LVU539
  75:RT-Thread/include/rtservice.h ****     n->prev = l->prev;
 1583              		.loc 2 75 6 is_stmt 0 view .LVU540
 1584 00d8 5968     		ldr	r1, [r3, #4]
  75:RT-Thread/include/rtservice.h ****     n->prev = l->prev;
 1585              		.loc 2 75 19 view .LVU541
 1586 00da 0A60     		str	r2, [r1]
  76:RT-Thread/include/rtservice.h **** 
 1587              		.loc 2 76 5 is_stmt 1 view .LVU542
  76:RT-Thread/include/rtservice.h **** 
 1588              		.loc 2 76 16 is_stmt 0 view .LVU543
 1589 00dc 5968     		ldr	r1, [r3, #4]
  76:RT-Thread/include/rtservice.h **** 
 1590              		.loc 2 76 13 view .LVU544
 1591 00de A161     		str	r1, [r4, #24]
  78:RT-Thread/include/rtservice.h ****     n->next = l;
 1592              		.loc 2 78 5 is_stmt 1 view .LVU545
ARM GAS  C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s 			page 49


  78:RT-Thread/include/rtservice.h ****     n->next = l;
 1593              		.loc 2 78 13 is_stmt 0 view .LVU546
 1594 00e0 5A60     		str	r2, [r3, #4]
  79:RT-Thread/include/rtservice.h **** }
 1595              		.loc 2 79 5 is_stmt 1 view .LVU547
  79:RT-Thread/include/rtservice.h **** }
 1596              		.loc 2 79 13 is_stmt 0 view .LVU548
 1597 00e2 6361     		str	r3, [r4, #20]
 1598              	.LVL162:
 1599              	.L77:
  79:RT-Thread/include/rtservice.h **** }
 1600              		.loc 2 79 13 view .LVU549
 1601              	.LBE144:
 1602              	.LBE143:
 114:RT-Thread/src/ipc.c ****                 rt_list_insert_before(list, &(thread->tlist));
 1603              		.loc 1 114 13 is_stmt 1 view .LVU550
 114:RT-Thread/src/ipc.c ****                 rt_list_insert_before(list, &(thread->tlist));
 1604              		.loc 1 114 16 is_stmt 0 view .LVU551
 1605 00e4 9E42     		cmp	r6, r3
 1606 00e6 C5D1     		bne	.L74
 115:RT-Thread/src/ipc.c ****         }
 1607              		.loc 1 115 17 is_stmt 1 view .LVU552
 1608 00e8 04F11403 		add	r3, r4, #20
 1609              	.LVL163:
 1610              	.LBB145:
 1611              	.LBI145:
  73:RT-Thread/include/rtservice.h **** {
 1612              		.loc 2 73 16 view .LVU553
 1613              	.LBB146:
  75:RT-Thread/include/rtservice.h ****     n->prev = l->prev;
 1614              		.loc 2 75 5 view .LVU554
  75:RT-Thread/include/rtservice.h ****     n->prev = l->prev;
 1615              		.loc 2 75 6 is_stmt 0 view .LVU555
 1616 00ec 7268     		ldr	r2, [r6, #4]
  75:RT-Thread/include/rtservice.h ****     n->prev = l->prev;
 1617              		.loc 2 75 19 view .LVU556
 1618 00ee 1360     		str	r3, [r2]
  76:RT-Thread/include/rtservice.h **** 
 1619              		.loc 2 76 5 is_stmt 1 view .LVU557
  76:RT-Thread/include/rtservice.h **** 
 1620              		.loc 2 76 16 is_stmt 0 view .LVU558
 1621 00f0 7268     		ldr	r2, [r6, #4]
  76:RT-Thread/include/rtservice.h **** 
 1622              		.loc 2 76 13 view .LVU559
 1623 00f2 A261     		str	r2, [r4, #24]
  78:RT-Thread/include/rtservice.h ****     n->next = l;
 1624              		.loc 2 78 5 is_stmt 1 view .LVU560
  78:RT-Thread/include/rtservice.h ****     n->next = l;
 1625              		.loc 2 78 13 is_stmt 0 view .LVU561
 1626 00f4 7360     		str	r3, [r6, #4]
  79:RT-Thread/include/rtservice.h **** }
 1627              		.loc 2 79 5 is_stmt 1 view .LVU562
  79:RT-Thread/include/rtservice.h **** }
 1628              		.loc 2 79 13 is_stmt 0 view .LVU563
 1629 00f6 6661     		str	r6, [r4, #20]
  80:RT-Thread/include/rtservice.h **** 
 1630              		.loc 2 80 1 view .LVU564
ARM GAS  C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s 			page 50


 1631 00f8 BCE7     		b	.L74
 1632              	.LVL164:
 1633              	.L82:
  80:RT-Thread/include/rtservice.h **** 
 1634              		.loc 2 80 1 view .LVU565
 1635              	.LBE146:
 1636              	.LBE145:
 1637              	.LBE142:
 1638              	.LBE147:
 1639              	.LBE148:
 738:RT-Thread/src/ipc.c **** 
 1640              		.loc 1 738 49 is_stmt 1 view .LVU566
 741:RT-Thread/src/ipc.c ****                                      RT_TIMER_CTRL_SET_TIME,
 1641              		.loc 1 741 21 view .LVU567
 1642 00fa 04F15006 		add	r6, r4, #80
 1643 00fe 01AA     		add	r2, sp, #4
 1644 0100 0021     		movs	r1, #0
 1645 0102 3046     		mov	r0, r6
 1646 0104 FFF7FEFF 		bl	rt_timer_control
 1647              	.LVL165:
 744:RT-Thread/src/ipc.c ****                 }
 1648              		.loc 1 744 21 view .LVU568
 1649 0108 3046     		mov	r0, r6
 1650 010a FFF7FEFF 		bl	rt_timer_start
 1651              	.LVL166:
 1652 010e B4E7     		b	.L79
 1653              	.L80:
 765:RT-Thread/src/ipc.c ****                 }
 1654              		.loc 1 765 21 view .LVU569
 765:RT-Thread/src/ipc.c ****                 }
 1655              		.loc 1 765 28 is_stmt 0 view .LVU570
 1656 0110 FFF7FEFF 		bl	rt_hw_interrupt_disable
 1657              	.LVL167:
 1658 0114 8046     		mov	r8, r0
 1659              	.LVL168:
 765:RT-Thread/src/ipc.c ****                 }
 1660              		.loc 1 765 28 view .LVU571
 1661 0116 86E7     		b	.L67
 1662              		.cfi_endproc
 1663              	.LFE31:
 1665              		.section	.text.rt_mutex_release,"ax",%progbits
 1666              		.align	1
 1667              		.global	rt_mutex_release
 1668              		.syntax unified
 1669              		.thumb
 1670              		.thumb_func
 1671              		.fpu softvfp
 1673              	rt_mutex_release:
 1674              	.LVL169:
 1675              	.LFB32:
 778:RT-Thread/src/ipc.c **** RTM_EXPORT(rt_mutex_take);
 779:RT-Thread/src/ipc.c **** 
 780:RT-Thread/src/ipc.c **** /**
 781:RT-Thread/src/ipc.c ****  * This function will release a mutex, if there are threads suspended on mutex,
 782:RT-Thread/src/ipc.c ****  * it will be waked up.
 783:RT-Thread/src/ipc.c ****  *
 784:RT-Thread/src/ipc.c ****  * @param mutex the mutex object
ARM GAS  C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s 			page 51


 785:RT-Thread/src/ipc.c ****  *
 786:RT-Thread/src/ipc.c ****  * @return the error code
 787:RT-Thread/src/ipc.c ****  */
 788:RT-Thread/src/ipc.c **** rt_err_t rt_mutex_release(rt_mutex_t mutex)
 789:RT-Thread/src/ipc.c **** {
 1676              		.loc 1 789 1 is_stmt 1 view -0
 1677              		.cfi_startproc
 1678              		@ args = 0, pretend = 0, frame = 0
 1679              		@ frame_needed = 0, uses_anonymous_args = 0
 1680              		.loc 1 789 1 is_stmt 0 view .LVU573
 1681 0000 70B5     		push	{r4, r5, r6, lr}
 1682              	.LCFI20:
 1683              		.cfi_def_cfa_offset 16
 1684              		.cfi_offset 4, -16
 1685              		.cfi_offset 5, -12
 1686              		.cfi_offset 6, -8
 1687              		.cfi_offset 14, -4
 1688 0002 0446     		mov	r4, r0
 790:RT-Thread/src/ipc.c ****     register rt_base_t temp;
 1689              		.loc 1 790 5 is_stmt 1 view .LVU574
 791:RT-Thread/src/ipc.c ****     struct rt_thread *thread;
 1690              		.loc 1 791 5 view .LVU575
 792:RT-Thread/src/ipc.c ****     rt_bool_t need_schedule;
 1691              		.loc 1 792 5 view .LVU576
 793:RT-Thread/src/ipc.c **** 
 794:RT-Thread/src/ipc.c ****     /* parameter check */
 795:RT-Thread/src/ipc.c ****     RT_ASSERT(mutex != RT_NULL);
 1692              		.loc 1 795 32 view .LVU577
 796:RT-Thread/src/ipc.c ****     RT_ASSERT(rt_object_get_type(&mutex->parent.parent) == RT_Object_Class_Mutex);
 1693              		.loc 1 796 82 view .LVU578
 797:RT-Thread/src/ipc.c **** 
 798:RT-Thread/src/ipc.c ****     need_schedule = RT_FALSE;
 1694              		.loc 1 798 5 view .LVU579
 1695              	.LVL170:
 799:RT-Thread/src/ipc.c **** 
 800:RT-Thread/src/ipc.c ****     /* only thread could release mutex because we need test the ownership */
 801:RT-Thread/src/ipc.c ****     RT_DEBUG_IN_THREAD_CONTEXT;
 1696              		.loc 1 801 31 view .LVU580
 802:RT-Thread/src/ipc.c **** 
 803:RT-Thread/src/ipc.c ****     /* get current thread */
 804:RT-Thread/src/ipc.c ****     thread = rt_thread_self();
 1697              		.loc 1 804 5 view .LVU581
 1698              		.loc 1 804 14 is_stmt 0 view .LVU582
 1699 0004 FFF7FEFF 		bl	rt_thread_self
 1700              	.LVL171:
 1701              		.loc 1 804 14 view .LVU583
 1702 0008 0546     		mov	r5, r0
 1703              	.LVL172:
 805:RT-Thread/src/ipc.c **** 
 806:RT-Thread/src/ipc.c ****     /* disable interrupt */
 807:RT-Thread/src/ipc.c ****     temp = rt_hw_interrupt_disable();
 1704              		.loc 1 807 5 is_stmt 1 view .LVU584
 1705              		.loc 1 807 12 is_stmt 0 view .LVU585
 1706 000a FFF7FEFF 		bl	rt_hw_interrupt_disable
 1707              	.LVL173:
 1708              		.loc 1 807 12 view .LVU586
 1709 000e 0646     		mov	r6, r0
ARM GAS  C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s 			page 52


 1710              	.LVL174:
 808:RT-Thread/src/ipc.c **** 
 809:RT-Thread/src/ipc.c ****     RT_DEBUG_LOG(RT_DEBUG_IPC,
 810:RT-Thread/src/ipc.c ****                  ("mutex_release:current thread %s, mutex value: %d, hold: %d\n",
 811:RT-Thread/src/ipc.c ****                   thread->name, mutex->value, mutex->hold));
 1711              		.loc 1 811 60 is_stmt 1 view .LVU587
 812:RT-Thread/src/ipc.c **** 
 813:RT-Thread/src/ipc.c ****     RT_OBJECT_HOOK_CALL(rt_object_put_hook, (&(mutex->parent.parent)));
 1712              		.loc 1 813 71 view .LVU588
 814:RT-Thread/src/ipc.c **** 
 815:RT-Thread/src/ipc.c ****     /* mutex only can be released by owner */
 816:RT-Thread/src/ipc.c ****     if (thread != mutex->owner)
 1713              		.loc 1 816 5 view .LVU589
 1714              		.loc 1 816 24 is_stmt 0 view .LVU590
 1715 0010 206A     		ldr	r0, [r4, #32]
 1716              	.LVL175:
 1717              		.loc 1 816 8 view .LVU591
 1718 0012 A842     		cmp	r0, r5
 1719 0014 1BD1     		bne	.L95
 817:RT-Thread/src/ipc.c ****     {
 818:RT-Thread/src/ipc.c ****         thread->error = -RT_ERROR;
 819:RT-Thread/src/ipc.c **** 
 820:RT-Thread/src/ipc.c ****         /* enable interrupt */
 821:RT-Thread/src/ipc.c ****         rt_hw_interrupt_enable(temp);
 822:RT-Thread/src/ipc.c **** 
 823:RT-Thread/src/ipc.c ****         return -RT_ERROR;
 824:RT-Thread/src/ipc.c ****     }
 825:RT-Thread/src/ipc.c **** 
 826:RT-Thread/src/ipc.c ****     /* decrease hold */
 827:RT-Thread/src/ipc.c ****     mutex->hold --;
 1720              		.loc 1 827 5 is_stmt 1 view .LVU592
 1721              		.loc 1 827 10 is_stmt 0 view .LVU593
 1722 0016 E37F     		ldrb	r3, [r4, #31]	@ zero_extendqisi2
 1723              		.loc 1 827 17 view .LVU594
 1724 0018 013B     		subs	r3, r3, #1
 1725 001a DBB2     		uxtb	r3, r3
 1726 001c E377     		strb	r3, [r4, #31]
 828:RT-Thread/src/ipc.c ****     /* if no hold */
 829:RT-Thread/src/ipc.c ****     if (mutex->hold == 0)
 1727              		.loc 1 829 5 is_stmt 1 view .LVU595
 1728              		.loc 1 829 8 is_stmt 0 view .LVU596
 1729 001e 63BB     		cbnz	r3, .L93
 830:RT-Thread/src/ipc.c ****     {
 831:RT-Thread/src/ipc.c ****         /* change the owner thread to original priority */
 832:RT-Thread/src/ipc.c ****         if (mutex->original_priority != mutex->owner->current_priority)
 1730              		.loc 1 832 9 is_stmt 1 view .LVU597
 1731              		.loc 1 832 18 is_stmt 0 view .LVU598
 1732 0020 A27F     		ldrb	r2, [r4, #30]	@ zero_extendqisi2
 1733              		.loc 1 832 53 view .LVU599
 1734 0022 90F83530 		ldrb	r3, [r0, #53]	@ zero_extendqisi2
 1735              		.loc 1 832 12 view .LVU600
 1736 0026 9A42     		cmp	r2, r3
 1737 0028 18D1     		bne	.L96
 1738              	.L91:
 833:RT-Thread/src/ipc.c ****         {
 834:RT-Thread/src/ipc.c ****             rt_thread_control(mutex->owner,
 835:RT-Thread/src/ipc.c ****                               RT_THREAD_CTRL_CHANGE_PRIORITY,
ARM GAS  C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s 			page 53


 836:RT-Thread/src/ipc.c ****                               &(mutex->original_priority));
 837:RT-Thread/src/ipc.c ****         }
 838:RT-Thread/src/ipc.c **** 
 839:RT-Thread/src/ipc.c ****         /* wakeup suspended thread */
 840:RT-Thread/src/ipc.c ****         if (!rt_list_isempty(&mutex->parent.suspend_thread))
 1739              		.loc 1 840 9 is_stmt 1 view .LVU601
 1740              		.loc 1 840 30 is_stmt 0 view .LVU602
 1741 002a 04F11403 		add	r3, r4, #20
 1742              	.LBB149:
 1743              	.LBI149:
  98:RT-Thread/include/rtservice.h **** {
 1744              		.loc 2 98 15 is_stmt 1 view .LVU603
 1745              	.LBB150:
 1746              		.loc 2 100 5 view .LVU604
 1747              		.loc 2 100 13 is_stmt 0 view .LVU605
 1748 002e 6269     		ldr	r2, [r4, #20]
 1749              	.LBE150:
 1750              	.LBE149:
 1751              		.loc 1 840 12 view .LVU606
 1752 0030 9342     		cmp	r3, r2
 1753 0032 19D0     		beq	.L92
 841:RT-Thread/src/ipc.c ****         {
 842:RT-Thread/src/ipc.c ****             /* get suspended thread */
 843:RT-Thread/src/ipc.c ****             thread = rt_list_entry(mutex->parent.suspend_thread.next,
 1754              		.loc 1 843 13 is_stmt 1 view .LVU607
 1755              		.loc 1 843 20 is_stmt 0 view .LVU608
 1756 0034 A2F11400 		sub	r0, r2, #20
 1757              	.LVL176:
 844:RT-Thread/src/ipc.c ****                                    struct rt_thread,
 845:RT-Thread/src/ipc.c ****                                    tlist);
 846:RT-Thread/src/ipc.c **** 
 847:RT-Thread/src/ipc.c ****             RT_DEBUG_LOG(RT_DEBUG_IPC, ("mutex_release: resume thread: %s\n",
 848:RT-Thread/src/ipc.c ****                                         thread->name));
 1758              		.loc 1 848 55 is_stmt 1 view .LVU609
 849:RT-Thread/src/ipc.c **** 
 850:RT-Thread/src/ipc.c ****             /* set new owner and priority */
 851:RT-Thread/src/ipc.c ****             mutex->owner             = thread;
 1759              		.loc 1 851 13 view .LVU610
 1760              		.loc 1 851 38 is_stmt 0 view .LVU611
 1761 0038 2062     		str	r0, [r4, #32]
 852:RT-Thread/src/ipc.c ****             mutex->original_priority = thread->current_priority;
 1762              		.loc 1 852 13 is_stmt 1 view .LVU612
 1763              		.loc 1 852 46 is_stmt 0 view .LVU613
 1764 003a 92F82130 		ldrb	r3, [r2, #33]	@ zero_extendqisi2
 1765              		.loc 1 852 38 view .LVU614
 1766 003e A377     		strb	r3, [r4, #30]
 853:RT-Thread/src/ipc.c ****             mutex->hold ++;
 1767              		.loc 1 853 13 is_stmt 1 view .LVU615
 1768              		.loc 1 853 18 is_stmt 0 view .LVU616
 1769 0040 E37F     		ldrb	r3, [r4, #31]	@ zero_extendqisi2
 1770              		.loc 1 853 25 view .LVU617
 1771 0042 0133     		adds	r3, r3, #1
 1772 0044 E377     		strb	r3, [r4, #31]
 854:RT-Thread/src/ipc.c **** 
 855:RT-Thread/src/ipc.c ****             /* resume thread */
 856:RT-Thread/src/ipc.c ****             rt_ipc_list_resume(&(mutex->parent.suspend_thread));
 1773              		.loc 1 856 13 is_stmt 1 view .LVU618
ARM GAS  C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s 			page 54


 1774              	.LVL177:
 1775              	.LBB151:
 1776              	.LBI151:
 132:RT-Thread/src/ipc.c **** {
 1777              		.loc 1 132 20 view .LVU619
 1778              	.LBB152:
 134:RT-Thread/src/ipc.c **** 
 1779              		.loc 1 134 5 view .LVU620
 137:RT-Thread/src/ipc.c **** 
 1780              		.loc 1 137 5 view .LVU621
 139:RT-Thread/src/ipc.c **** 
 1781              		.loc 1 139 69 view .LVU622
 142:RT-Thread/src/ipc.c **** 
 1782              		.loc 1 142 5 view .LVU623
 1783 0046 FFF7FEFF 		bl	rt_thread_resume
 1784              	.LVL178:
 144:RT-Thread/src/ipc.c **** }
 1785              		.loc 1 144 5 view .LVU624
 144:RT-Thread/src/ipc.c **** }
 1786              		.loc 1 144 5 is_stmt 0 view .LVU625
 1787              	.LBE152:
 1788              	.LBE151:
 857:RT-Thread/src/ipc.c **** 
 858:RT-Thread/src/ipc.c ****             need_schedule = RT_TRUE;
 1789              		.loc 1 858 13 is_stmt 1 view .LVU626
 1790              		.loc 1 858 27 is_stmt 0 view .LVU627
 1791 004a 0124     		movs	r4, #1
 1792              	.LVL179:
 1793              		.loc 1 858 27 view .LVU628
 1794 004c 16E0     		b	.L90
 1795              	.LVL180:
 1796              	.L95:
 818:RT-Thread/src/ipc.c **** 
 1797              		.loc 1 818 9 is_stmt 1 view .LVU629
 818:RT-Thread/src/ipc.c **** 
 1798              		.loc 1 818 23 is_stmt 0 view .LVU630
 1799 004e 4FF0FF34 		mov	r4, #-1
 1800              	.LVL181:
 818:RT-Thread/src/ipc.c **** 
 1801              		.loc 1 818 23 view .LVU631
 1802 0052 2C63     		str	r4, [r5, #48]
 821:RT-Thread/src/ipc.c **** 
 1803              		.loc 1 821 9 is_stmt 1 view .LVU632
 1804 0054 3046     		mov	r0, r6
 1805 0056 FFF7FEFF 		bl	rt_hw_interrupt_enable
 1806              	.LVL182:
 823:RT-Thread/src/ipc.c ****     }
 1807              		.loc 1 823 9 view .LVU633
 823:RT-Thread/src/ipc.c ****     }
 1808              		.loc 1 823 16 is_stmt 0 view .LVU634
 1809 005a 14E0     		b	.L87
 1810              	.LVL183:
 1811              	.L96:
 834:RT-Thread/src/ipc.c ****                               RT_THREAD_CTRL_CHANGE_PRIORITY,
 1812              		.loc 1 834 13 is_stmt 1 view .LVU635
 1813 005c 04F11E02 		add	r2, r4, #30
 1814 0060 0221     		movs	r1, #2
ARM GAS  C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s 			page 55


 1815 0062 FFF7FEFF 		bl	rt_thread_control
 1816              	.LVL184:
 1817 0066 E0E7     		b	.L91
 1818              	.L92:
 859:RT-Thread/src/ipc.c ****         }
 860:RT-Thread/src/ipc.c ****         else
 861:RT-Thread/src/ipc.c ****         {
 862:RT-Thread/src/ipc.c ****             /* increase value */
 863:RT-Thread/src/ipc.c ****             mutex->value ++;
 1819              		.loc 1 863 13 view .LVU636
 1820              		.loc 1 863 18 is_stmt 0 view .LVU637
 1821 0068 A38B     		ldrh	r3, [r4, #28]
 1822              		.loc 1 863 26 view .LVU638
 1823 006a 0133     		adds	r3, r3, #1
 1824 006c A383     		strh	r3, [r4, #28]	@ movhi
 864:RT-Thread/src/ipc.c **** 
 865:RT-Thread/src/ipc.c ****             /* clear owner */
 866:RT-Thread/src/ipc.c ****             mutex->owner             = RT_NULL;
 1825              		.loc 1 866 13 is_stmt 1 view .LVU639
 1826              		.loc 1 866 38 is_stmt 0 view .LVU640
 1827 006e 0023     		movs	r3, #0
 1828 0070 2362     		str	r3, [r4, #32]
 867:RT-Thread/src/ipc.c ****             mutex->original_priority = 0xff;
 1829              		.loc 1 867 13 is_stmt 1 view .LVU641
 1830              		.loc 1 867 38 is_stmt 0 view .LVU642
 1831 0072 FF22     		movs	r2, #255
 1832 0074 A277     		strb	r2, [r4, #30]
 798:RT-Thread/src/ipc.c **** 
 1833              		.loc 1 798 19 view .LVU643
 1834 0076 1C46     		mov	r4, r3
 1835              	.LVL185:
 798:RT-Thread/src/ipc.c **** 
 1836              		.loc 1 798 19 view .LVU644
 1837 0078 00E0     		b	.L90
 1838              	.LVL186:
 1839              	.L93:
 798:RT-Thread/src/ipc.c **** 
 1840              		.loc 1 798 19 view .LVU645
 1841 007a 0024     		movs	r4, #0
 1842              	.LVL187:
 1843              	.L90:
 868:RT-Thread/src/ipc.c ****         }
 869:RT-Thread/src/ipc.c ****     }
 870:RT-Thread/src/ipc.c **** 
 871:RT-Thread/src/ipc.c ****     /* enable interrupt */
 872:RT-Thread/src/ipc.c ****     rt_hw_interrupt_enable(temp);
 1844              		.loc 1 872 5 is_stmt 1 view .LVU646
 1845 007c 3046     		mov	r0, r6
 1846 007e FFF7FEFF 		bl	rt_hw_interrupt_enable
 1847              	.LVL188:
 873:RT-Thread/src/ipc.c **** 
 874:RT-Thread/src/ipc.c ****     /* perform a schedule */
 875:RT-Thread/src/ipc.c ****     if (need_schedule == RT_TRUE)
 1848              		.loc 1 875 5 view .LVU647
 1849              		.loc 1 875 8 is_stmt 0 view .LVU648
 1850 0082 012C     		cmp	r4, #1
 1851 0084 01D0     		beq	.L97
ARM GAS  C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s 			page 56


 1852              	.LVL189:
 1853              	.L87:
 876:RT-Thread/src/ipc.c ****         rt_schedule();
 877:RT-Thread/src/ipc.c **** 
 878:RT-Thread/src/ipc.c ****     return RT_EOK;
 879:RT-Thread/src/ipc.c **** }
 1854              		.loc 1 879 1 view .LVU649
 1855 0086 2046     		mov	r0, r4
 1856 0088 70BD     		pop	{r4, r5, r6, pc}
 1857              	.LVL190:
 1858              	.L97:
 876:RT-Thread/src/ipc.c ****         rt_schedule();
 1859              		.loc 1 876 9 is_stmt 1 view .LVU650
 1860 008a FFF7FEFF 		bl	rt_schedule
 1861              	.LVL191:
 878:RT-Thread/src/ipc.c **** }
 1862              		.loc 1 878 12 is_stmt 0 view .LVU651
 1863 008e 0024     		movs	r4, #0
 1864              	.LVL192:
 878:RT-Thread/src/ipc.c **** }
 1865              		.loc 1 878 12 view .LVU652
 1866 0090 F9E7     		b	.L87
 1867              		.cfi_endproc
 1868              	.LFE32:
 1870              		.section	.text.rt_mutex_control,"ax",%progbits
 1871              		.align	1
 1872              		.global	rt_mutex_control
 1873              		.syntax unified
 1874              		.thumb
 1875              		.thumb_func
 1876              		.fpu softvfp
 1878              	rt_mutex_control:
 1879              	.LVL193:
 1880              	.LFB33:
 880:RT-Thread/src/ipc.c **** RTM_EXPORT(rt_mutex_release);
 881:RT-Thread/src/ipc.c **** 
 882:RT-Thread/src/ipc.c **** /**
 883:RT-Thread/src/ipc.c ****  * This function can get or set some extra attributions of a mutex object.
 884:RT-Thread/src/ipc.c ****  *
 885:RT-Thread/src/ipc.c ****  * @param mutex the mutex object
 886:RT-Thread/src/ipc.c ****  * @param cmd the execution command
 887:RT-Thread/src/ipc.c ****  * @param arg the execution argument
 888:RT-Thread/src/ipc.c ****  *
 889:RT-Thread/src/ipc.c ****  * @return the error code
 890:RT-Thread/src/ipc.c ****  */
 891:RT-Thread/src/ipc.c **** rt_err_t rt_mutex_control(rt_mutex_t mutex, int cmd, void *arg)
 892:RT-Thread/src/ipc.c **** {
 1881              		.loc 1 892 1 is_stmt 1 view -0
 1882              		.cfi_startproc
 1883              		@ args = 0, pretend = 0, frame = 0
 1884              		@ frame_needed = 0, uses_anonymous_args = 0
 1885              		@ link register save eliminated.
 893:RT-Thread/src/ipc.c ****     /* parameter check */
 894:RT-Thread/src/ipc.c ****     RT_ASSERT(mutex != RT_NULL);
 1886              		.loc 1 894 32 view .LVU654
 895:RT-Thread/src/ipc.c ****     RT_ASSERT(rt_object_get_type(&mutex->parent.parent) == RT_Object_Class_Mutex);
 1887              		.loc 1 895 82 view .LVU655
ARM GAS  C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s 			page 57


 896:RT-Thread/src/ipc.c **** 
 897:RT-Thread/src/ipc.c ****     return -RT_ERROR;
 1888              		.loc 1 897 5 view .LVU656
 898:RT-Thread/src/ipc.c **** }
 1889              		.loc 1 898 1 is_stmt 0 view .LVU657
 1890 0000 4FF0FF30 		mov	r0, #-1
 1891              	.LVL194:
 1892              		.loc 1 898 1 view .LVU658
 1893 0004 7047     		bx	lr
 1894              		.cfi_endproc
 1895              	.LFE33:
 1897              		.section	.text.rt_event_init,"ax",%progbits
 1898              		.align	1
 1899              		.global	rt_event_init
 1900              		.syntax unified
 1901              		.thumb
 1902              		.thumb_func
 1903              		.fpu softvfp
 1905              	rt_event_init:
 1906              	.LVL195:
 1907              	.LFB34:
 899:RT-Thread/src/ipc.c **** RTM_EXPORT(rt_mutex_control);
 900:RT-Thread/src/ipc.c **** #endif /* end of RT_USING_MUTEX */
 901:RT-Thread/src/ipc.c **** 
 902:RT-Thread/src/ipc.c **** #ifdef RT_USING_EVENT
 903:RT-Thread/src/ipc.c **** /**
 904:RT-Thread/src/ipc.c ****  * This function will initialize an event and put it under control of resource
 905:RT-Thread/src/ipc.c ****  * management.
 906:RT-Thread/src/ipc.c ****  *
 907:RT-Thread/src/ipc.c ****  * @param event the event object
 908:RT-Thread/src/ipc.c ****  * @param name the name of event
 909:RT-Thread/src/ipc.c ****  * @param flag the flag of event
 910:RT-Thread/src/ipc.c ****  *
 911:RT-Thread/src/ipc.c ****  * @return the operation status, RT_EOK on successful
 912:RT-Thread/src/ipc.c ****  */
 913:RT-Thread/src/ipc.c **** rt_err_t rt_event_init(rt_event_t event, const char *name, rt_uint8_t flag)
 914:RT-Thread/src/ipc.c **** {
 1908              		.loc 1 914 1 is_stmt 1 view -0
 1909              		.cfi_startproc
 1910              		@ args = 0, pretend = 0, frame = 0
 1911              		@ frame_needed = 0, uses_anonymous_args = 0
 1912              		.loc 1 914 1 is_stmt 0 view .LVU660
 1913 0000 38B5     		push	{r3, r4, r5, lr}
 1914              	.LCFI21:
 1915              		.cfi_def_cfa_offset 16
 1916              		.cfi_offset 3, -16
 1917              		.cfi_offset 4, -12
 1918              		.cfi_offset 5, -8
 1919              		.cfi_offset 14, -4
 1920 0002 0446     		mov	r4, r0
 1921 0004 1546     		mov	r5, r2
 915:RT-Thread/src/ipc.c ****     /* parameter check */
 916:RT-Thread/src/ipc.c ****     RT_ASSERT(event != RT_NULL);
 1922              		.loc 1 916 32 is_stmt 1 view .LVU661
 917:RT-Thread/src/ipc.c **** 
 918:RT-Thread/src/ipc.c ****     /* init object */
 919:RT-Thread/src/ipc.c ****     rt_object_init(&(event->parent.parent), RT_Object_Class_Event, name);
ARM GAS  C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s 			page 58


 1923              		.loc 1 919 5 view .LVU662
 1924 0006 0A46     		mov	r2, r1
 1925              	.LVL196:
 1926              		.loc 1 919 5 is_stmt 0 view .LVU663
 1927 0008 0421     		movs	r1, #4
 1928              	.LVL197:
 1929              		.loc 1 919 5 view .LVU664
 1930 000a FFF7FEFF 		bl	rt_object_init
 1931              	.LVL198:
 920:RT-Thread/src/ipc.c **** 
 921:RT-Thread/src/ipc.c ****     /* set parent flag */
 922:RT-Thread/src/ipc.c ****     event->parent.parent.flag = flag;
 1932              		.loc 1 922 5 is_stmt 1 view .LVU665
 1933              		.loc 1 922 31 is_stmt 0 view .LVU666
 1934 000e 6572     		strb	r5, [r4, #9]
 923:RT-Thread/src/ipc.c **** 
 924:RT-Thread/src/ipc.c ****     /* init ipc object */
 925:RT-Thread/src/ipc.c ****     rt_ipc_object_init(&(event->parent));
 1935              		.loc 1 925 5 is_stmt 1 view .LVU667
 1936              	.LVL199:
 1937              	.LBB153:
 1938              	.LBI153:
  59:RT-Thread/src/ipc.c **** {
 1939              		.loc 1 59 20 view .LVU668
 1940              	.LBB154:
  62:RT-Thread/src/ipc.c **** 
 1941              		.loc 1 62 5 view .LVU669
 1942 0010 04F11403 		add	r3, r4, #20
 1943              	.LVL200:
 1944              	.LBB155:
 1945              	.LBI155:
  47:RT-Thread/include/rtservice.h **** {
 1946              		.loc 2 47 16 view .LVU670
 1947              	.LBB156:
  49:RT-Thread/include/rtservice.h **** }
 1948              		.loc 2 49 5 view .LVU671
  49:RT-Thread/include/rtservice.h **** }
 1949              		.loc 2 49 23 is_stmt 0 view .LVU672
 1950 0014 A361     		str	r3, [r4, #24]
  49:RT-Thread/include/rtservice.h **** }
 1951              		.loc 2 49 13 view .LVU673
 1952 0016 6361     		str	r3, [r4, #20]
 1953              	.LVL201:
  49:RT-Thread/include/rtservice.h **** }
 1954              		.loc 2 49 13 view .LVU674
 1955              	.LBE156:
 1956              	.LBE155:
  64:RT-Thread/src/ipc.c **** }
 1957              		.loc 1 64 5 is_stmt 1 view .LVU675
  64:RT-Thread/src/ipc.c **** }
 1958              		.loc 1 64 5 is_stmt 0 view .LVU676
 1959              	.LBE154:
 1960              	.LBE153:
 926:RT-Thread/src/ipc.c **** 
 927:RT-Thread/src/ipc.c ****     /* init event */
 928:RT-Thread/src/ipc.c ****     event->set = 0;
 1961              		.loc 1 928 5 is_stmt 1 view .LVU677
ARM GAS  C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s 			page 59


 1962              		.loc 1 928 16 is_stmt 0 view .LVU678
 1963 0018 0020     		movs	r0, #0
 1964 001a E061     		str	r0, [r4, #28]
 929:RT-Thread/src/ipc.c **** 
 930:RT-Thread/src/ipc.c ****     return RT_EOK;
 1965              		.loc 1 930 5 is_stmt 1 view .LVU679
 931:RT-Thread/src/ipc.c **** }
 1966              		.loc 1 931 1 is_stmt 0 view .LVU680
 1967 001c 38BD     		pop	{r3, r4, r5, pc}
 1968              		.loc 1 931 1 view .LVU681
 1969              		.cfi_endproc
 1970              	.LFE34:
 1972              		.section	.text.rt_event_detach,"ax",%progbits
 1973              		.align	1
 1974              		.global	rt_event_detach
 1975              		.syntax unified
 1976              		.thumb
 1977              		.thumb_func
 1978              		.fpu softvfp
 1980              	rt_event_detach:
 1981              	.LVL202:
 1982              	.LFB35:
 932:RT-Thread/src/ipc.c **** RTM_EXPORT(rt_event_init);
 933:RT-Thread/src/ipc.c **** 
 934:RT-Thread/src/ipc.c **** /**
 935:RT-Thread/src/ipc.c ****  * This function will detach an event object from resource management
 936:RT-Thread/src/ipc.c ****  *
 937:RT-Thread/src/ipc.c ****  * @param event the event object
 938:RT-Thread/src/ipc.c ****  *
 939:RT-Thread/src/ipc.c ****  * @return the operation status, RT_EOK on successful
 940:RT-Thread/src/ipc.c ****  */
 941:RT-Thread/src/ipc.c **** rt_err_t rt_event_detach(rt_event_t event)
 942:RT-Thread/src/ipc.c **** {
 1983              		.loc 1 942 1 is_stmt 1 view -0
 1984              		.cfi_startproc
 1985              		@ args = 0, pretend = 0, frame = 0
 1986              		@ frame_needed = 0, uses_anonymous_args = 0
 1987              		.loc 1 942 1 is_stmt 0 view .LVU683
 1988 0000 70B5     		push	{r4, r5, r6, lr}
 1989              	.LCFI22:
 1990              		.cfi_def_cfa_offset 16
 1991              		.cfi_offset 4, -16
 1992              		.cfi_offset 5, -12
 1993              		.cfi_offset 6, -8
 1994              		.cfi_offset 14, -4
 1995 0002 0446     		mov	r4, r0
 943:RT-Thread/src/ipc.c ****     /* parameter check */
 944:RT-Thread/src/ipc.c ****     RT_ASSERT(event != RT_NULL);
 1996              		.loc 1 944 32 is_stmt 1 view .LVU684
 945:RT-Thread/src/ipc.c ****     RT_ASSERT(rt_object_get_type(&event->parent.parent) == RT_Object_Class_Event);
 1997              		.loc 1 945 82 view .LVU685
 946:RT-Thread/src/ipc.c ****     RT_ASSERT(rt_object_is_systemobject(&event->parent.parent));
 1998              		.loc 1 946 64 view .LVU686
 947:RT-Thread/src/ipc.c **** 
 948:RT-Thread/src/ipc.c ****     /* resume all suspended thread */
 949:RT-Thread/src/ipc.c ****     rt_ipc_list_resume_all(&(event->parent.suspend_thread));
 1999              		.loc 1 949 5 view .LVU687
ARM GAS  C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s 			page 60


 2000 0004 00F11405 		add	r5, r0, #20
 2001              	.LVL203:
 2002              	.LBB161:
 2003              	.LBI161:
 155:RT-Thread/src/ipc.c **** {
 2004              		.loc 1 155 20 view .LVU688
 2005              	.LBB162:
 157:RT-Thread/src/ipc.c ****     register rt_ubase_t temp;
 2006              		.loc 1 157 5 view .LVU689
 158:RT-Thread/src/ipc.c **** 
 2007              		.loc 1 158 5 view .LVU690
 161:RT-Thread/src/ipc.c ****     {
 2008              		.loc 1 161 5 view .LVU691
 2009              	.L102:
 161:RT-Thread/src/ipc.c ****     {
 2010              		.loc 1 161 11 view .LVU692
 2011              	.LBB163:
 2012              	.LBI163:
  98:RT-Thread/include/rtservice.h **** {
 2013              		.loc 2 98 15 view .LVU693
 2014              	.LBB164:
 2015              		.loc 2 100 5 view .LVU694
 2016              		.loc 2 100 13 is_stmt 0 view .LVU695
 2017 0008 2B68     		ldr	r3, [r5]
 2018              	.LVL204:
 2019              		.loc 2 100 13 view .LVU696
 2020              	.LBE164:
 2021              	.LBE163:
 161:RT-Thread/src/ipc.c ****     {
 2022              		.loc 1 161 11 view .LVU697
 2023 000a 9D42     		cmp	r5, r3
 2024 000c 0DD0     		beq	.L105
 164:RT-Thread/src/ipc.c **** 
 2025              		.loc 1 164 9 is_stmt 1 view .LVU698
 164:RT-Thread/src/ipc.c **** 
 2026              		.loc 1 164 16 is_stmt 0 view .LVU699
 2027 000e FFF7FEFF 		bl	rt_hw_interrupt_disable
 2028              	.LVL205:
 2029 0012 0646     		mov	r6, r0
 2030              	.LVL206:
 167:RT-Thread/src/ipc.c ****         /* set error code to RT_ERROR */
 2031              		.loc 1 167 9 is_stmt 1 view .LVU700
 167:RT-Thread/src/ipc.c ****         /* set error code to RT_ERROR */
 2032              		.loc 1 167 18 is_stmt 0 view .LVU701
 2033 0014 2868     		ldr	r0, [r5]
 2034              	.LVL207:
 169:RT-Thread/src/ipc.c **** 
 2035              		.loc 1 169 9 is_stmt 1 view .LVU702
 169:RT-Thread/src/ipc.c **** 
 2036              		.loc 1 169 23 is_stmt 0 view .LVU703
 2037 0016 4FF0FF33 		mov	r3, #-1
 2038 001a C361     		str	r3, [r0, #28]
 176:RT-Thread/src/ipc.c **** 
 2039              		.loc 1 176 9 is_stmt 1 view .LVU704
 2040 001c 1438     		subs	r0, r0, #20
 2041              	.LVL208:
 176:RT-Thread/src/ipc.c **** 
ARM GAS  C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s 			page 61


 2042              		.loc 1 176 9 is_stmt 0 view .LVU705
 2043 001e FFF7FEFF 		bl	rt_thread_resume
 2044              	.LVL209:
 179:RT-Thread/src/ipc.c ****     }
 2045              		.loc 1 179 9 is_stmt 1 view .LVU706
 2046 0022 3046     		mov	r0, r6
 2047 0024 FFF7FEFF 		bl	rt_hw_interrupt_enable
 2048              	.LVL210:
 2049 0028 EEE7     		b	.L102
 2050              	.LVL211:
 2051              	.L105:
 182:RT-Thread/src/ipc.c **** }
 2052              		.loc 1 182 5 view .LVU707
 182:RT-Thread/src/ipc.c **** }
 2053              		.loc 1 182 5 is_stmt 0 view .LVU708
 2054              	.LBE162:
 2055              	.LBE161:
 950:RT-Thread/src/ipc.c **** 
 951:RT-Thread/src/ipc.c ****     /* detach event object */
 952:RT-Thread/src/ipc.c ****     rt_object_detach(&(event->parent.parent));
 2056              		.loc 1 952 5 is_stmt 1 view .LVU709
 2057 002a 2046     		mov	r0, r4
 2058 002c FFF7FEFF 		bl	rt_object_detach
 2059              	.LVL212:
 953:RT-Thread/src/ipc.c **** 
 954:RT-Thread/src/ipc.c ****     return RT_EOK;
 2060              		.loc 1 954 5 view .LVU710
 955:RT-Thread/src/ipc.c **** }
 2061              		.loc 1 955 1 is_stmt 0 view .LVU711
 2062 0030 0020     		movs	r0, #0
 2063 0032 70BD     		pop	{r4, r5, r6, pc}
 2064              		.loc 1 955 1 view .LVU712
 2065              		.cfi_endproc
 2066              	.LFE35:
 2068              		.section	.text.rt_event_create,"ax",%progbits
 2069              		.align	1
 2070              		.global	rt_event_create
 2071              		.syntax unified
 2072              		.thumb
 2073              		.thumb_func
 2074              		.fpu softvfp
 2076              	rt_event_create:
 2077              	.LVL213:
 2078              	.LFB36:
 956:RT-Thread/src/ipc.c **** RTM_EXPORT(rt_event_detach);
 957:RT-Thread/src/ipc.c **** 
 958:RT-Thread/src/ipc.c **** #ifdef RT_USING_HEAP
 959:RT-Thread/src/ipc.c **** /**
 960:RT-Thread/src/ipc.c ****  * This function will create an event object from system resource
 961:RT-Thread/src/ipc.c ****  *
 962:RT-Thread/src/ipc.c ****  * @param name the name of event
 963:RT-Thread/src/ipc.c ****  * @param flag the flag of event
 964:RT-Thread/src/ipc.c ****  *
 965:RT-Thread/src/ipc.c ****  * @return the created event, RT_NULL on error happen
 966:RT-Thread/src/ipc.c ****  */
 967:RT-Thread/src/ipc.c **** rt_event_t rt_event_create(const char *name, rt_uint8_t flag)
 968:RT-Thread/src/ipc.c **** {
ARM GAS  C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s 			page 62


 2079              		.loc 1 968 1 is_stmt 1 view -0
 2080              		.cfi_startproc
 2081              		@ args = 0, pretend = 0, frame = 0
 2082              		@ frame_needed = 0, uses_anonymous_args = 0
 2083              		.loc 1 968 1 is_stmt 0 view .LVU714
 2084 0000 10B5     		push	{r4, lr}
 2085              	.LCFI23:
 2086              		.cfi_def_cfa_offset 8
 2087              		.cfi_offset 4, -8
 2088              		.cfi_offset 14, -4
 2089 0002 0C46     		mov	r4, r1
 969:RT-Thread/src/ipc.c ****     rt_event_t event;
 2090              		.loc 1 969 5 is_stmt 1 view .LVU715
 970:RT-Thread/src/ipc.c **** 
 971:RT-Thread/src/ipc.c ****     RT_DEBUG_NOT_IN_INTERRUPT;
 2091              		.loc 1 971 30 view .LVU716
 972:RT-Thread/src/ipc.c **** 
 973:RT-Thread/src/ipc.c ****     /* allocate object */
 974:RT-Thread/src/ipc.c ****     event = (rt_event_t)rt_object_allocate(RT_Object_Class_Event, name);
 2092              		.loc 1 974 5 view .LVU717
 2093              		.loc 1 974 25 is_stmt 0 view .LVU718
 2094 0004 0146     		mov	r1, r0
 2095              	.LVL214:
 2096              		.loc 1 974 25 view .LVU719
 2097 0006 0420     		movs	r0, #4
 2098              	.LVL215:
 2099              		.loc 1 974 25 view .LVU720
 2100 0008 FFF7FEFF 		bl	rt_object_allocate
 2101              	.LVL216:
 975:RT-Thread/src/ipc.c ****     if (event == RT_NULL)
 2102              		.loc 1 975 5 is_stmt 1 view .LVU721
 2103              		.loc 1 975 8 is_stmt 0 view .LVU722
 2104 000c 0346     		mov	r3, r0
 2105 000e 30B1     		cbz	r0, .L106
 976:RT-Thread/src/ipc.c ****         return event;
 977:RT-Thread/src/ipc.c **** 
 978:RT-Thread/src/ipc.c ****     /* set parent */
 979:RT-Thread/src/ipc.c ****     event->parent.parent.flag = flag;
 2106              		.loc 1 979 5 is_stmt 1 view .LVU723
 2107              		.loc 1 979 31 is_stmt 0 view .LVU724
 2108 0010 4472     		strb	r4, [r0, #9]
 980:RT-Thread/src/ipc.c **** 
 981:RT-Thread/src/ipc.c ****     /* init ipc object */
 982:RT-Thread/src/ipc.c ****     rt_ipc_object_init(&(event->parent));
 2109              		.loc 1 982 5 is_stmt 1 view .LVU725
 2110              	.LVL217:
 2111              	.LBB165:
 2112              	.LBI165:
  59:RT-Thread/src/ipc.c **** {
 2113              		.loc 1 59 20 view .LVU726
 2114              	.LBB166:
  62:RT-Thread/src/ipc.c **** 
 2115              		.loc 1 62 5 view .LVU727
 2116 0012 00F11402 		add	r2, r0, #20
 2117              	.LVL218:
 2118              	.LBB167:
 2119              	.LBI167:
ARM GAS  C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s 			page 63


  47:RT-Thread/include/rtservice.h **** {
 2120              		.loc 2 47 16 view .LVU728
 2121              	.LBB168:
  49:RT-Thread/include/rtservice.h **** }
 2122              		.loc 2 49 5 view .LVU729
  49:RT-Thread/include/rtservice.h **** }
 2123              		.loc 2 49 23 is_stmt 0 view .LVU730
 2124 0016 8261     		str	r2, [r0, #24]
  49:RT-Thread/include/rtservice.h **** }
 2125              		.loc 2 49 13 view .LVU731
 2126 0018 4261     		str	r2, [r0, #20]
 2127              	.LVL219:
  49:RT-Thread/include/rtservice.h **** }
 2128              		.loc 2 49 13 view .LVU732
 2129              	.LBE168:
 2130              	.LBE167:
  64:RT-Thread/src/ipc.c **** }
 2131              		.loc 1 64 5 is_stmt 1 view .LVU733
  64:RT-Thread/src/ipc.c **** }
 2132              		.loc 1 64 5 is_stmt 0 view .LVU734
 2133              	.LBE166:
 2134              	.LBE165:
 983:RT-Thread/src/ipc.c **** 
 984:RT-Thread/src/ipc.c ****     /* init event */
 985:RT-Thread/src/ipc.c ****     event->set = 0;
 2135              		.loc 1 985 5 is_stmt 1 view .LVU735
 2136              		.loc 1 985 16 is_stmt 0 view .LVU736
 2137 001a 0022     		movs	r2, #0
 2138 001c C261     		str	r2, [r0, #28]
 986:RT-Thread/src/ipc.c **** 
 987:RT-Thread/src/ipc.c ****     return event;
 2139              		.loc 1 987 5 is_stmt 1 view .LVU737
 2140              	.L106:
 988:RT-Thread/src/ipc.c **** }
 2141              		.loc 1 988 1 is_stmt 0 view .LVU738
 2142 001e 1846     		mov	r0, r3
 2143              	.LVL220:
 2144              		.loc 1 988 1 view .LVU739
 2145 0020 10BD     		pop	{r4, pc}
 2146              		.cfi_endproc
 2147              	.LFE36:
 2149              		.section	.text.rt_event_delete,"ax",%progbits
 2150              		.align	1
 2151              		.global	rt_event_delete
 2152              		.syntax unified
 2153              		.thumb
 2154              		.thumb_func
 2155              		.fpu softvfp
 2157              	rt_event_delete:
 2158              	.LVL221:
 2159              	.LFB37:
 989:RT-Thread/src/ipc.c **** RTM_EXPORT(rt_event_create);
 990:RT-Thread/src/ipc.c **** 
 991:RT-Thread/src/ipc.c **** /**
 992:RT-Thread/src/ipc.c ****  * This function will delete an event object and release the memory
 993:RT-Thread/src/ipc.c ****  *
 994:RT-Thread/src/ipc.c ****  * @param event the event object
ARM GAS  C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s 			page 64


 995:RT-Thread/src/ipc.c ****  *
 996:RT-Thread/src/ipc.c ****  * @return the error code
 997:RT-Thread/src/ipc.c ****  */
 998:RT-Thread/src/ipc.c **** rt_err_t rt_event_delete(rt_event_t event)
 999:RT-Thread/src/ipc.c **** {
 2160              		.loc 1 999 1 is_stmt 1 view -0
 2161              		.cfi_startproc
 2162              		@ args = 0, pretend = 0, frame = 0
 2163              		@ frame_needed = 0, uses_anonymous_args = 0
 2164              		.loc 1 999 1 is_stmt 0 view .LVU741
 2165 0000 70B5     		push	{r4, r5, r6, lr}
 2166              	.LCFI24:
 2167              		.cfi_def_cfa_offset 16
 2168              		.cfi_offset 4, -16
 2169              		.cfi_offset 5, -12
 2170              		.cfi_offset 6, -8
 2171              		.cfi_offset 14, -4
 2172 0002 0446     		mov	r4, r0
1000:RT-Thread/src/ipc.c ****     /* parameter check */
1001:RT-Thread/src/ipc.c ****     RT_ASSERT(event != RT_NULL);
 2173              		.loc 1 1001 32 is_stmt 1 view .LVU742
1002:RT-Thread/src/ipc.c ****     RT_ASSERT(rt_object_get_type(&event->parent.parent) == RT_Object_Class_Event);
 2174              		.loc 1 1002 82 view .LVU743
1003:RT-Thread/src/ipc.c ****     RT_ASSERT(rt_object_is_systemobject(&event->parent.parent) == RT_FALSE);
 2175              		.loc 1 1003 76 view .LVU744
1004:RT-Thread/src/ipc.c **** 
1005:RT-Thread/src/ipc.c ****     RT_DEBUG_NOT_IN_INTERRUPT;
 2176              		.loc 1 1005 30 view .LVU745
1006:RT-Thread/src/ipc.c **** 
1007:RT-Thread/src/ipc.c ****     /* resume all suspended thread */
1008:RT-Thread/src/ipc.c ****     rt_ipc_list_resume_all(&(event->parent.suspend_thread));
 2177              		.loc 1 1008 5 view .LVU746
 2178 0004 00F11405 		add	r5, r0, #20
 2179              	.LVL222:
 2180              	.LBB173:
 2181              	.LBI173:
 155:RT-Thread/src/ipc.c **** {
 2182              		.loc 1 155 20 view .LVU747
 2183              	.LBB174:
 157:RT-Thread/src/ipc.c ****     register rt_ubase_t temp;
 2184              		.loc 1 157 5 view .LVU748
 158:RT-Thread/src/ipc.c **** 
 2185              		.loc 1 158 5 view .LVU749
 161:RT-Thread/src/ipc.c ****     {
 2186              		.loc 1 161 5 view .LVU750
 2187              	.L110:
 161:RT-Thread/src/ipc.c ****     {
 2188              		.loc 1 161 11 view .LVU751
 2189              	.LBB175:
 2190              	.LBI175:
  98:RT-Thread/include/rtservice.h **** {
 2191              		.loc 2 98 15 view .LVU752
 2192              	.LBB176:
 2193              		.loc 2 100 5 view .LVU753
 2194              		.loc 2 100 13 is_stmt 0 view .LVU754
 2195 0008 2B68     		ldr	r3, [r5]
 2196              	.LVL223:
ARM GAS  C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s 			page 65


 2197              		.loc 2 100 13 view .LVU755
 2198              	.LBE176:
 2199              	.LBE175:
 161:RT-Thread/src/ipc.c ****     {
 2200              		.loc 1 161 11 view .LVU756
 2201 000a 9D42     		cmp	r5, r3
 2202 000c 0DD0     		beq	.L113
 164:RT-Thread/src/ipc.c **** 
 2203              		.loc 1 164 9 is_stmt 1 view .LVU757
 164:RT-Thread/src/ipc.c **** 
 2204              		.loc 1 164 16 is_stmt 0 view .LVU758
 2205 000e FFF7FEFF 		bl	rt_hw_interrupt_disable
 2206              	.LVL224:
 2207 0012 0646     		mov	r6, r0
 2208              	.LVL225:
 167:RT-Thread/src/ipc.c ****         /* set error code to RT_ERROR */
 2209              		.loc 1 167 9 is_stmt 1 view .LVU759
 167:RT-Thread/src/ipc.c ****         /* set error code to RT_ERROR */
 2210              		.loc 1 167 18 is_stmt 0 view .LVU760
 2211 0014 2868     		ldr	r0, [r5]
 2212              	.LVL226:
 169:RT-Thread/src/ipc.c **** 
 2213              		.loc 1 169 9 is_stmt 1 view .LVU761
 169:RT-Thread/src/ipc.c **** 
 2214              		.loc 1 169 23 is_stmt 0 view .LVU762
 2215 0016 4FF0FF33 		mov	r3, #-1
 2216 001a C361     		str	r3, [r0, #28]
 176:RT-Thread/src/ipc.c **** 
 2217              		.loc 1 176 9 is_stmt 1 view .LVU763
 2218 001c 1438     		subs	r0, r0, #20
 2219              	.LVL227:
 176:RT-Thread/src/ipc.c **** 
 2220              		.loc 1 176 9 is_stmt 0 view .LVU764
 2221 001e FFF7FEFF 		bl	rt_thread_resume
 2222              	.LVL228:
 179:RT-Thread/src/ipc.c ****     }
 2223              		.loc 1 179 9 is_stmt 1 view .LVU765
 2224 0022 3046     		mov	r0, r6
 2225 0024 FFF7FEFF 		bl	rt_hw_interrupt_enable
 2226              	.LVL229:
 2227 0028 EEE7     		b	.L110
 2228              	.LVL230:
 2229              	.L113:
 182:RT-Thread/src/ipc.c **** }
 2230              		.loc 1 182 5 view .LVU766
 182:RT-Thread/src/ipc.c **** }
 2231              		.loc 1 182 5 is_stmt 0 view .LVU767
 2232              	.LBE174:
 2233              	.LBE173:
1009:RT-Thread/src/ipc.c **** 
1010:RT-Thread/src/ipc.c ****     /* delete event object */
1011:RT-Thread/src/ipc.c ****     rt_object_delete(&(event->parent.parent));
 2234              		.loc 1 1011 5 is_stmt 1 view .LVU768
 2235 002a 2046     		mov	r0, r4
 2236 002c FFF7FEFF 		bl	rt_object_delete
 2237              	.LVL231:
1012:RT-Thread/src/ipc.c **** 
ARM GAS  C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s 			page 66


1013:RT-Thread/src/ipc.c ****     return RT_EOK;
 2238              		.loc 1 1013 5 view .LVU769
1014:RT-Thread/src/ipc.c **** }
 2239              		.loc 1 1014 1 is_stmt 0 view .LVU770
 2240 0030 0020     		movs	r0, #0
 2241 0032 70BD     		pop	{r4, r5, r6, pc}
 2242              		.loc 1 1014 1 view .LVU771
 2243              		.cfi_endproc
 2244              	.LFE37:
 2246              		.section	.text.rt_event_send,"ax",%progbits
 2247              		.align	1
 2248              		.global	rt_event_send
 2249              		.syntax unified
 2250              		.thumb
 2251              		.thumb_func
 2252              		.fpu softvfp
 2254              	rt_event_send:
 2255              	.LVL232:
 2256              	.LFB38:
1015:RT-Thread/src/ipc.c **** RTM_EXPORT(rt_event_delete);
1016:RT-Thread/src/ipc.c **** #endif
1017:RT-Thread/src/ipc.c **** 
1018:RT-Thread/src/ipc.c **** /**
1019:RT-Thread/src/ipc.c ****  * This function will send an event to the event object, if there are threads
1020:RT-Thread/src/ipc.c ****  * suspended on event object, it will be waked up.
1021:RT-Thread/src/ipc.c ****  *
1022:RT-Thread/src/ipc.c ****  * @param event the event object
1023:RT-Thread/src/ipc.c ****  * @param set the event set
1024:RT-Thread/src/ipc.c ****  *
1025:RT-Thread/src/ipc.c ****  * @return the error code
1026:RT-Thread/src/ipc.c ****  */
1027:RT-Thread/src/ipc.c **** rt_err_t rt_event_send(rt_event_t event, rt_uint32_t set)
1028:RT-Thread/src/ipc.c **** {
 2257              		.loc 1 1028 1 is_stmt 1 view -0
 2258              		.cfi_startproc
 2259              		@ args = 0, pretend = 0, frame = 0
 2260              		@ frame_needed = 0, uses_anonymous_args = 0
 2261              		.loc 1 1028 1 is_stmt 0 view .LVU773
 2262 0000 2DE9F041 		push	{r4, r5, r6, r7, r8, lr}
 2263              	.LCFI25:
 2264              		.cfi_def_cfa_offset 24
 2265              		.cfi_offset 4, -24
 2266              		.cfi_offset 5, -20
 2267              		.cfi_offset 6, -16
 2268              		.cfi_offset 7, -12
 2269              		.cfi_offset 8, -8
 2270              		.cfi_offset 14, -4
1029:RT-Thread/src/ipc.c ****     struct rt_list_node *n;
 2271              		.loc 1 1029 5 is_stmt 1 view .LVU774
1030:RT-Thread/src/ipc.c ****     struct rt_thread *thread;
 2272              		.loc 1 1030 5 view .LVU775
1031:RT-Thread/src/ipc.c ****     register rt_ubase_t level;
 2273              		.loc 1 1031 5 view .LVU776
1032:RT-Thread/src/ipc.c ****     register rt_base_t status;
 2274              		.loc 1 1032 5 view .LVU777
1033:RT-Thread/src/ipc.c ****     rt_bool_t need_schedule;
 2275              		.loc 1 1033 5 view .LVU778
ARM GAS  C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s 			page 67


1034:RT-Thread/src/ipc.c **** 
1035:RT-Thread/src/ipc.c ****     /* parameter check */
1036:RT-Thread/src/ipc.c ****     RT_ASSERT(event != RT_NULL);
 2276              		.loc 1 1036 32 view .LVU779
1037:RT-Thread/src/ipc.c ****     RT_ASSERT(rt_object_get_type(&event->parent.parent) == RT_Object_Class_Event);
 2277              		.loc 1 1037 82 view .LVU780
1038:RT-Thread/src/ipc.c **** 
1039:RT-Thread/src/ipc.c ****     if (set == 0)
 2278              		.loc 1 1039 5 view .LVU781
 2279              		.loc 1 1039 8 is_stmt 0 view .LVU782
 2280 0004 0029     		cmp	r1, #0
 2281 0006 45D0     		beq	.L126
 2282 0008 0446     		mov	r4, r0
 2283 000a 0D46     		mov	r5, r1
1040:RT-Thread/src/ipc.c ****         return -RT_ERROR;
1041:RT-Thread/src/ipc.c **** 
1042:RT-Thread/src/ipc.c ****     need_schedule = RT_FALSE;
 2284              		.loc 1 1042 5 is_stmt 1 view .LVU783
 2285              	.LVL233:
1043:RT-Thread/src/ipc.c **** 
1044:RT-Thread/src/ipc.c ****     /* disable interrupt */
1045:RT-Thread/src/ipc.c ****     level = rt_hw_interrupt_disable();
 2286              		.loc 1 1045 5 view .LVU784
 2287              		.loc 1 1045 13 is_stmt 0 view .LVU785
 2288 000c FFF7FEFF 		bl	rt_hw_interrupt_disable
 2289              	.LVL234:
 2290              		.loc 1 1045 13 view .LVU786
 2291 0010 8046     		mov	r8, r0
 2292              	.LVL235:
1046:RT-Thread/src/ipc.c **** 
1047:RT-Thread/src/ipc.c ****     /* set event */
1048:RT-Thread/src/ipc.c ****     event->set |= set;
 2293              		.loc 1 1048 5 is_stmt 1 view .LVU787
 2294              		.loc 1 1048 16 is_stmt 0 view .LVU788
 2295 0012 E369     		ldr	r3, [r4, #28]
 2296 0014 2B43     		orrs	r3, r3, r5
 2297 0016 E361     		str	r3, [r4, #28]
1049:RT-Thread/src/ipc.c **** 
1050:RT-Thread/src/ipc.c ****     RT_OBJECT_HOOK_CALL(rt_object_put_hook, (&(event->parent.parent)));
 2298              		.loc 1 1050 71 is_stmt 1 view .LVU789
1051:RT-Thread/src/ipc.c ****     
1052:RT-Thread/src/ipc.c ****     if (!rt_list_isempty(&event->parent.suspend_thread))
 2299              		.loc 1 1052 5 view .LVU790
 2300              		.loc 1 1052 26 is_stmt 0 view .LVU791
 2301 0018 04F11405 		add	r5, r4, #20
 2302              	.LVL236:
 2303              	.LBB177:
 2304              	.LBI177:
  98:RT-Thread/include/rtservice.h **** {
 2305              		.loc 2 98 15 is_stmt 1 view .LVU792
 2306              	.LBB178:
 2307              		.loc 2 100 5 view .LVU793
 2308              		.loc 2 100 13 is_stmt 0 view .LVU794
 2309 001c 6369     		ldr	r3, [r4, #20]
 2310              	.LVL237:
 2311              		.loc 2 100 13 view .LVU795
 2312              	.LBE178:
ARM GAS  C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s 			page 68


 2313              	.LBE177:
 2314              		.loc 1 1052 8 view .LVU796
 2315 001e 9D42     		cmp	r5, r3
 2316 0020 01D0     		beq	.L129
1042:RT-Thread/src/ipc.c **** 
 2317              		.loc 1 1042 19 view .LVU797
 2318 0022 0026     		movs	r6, #0
 2319 0024 09E0     		b	.L116
 2320              	.L129:
 2321 0026 0026     		movs	r6, #0
 2322              	.LVL238:
 2323              	.L117:
1053:RT-Thread/src/ipc.c ****     {
1054:RT-Thread/src/ipc.c ****         /* search thread list to resume thread */
1055:RT-Thread/src/ipc.c ****         n = event->parent.suspend_thread.next;
1056:RT-Thread/src/ipc.c ****         while (n != &(event->parent.suspend_thread))
1057:RT-Thread/src/ipc.c ****         {
1058:RT-Thread/src/ipc.c ****             /* get thread */
1059:RT-Thread/src/ipc.c ****             thread = rt_list_entry(n, struct rt_thread, tlist);
1060:RT-Thread/src/ipc.c **** 
1061:RT-Thread/src/ipc.c ****             status = -RT_ERROR;
1062:RT-Thread/src/ipc.c ****             if (thread->event_info & RT_EVENT_FLAG_AND)
1063:RT-Thread/src/ipc.c ****             {
1064:RT-Thread/src/ipc.c ****                 if ((thread->event_set & event->set) == thread->event_set)
1065:RT-Thread/src/ipc.c ****                 {
1066:RT-Thread/src/ipc.c ****                     /* received an AND event */
1067:RT-Thread/src/ipc.c ****                     status = RT_EOK;
1068:RT-Thread/src/ipc.c ****                 }
1069:RT-Thread/src/ipc.c ****             }
1070:RT-Thread/src/ipc.c ****             else if (thread->event_info & RT_EVENT_FLAG_OR)
1071:RT-Thread/src/ipc.c ****             {
1072:RT-Thread/src/ipc.c ****                 if (thread->event_set & event->set)
1073:RT-Thread/src/ipc.c ****                 {
1074:RT-Thread/src/ipc.c ****                     /* save recieved event set */
1075:RT-Thread/src/ipc.c ****                     thread->event_set = thread->event_set & event->set;
1076:RT-Thread/src/ipc.c **** 
1077:RT-Thread/src/ipc.c ****                     /* received an OR event */
1078:RT-Thread/src/ipc.c ****                     status = RT_EOK;
1079:RT-Thread/src/ipc.c ****                 }
1080:RT-Thread/src/ipc.c ****             }
1081:RT-Thread/src/ipc.c **** 
1082:RT-Thread/src/ipc.c ****             /* move node to the next */
1083:RT-Thread/src/ipc.c ****             n = n->next;
1084:RT-Thread/src/ipc.c **** 
1085:RT-Thread/src/ipc.c ****             /* condition is satisfied, resume thread */
1086:RT-Thread/src/ipc.c ****             if (status == RT_EOK)
1087:RT-Thread/src/ipc.c ****             {
1088:RT-Thread/src/ipc.c ****                 /* clear event */
1089:RT-Thread/src/ipc.c ****                 if (thread->event_info & RT_EVENT_FLAG_CLEAR)
1090:RT-Thread/src/ipc.c ****                     event->set &= ~thread->event_set;
1091:RT-Thread/src/ipc.c **** 
1092:RT-Thread/src/ipc.c ****                 /* resume thread, and thread list breaks out */
1093:RT-Thread/src/ipc.c ****                 rt_thread_resume(thread);
1094:RT-Thread/src/ipc.c **** 
1095:RT-Thread/src/ipc.c ****                 /* need do a scheduling */
1096:RT-Thread/src/ipc.c ****                 need_schedule = RT_TRUE;
1097:RT-Thread/src/ipc.c ****             }
ARM GAS  C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s 			page 69


1098:RT-Thread/src/ipc.c ****         }
1099:RT-Thread/src/ipc.c ****     }
1100:RT-Thread/src/ipc.c **** 
1101:RT-Thread/src/ipc.c ****     /* enable interrupt */
1102:RT-Thread/src/ipc.c ****     rt_hw_interrupt_enable(level);
 2324              		.loc 1 1102 5 is_stmt 1 view .LVU798
 2325 0028 4046     		mov	r0, r8
 2326 002a FFF7FEFF 		bl	rt_hw_interrupt_enable
 2327              	.LVL239:
1103:RT-Thread/src/ipc.c **** 
1104:RT-Thread/src/ipc.c ****     /* do a schedule */
1105:RT-Thread/src/ipc.c ****     if (need_schedule == RT_TRUE)
 2328              		.loc 1 1105 5 view .LVU799
 2329              		.loc 1 1105 8 is_stmt 0 view .LVU800
 2330 002e 012E     		cmp	r6, #1
 2331 0030 2CD0     		beq	.L130
 2332              	.LVL240:
 2333              	.L114:
1106:RT-Thread/src/ipc.c ****         rt_schedule();
1107:RT-Thread/src/ipc.c **** 
1108:RT-Thread/src/ipc.c ****     return RT_EOK;
1109:RT-Thread/src/ipc.c **** }
 2334              		.loc 1 1109 1 view .LVU801
 2335 0032 3046     		mov	r0, r6
 2336 0034 BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 2337              	.LVL241:
 2338              	.L131:
1083:RT-Thread/src/ipc.c **** 
 2339              		.loc 1 1083 13 is_stmt 1 view .LVU802
1083:RT-Thread/src/ipc.c **** 
 2340              		.loc 1 1083 15 is_stmt 0 view .LVU803
 2341 0038 1B68     		ldr	r3, [r3]
 2342              	.LVL242:
1086:RT-Thread/src/ipc.c ****             {
 2343              		.loc 1 1086 13 is_stmt 1 view .LVU804
 2344              	.L116:
1056:RT-Thread/src/ipc.c ****         {
 2345              		.loc 1 1056 15 view .LVU805
 2346 003a 9D42     		cmp	r5, r3
 2347 003c F4D0     		beq	.L117
1059:RT-Thread/src/ipc.c **** 
 2348              		.loc 1 1059 13 view .LVU806
1059:RT-Thread/src/ipc.c **** 
 2349              		.loc 1 1059 20 is_stmt 0 view .LVU807
 2350 003e A3F11400 		sub	r0, r3, #20
 2351              	.LVL243:
1061:RT-Thread/src/ipc.c ****             if (thread->event_info & RT_EVENT_FLAG_AND)
 2352              		.loc 1 1061 13 is_stmt 1 view .LVU808
1062:RT-Thread/src/ipc.c ****             {
 2353              		.loc 1 1062 13 view .LVU809
1062:RT-Thread/src/ipc.c ****             {
 2354              		.loc 1 1062 23 is_stmt 0 view .LVU810
 2355 0042 93F83020 		ldrb	r2, [r3, #48]	@ zero_extendqisi2
1062:RT-Thread/src/ipc.c ****             {
 2356              		.loc 1 1062 16 view .LVU811
 2357 0046 12F0010F 		tst	r2, #1
 2358 004a 11D0     		beq	.L118
ARM GAS  C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s 			page 70


1064:RT-Thread/src/ipc.c ****                 {
 2359              		.loc 1 1064 17 is_stmt 1 view .LVU812
1064:RT-Thread/src/ipc.c ****                 {
 2360              		.loc 1 1064 28 is_stmt 0 view .LVU813
 2361 004c D96A     		ldr	r1, [r3, #44]
1064:RT-Thread/src/ipc.c ****                 {
 2362              		.loc 1 1064 20 view .LVU814
 2363 004e E769     		ldr	r7, [r4, #28]
 2364 0050 B943     		bics	r1, r1, r7
 2365 0052 F1D1     		bne	.L131
1067:RT-Thread/src/ipc.c ****                 }
 2366              		.loc 1 1067 21 is_stmt 1 view .LVU815
 2367              	.LVL244:
1083:RT-Thread/src/ipc.c **** 
 2368              		.loc 1 1083 13 view .LVU816
1083:RT-Thread/src/ipc.c **** 
 2369              		.loc 1 1083 15 is_stmt 0 view .LVU817
 2370 0054 1E68     		ldr	r6, [r3]
 2371              	.LVL245:
1086:RT-Thread/src/ipc.c ****             {
 2372              		.loc 1 1086 13 is_stmt 1 view .LVU818
 2373              	.L121:
1089:RT-Thread/src/ipc.c ****                     event->set &= ~thread->event_set;
 2374              		.loc 1 1089 17 view .LVU819
1089:RT-Thread/src/ipc.c ****                     event->set &= ~thread->event_set;
 2375              		.loc 1 1089 20 is_stmt 0 view .LVU820
 2376 0056 12F0040F 		tst	r2, #4
 2377 005a 04D0     		beq	.L124
1090:RT-Thread/src/ipc.c **** 
 2378              		.loc 1 1090 21 is_stmt 1 view .LVU821
1090:RT-Thread/src/ipc.c **** 
 2379              		.loc 1 1090 42 is_stmt 0 view .LVU822
 2380 005c DA6A     		ldr	r2, [r3, #44]
1090:RT-Thread/src/ipc.c **** 
 2381              		.loc 1 1090 32 view .LVU823
 2382 005e E369     		ldr	r3, [r4, #28]
 2383 0060 23EA0203 		bic	r3, r3, r2
 2384 0064 E361     		str	r3, [r4, #28]
 2385              	.L124:
1093:RT-Thread/src/ipc.c **** 
 2386              		.loc 1 1093 17 is_stmt 1 view .LVU824
 2387 0066 FFF7FEFF 		bl	rt_thread_resume
 2388              	.LVL246:
1096:RT-Thread/src/ipc.c ****             }
 2389              		.loc 1 1096 17 view .LVU825
1093:RT-Thread/src/ipc.c **** 
 2390              		.loc 1 1093 17 is_stmt 0 view .LVU826
 2391 006a 3346     		mov	r3, r6
1096:RT-Thread/src/ipc.c ****             }
 2392              		.loc 1 1096 31 view .LVU827
 2393 006c 0126     		movs	r6, #1
 2394              	.LVL247:
1096:RT-Thread/src/ipc.c ****             }
 2395              		.loc 1 1096 31 view .LVU828
 2396 006e E4E7     		b	.L116
 2397              	.LVL248:
 2398              	.L118:
ARM GAS  C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s 			page 71


1070:RT-Thread/src/ipc.c ****             {
 2399              		.loc 1 1070 18 is_stmt 1 view .LVU829
1070:RT-Thread/src/ipc.c ****             {
 2400              		.loc 1 1070 21 is_stmt 0 view .LVU830
 2401 0070 12F0020F 		tst	r2, #2
 2402 0074 08D0     		beq	.L122
1072:RT-Thread/src/ipc.c ****                 {
 2403              		.loc 1 1072 17 is_stmt 1 view .LVU831
1072:RT-Thread/src/ipc.c ****                 {
 2404              		.loc 1 1072 27 is_stmt 0 view .LVU832
 2405 0076 D96A     		ldr	r1, [r3, #44]
1072:RT-Thread/src/ipc.c ****                 {
 2406              		.loc 1 1072 20 view .LVU833
 2407 0078 E769     		ldr	r7, [r4, #28]
 2408 007a 3940     		ands	r1, r1, r7
 2409 007c 02D0     		beq	.L123
1075:RT-Thread/src/ipc.c **** 
 2410              		.loc 1 1075 21 is_stmt 1 view .LVU834
1075:RT-Thread/src/ipc.c **** 
 2411              		.loc 1 1075 39 is_stmt 0 view .LVU835
 2412 007e D962     		str	r1, [r3, #44]
1078:RT-Thread/src/ipc.c ****                 }
 2413              		.loc 1 1078 21 is_stmt 1 view .LVU836
 2414              	.LVL249:
1083:RT-Thread/src/ipc.c **** 
 2415              		.loc 1 1083 13 view .LVU837
1083:RT-Thread/src/ipc.c **** 
 2416              		.loc 1 1083 15 is_stmt 0 view .LVU838
 2417 0080 1E68     		ldr	r6, [r3]
 2418              	.LVL250:
1086:RT-Thread/src/ipc.c ****             {
 2419              		.loc 1 1086 13 is_stmt 1 view .LVU839
 2420 0082 E8E7     		b	.L121
 2421              	.LVL251:
 2422              	.L123:
1083:RT-Thread/src/ipc.c **** 
 2423              		.loc 1 1083 13 view .LVU840
1083:RT-Thread/src/ipc.c **** 
 2424              		.loc 1 1083 15 is_stmt 0 view .LVU841
 2425 0084 1B68     		ldr	r3, [r3]
 2426              	.LVL252:
1086:RT-Thread/src/ipc.c ****             {
 2427              		.loc 1 1086 13 is_stmt 1 view .LVU842
 2428 0086 D8E7     		b	.L116
 2429              	.L122:
1083:RT-Thread/src/ipc.c **** 
 2430              		.loc 1 1083 13 view .LVU843
1083:RT-Thread/src/ipc.c **** 
 2431              		.loc 1 1083 15 is_stmt 0 view .LVU844
 2432 0088 1B68     		ldr	r3, [r3]
 2433              	.LVL253:
1086:RT-Thread/src/ipc.c ****             {
 2434              		.loc 1 1086 13 is_stmt 1 view .LVU845
 2435 008a D6E7     		b	.L116
 2436              	.LVL254:
 2437              	.L130:
1106:RT-Thread/src/ipc.c **** 
ARM GAS  C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s 			page 72


 2438              		.loc 1 1106 9 view .LVU846
 2439 008c FFF7FEFF 		bl	rt_schedule
 2440              	.LVL255:
1108:RT-Thread/src/ipc.c **** }
 2441              		.loc 1 1108 12 is_stmt 0 view .LVU847
 2442 0090 0026     		movs	r6, #0
 2443              	.LVL256:
1108:RT-Thread/src/ipc.c **** }
 2444              		.loc 1 1108 12 view .LVU848
 2445 0092 CEE7     		b	.L114
 2446              	.LVL257:
 2447              	.L126:
1040:RT-Thread/src/ipc.c **** 
 2448              		.loc 1 1040 16 view .LVU849
 2449 0094 4FF0FF36 		mov	r6, #-1
 2450 0098 CBE7     		b	.L114
 2451              		.cfi_endproc
 2452              	.LFE38:
 2454              		.section	.text.rt_event_recv,"ax",%progbits
 2455              		.align	1
 2456              		.global	rt_event_recv
 2457              		.syntax unified
 2458              		.thumb
 2459              		.thumb_func
 2460              		.fpu softvfp
 2462              	rt_event_recv:
 2463              	.LVL258:
 2464              	.LFB39:
1110:RT-Thread/src/ipc.c **** RTM_EXPORT(rt_event_send);
1111:RT-Thread/src/ipc.c **** 
1112:RT-Thread/src/ipc.c **** /**
1113:RT-Thread/src/ipc.c ****  * This function will receive an event from event object, if the event is
1114:RT-Thread/src/ipc.c ****  * unavailable, the thread shall wait for a specified time.
1115:RT-Thread/src/ipc.c ****  *
1116:RT-Thread/src/ipc.c ****  * @param event the fast event object
1117:RT-Thread/src/ipc.c ****  * @param set the interested event set
1118:RT-Thread/src/ipc.c ****  * @param option the receive option, either RT_EVENT_FLAG_AND or
1119:RT-Thread/src/ipc.c ****  *        RT_EVENT_FLAG_OR should be set.
1120:RT-Thread/src/ipc.c ****  * @param timeout the waiting time
1121:RT-Thread/src/ipc.c ****  * @param recved the received event, if you don't care, RT_NULL can be set.
1122:RT-Thread/src/ipc.c ****  *
1123:RT-Thread/src/ipc.c ****  * @return the error code
1124:RT-Thread/src/ipc.c ****  */
1125:RT-Thread/src/ipc.c **** rt_err_t rt_event_recv(rt_event_t   event,
1126:RT-Thread/src/ipc.c ****                        rt_uint32_t  set,
1127:RT-Thread/src/ipc.c ****                        rt_uint8_t   option,
1128:RT-Thread/src/ipc.c ****                        rt_int32_t   timeout,
1129:RT-Thread/src/ipc.c ****                        rt_uint32_t *recved)
1130:RT-Thread/src/ipc.c **** {
 2465              		.loc 1 1130 1 is_stmt 1 view -0
 2466              		.cfi_startproc
 2467              		@ args = 4, pretend = 0, frame = 8
 2468              		@ frame_needed = 0, uses_anonymous_args = 0
 2469              		.loc 1 1130 1 is_stmt 0 view .LVU851
 2470 0000 2DE9F041 		push	{r4, r5, r6, r7, r8, lr}
 2471              	.LCFI26:
 2472              		.cfi_def_cfa_offset 24
ARM GAS  C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s 			page 73


 2473              		.cfi_offset 4, -24
 2474              		.cfi_offset 5, -20
 2475              		.cfi_offset 6, -16
 2476              		.cfi_offset 7, -12
 2477              		.cfi_offset 8, -8
 2478              		.cfi_offset 14, -4
 2479 0004 82B0     		sub	sp, sp, #8
 2480              	.LCFI27:
 2481              		.cfi_def_cfa_offset 32
 2482 0006 0193     		str	r3, [sp, #4]
1131:RT-Thread/src/ipc.c ****     struct rt_thread *thread;
 2483              		.loc 1 1131 5 is_stmt 1 view .LVU852
1132:RT-Thread/src/ipc.c ****     register rt_ubase_t level;
 2484              		.loc 1 1132 5 view .LVU853
1133:RT-Thread/src/ipc.c ****     register rt_base_t status;
 2485              		.loc 1 1133 5 view .LVU854
1134:RT-Thread/src/ipc.c **** 
1135:RT-Thread/src/ipc.c ****     RT_DEBUG_IN_THREAD_CONTEXT;
 2486              		.loc 1 1135 31 view .LVU855
1136:RT-Thread/src/ipc.c **** 
1137:RT-Thread/src/ipc.c ****     /* parameter check */
1138:RT-Thread/src/ipc.c ****     RT_ASSERT(event != RT_NULL);
 2487              		.loc 1 1138 32 view .LVU856
1139:RT-Thread/src/ipc.c ****     RT_ASSERT(rt_object_get_type(&event->parent.parent) == RT_Object_Class_Event);
 2488              		.loc 1 1139 82 view .LVU857
1140:RT-Thread/src/ipc.c **** 
1141:RT-Thread/src/ipc.c ****     if (set == 0)
 2489              		.loc 1 1141 5 view .LVU858
 2490              		.loc 1 1141 8 is_stmt 0 view .LVU859
 2491 0008 0029     		cmp	r1, #0
 2492 000a 00F08A80 		beq	.L148
 2493 000e 0746     		mov	r7, r0
 2494 0010 1546     		mov	r5, r2
 2495 0012 8846     		mov	r8, r1
1142:RT-Thread/src/ipc.c ****         return -RT_ERROR;
1143:RT-Thread/src/ipc.c **** 
1144:RT-Thread/src/ipc.c ****     /* init status */
1145:RT-Thread/src/ipc.c ****     status = -RT_ERROR;
 2496              		.loc 1 1145 5 is_stmt 1 view .LVU860
 2497              	.LVL259:
1146:RT-Thread/src/ipc.c ****     /* get current thread */
1147:RT-Thread/src/ipc.c ****     thread = rt_thread_self();
 2498              		.loc 1 1147 5 view .LVU861
 2499              		.loc 1 1147 14 is_stmt 0 view .LVU862
 2500 0014 FFF7FEFF 		bl	rt_thread_self
 2501              	.LVL260:
 2502              		.loc 1 1147 14 view .LVU863
 2503 0018 0446     		mov	r4, r0
 2504              	.LVL261:
1148:RT-Thread/src/ipc.c ****     /* reset thread error */
1149:RT-Thread/src/ipc.c ****     thread->error = RT_EOK;
 2505              		.loc 1 1149 5 is_stmt 1 view .LVU864
 2506              		.loc 1 1149 19 is_stmt 0 view .LVU865
 2507 001a 0023     		movs	r3, #0
 2508 001c 0363     		str	r3, [r0, #48]
1150:RT-Thread/src/ipc.c **** 
1151:RT-Thread/src/ipc.c ****     RT_OBJECT_HOOK_CALL(rt_object_trytake_hook, (&(event->parent.parent)));
ARM GAS  C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s 			page 74


 2509              		.loc 1 1151 75 is_stmt 1 view .LVU866
1152:RT-Thread/src/ipc.c **** 
1153:RT-Thread/src/ipc.c ****     /* disable interrupt */
1154:RT-Thread/src/ipc.c ****     level = rt_hw_interrupt_disable();
 2510              		.loc 1 1154 5 view .LVU867
 2511              		.loc 1 1154 13 is_stmt 0 view .LVU868
 2512 001e FFF7FEFF 		bl	rt_hw_interrupt_disable
 2513              	.LVL262:
 2514              		.loc 1 1154 13 view .LVU869
 2515 0022 0646     		mov	r6, r0
 2516              	.LVL263:
1155:RT-Thread/src/ipc.c **** 
1156:RT-Thread/src/ipc.c ****     /* check event set */
1157:RT-Thread/src/ipc.c ****     if (option & RT_EVENT_FLAG_AND)
 2517              		.loc 1 1157 5 is_stmt 1 view .LVU870
 2518              		.loc 1 1157 8 is_stmt 0 view .LVU871
 2519 0024 15F0010F 		tst	r5, #1
 2520 0028 0ED0     		beq	.L134
1158:RT-Thread/src/ipc.c ****     {
1159:RT-Thread/src/ipc.c ****         if ((event->set & set) == set)
 2521              		.loc 1 1159 9 is_stmt 1 view .LVU872
 2522              		.loc 1 1159 19 is_stmt 0 view .LVU873
 2523 002a FB69     		ldr	r3, [r7, #28]
 2524              		.loc 1 1159 12 view .LVU874
 2525 002c 38EA0303 		bics	r3, r8, r3
 2526 0030 11D0     		beq	.L135
 2527              	.L136:
 2528              	.LVL264:
1160:RT-Thread/src/ipc.c ****             status = RT_EOK;
1161:RT-Thread/src/ipc.c ****     }
1162:RT-Thread/src/ipc.c ****     else if (option & RT_EVENT_FLAG_OR)
1163:RT-Thread/src/ipc.c ****     {
1164:RT-Thread/src/ipc.c ****         if (event->set & set)
1165:RT-Thread/src/ipc.c ****             status = RT_EOK;
1166:RT-Thread/src/ipc.c ****     }
1167:RT-Thread/src/ipc.c ****     else
1168:RT-Thread/src/ipc.c ****     {
1169:RT-Thread/src/ipc.c ****         /* either RT_EVENT_FLAG_AND or RT_EVENT_FLAG_OR should be set */
1170:RT-Thread/src/ipc.c ****         RT_ASSERT(0);
1171:RT-Thread/src/ipc.c ****     }
1172:RT-Thread/src/ipc.c **** 
1173:RT-Thread/src/ipc.c ****     if (status == RT_EOK)
1174:RT-Thread/src/ipc.c ****     {
1175:RT-Thread/src/ipc.c ****         /* set received event */
1176:RT-Thread/src/ipc.c ****         if (recved)
1177:RT-Thread/src/ipc.c ****             *recved = (event->set & set);
1178:RT-Thread/src/ipc.c **** 
1179:RT-Thread/src/ipc.c ****         /* received event */
1180:RT-Thread/src/ipc.c ****         if (option & RT_EVENT_FLAG_CLEAR)
1181:RT-Thread/src/ipc.c ****             event->set &= ~set;
1182:RT-Thread/src/ipc.c ****     }
1183:RT-Thread/src/ipc.c ****     else if (timeout == 0)
 2529              		.loc 1 1183 10 is_stmt 1 view .LVU875
 2530              		.loc 1 1183 22 is_stmt 0 view .LVU876
 2531 0032 019B     		ldr	r3, [sp, #4]
 2532              		.loc 1 1183 13 view .LVU877
 2533 0034 F3B9     		cbnz	r3, .L139
ARM GAS  C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s 			page 75


1184:RT-Thread/src/ipc.c ****     {
1185:RT-Thread/src/ipc.c ****         /* no waiting */
1186:RT-Thread/src/ipc.c ****         thread->error = -RT_ETIMEOUT;
 2534              		.loc 1 1186 9 is_stmt 1 view .LVU878
 2535              		.loc 1 1186 23 is_stmt 0 view .LVU879
 2536 0036 6FF00103 		mvn	r3, #1
 2537 003a 2363     		str	r3, [r4, #48]
 2538              	.LVL265:
 2539              	.L138:
1187:RT-Thread/src/ipc.c ****     }
1188:RT-Thread/src/ipc.c ****     else
1189:RT-Thread/src/ipc.c ****     {
1190:RT-Thread/src/ipc.c ****         /* fill thread event info */
1191:RT-Thread/src/ipc.c ****         thread->event_set  = set;
1192:RT-Thread/src/ipc.c ****         thread->event_info = option;
1193:RT-Thread/src/ipc.c **** 
1194:RT-Thread/src/ipc.c ****         /* put thread to suspended thread list */
1195:RT-Thread/src/ipc.c ****         rt_ipc_list_suspend(&(event->parent.suspend_thread),
1196:RT-Thread/src/ipc.c ****                             thread,
1197:RT-Thread/src/ipc.c ****                             event->parent.parent.flag);
1198:RT-Thread/src/ipc.c **** 
1199:RT-Thread/src/ipc.c ****         /* if there is a waiting timeout, active thread timer */
1200:RT-Thread/src/ipc.c ****         if (timeout > 0)
1201:RT-Thread/src/ipc.c ****         {
1202:RT-Thread/src/ipc.c ****             /* reset the timeout of thread timer and start it */
1203:RT-Thread/src/ipc.c ****             rt_timer_control(&(thread->thread_timer),
1204:RT-Thread/src/ipc.c ****                              RT_TIMER_CTRL_SET_TIME,
1205:RT-Thread/src/ipc.c ****                              &timeout);
1206:RT-Thread/src/ipc.c ****             rt_timer_start(&(thread->thread_timer));
1207:RT-Thread/src/ipc.c ****         }
1208:RT-Thread/src/ipc.c **** 
1209:RT-Thread/src/ipc.c ****         /* enable interrupt */
1210:RT-Thread/src/ipc.c ****         rt_hw_interrupt_enable(level);
1211:RT-Thread/src/ipc.c **** 
1212:RT-Thread/src/ipc.c ****         /* do a schedule */
1213:RT-Thread/src/ipc.c ****         rt_schedule();
1214:RT-Thread/src/ipc.c **** 
1215:RT-Thread/src/ipc.c ****         if (thread->error != RT_EOK)
1216:RT-Thread/src/ipc.c ****         {
1217:RT-Thread/src/ipc.c ****             /* return error */
1218:RT-Thread/src/ipc.c ****             return thread->error;
1219:RT-Thread/src/ipc.c ****         }
1220:RT-Thread/src/ipc.c **** 
1221:RT-Thread/src/ipc.c ****         /* received an event, disable interrupt to protect */
1222:RT-Thread/src/ipc.c ****         level = rt_hw_interrupt_disable();
1223:RT-Thread/src/ipc.c **** 
1224:RT-Thread/src/ipc.c ****         /* set received event */
1225:RT-Thread/src/ipc.c ****         if (recved)
1226:RT-Thread/src/ipc.c ****             *recved = thread->event_set;
1227:RT-Thread/src/ipc.c ****     }
1228:RT-Thread/src/ipc.c **** 
1229:RT-Thread/src/ipc.c ****     /* enable interrupt */
1230:RT-Thread/src/ipc.c ****     rt_hw_interrupt_enable(level);
 2540              		.loc 1 1230 5 is_stmt 1 view .LVU880
 2541 003c FFF7FEFF 		bl	rt_hw_interrupt_enable
 2542              	.LVL266:
1231:RT-Thread/src/ipc.c **** 
ARM GAS  C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s 			page 76


1232:RT-Thread/src/ipc.c ****     RT_OBJECT_HOOK_CALL(rt_object_take_hook, (&(event->parent.parent)));
 2543              		.loc 1 1232 72 view .LVU881
1233:RT-Thread/src/ipc.c **** 
1234:RT-Thread/src/ipc.c ****     return thread->error;
 2544              		.loc 1 1234 5 view .LVU882
 2545              		.loc 1 1234 18 is_stmt 0 view .LVU883
 2546 0040 206B     		ldr	r0, [r4, #48]
 2547              	.LVL267:
 2548              	.L132:
1235:RT-Thread/src/ipc.c **** }
 2549              		.loc 1 1235 1 view .LVU884
 2550 0042 02B0     		add	sp, sp, #8
 2551              	.LCFI28:
 2552              		.cfi_remember_state
 2553              		.cfi_def_cfa_offset 24
 2554              		@ sp needed
 2555 0044 BDE8F081 		pop	{r4, r5, r6, r7, r8, pc}
 2556              	.LVL268:
 2557              	.L134:
 2558              	.LCFI29:
 2559              		.cfi_restore_state
1162:RT-Thread/src/ipc.c ****     {
 2560              		.loc 1 1162 10 is_stmt 1 view .LVU885
1162:RT-Thread/src/ipc.c ****     {
 2561              		.loc 1 1162 13 is_stmt 0 view .LVU886
 2562 0048 15F0020F 		tst	r5, #2
 2563 004c F1D0     		beq	.L136
1164:RT-Thread/src/ipc.c ****             status = RT_EOK;
 2564              		.loc 1 1164 9 is_stmt 1 view .LVU887
1164:RT-Thread/src/ipc.c ****             status = RT_EOK;
 2565              		.loc 1 1164 18 is_stmt 0 view .LVU888
 2566 004e FB69     		ldr	r3, [r7, #28]
1164:RT-Thread/src/ipc.c ****             status = RT_EOK;
 2567              		.loc 1 1164 12 view .LVU889
 2568 0050 13EA080F 		tst	r3, r8
 2569 0054 EDD0     		beq	.L136
 2570              	.L135:
 2571              	.LVL269:
1176:RT-Thread/src/ipc.c ****             *recved = (event->set & set);
 2572              		.loc 1 1176 9 is_stmt 1 view .LVU890
1176:RT-Thread/src/ipc.c ****             *recved = (event->set & set);
 2573              		.loc 1 1176 12 is_stmt 0 view .LVU891
 2574 0056 089B     		ldr	r3, [sp, #32]
 2575 0058 23B1     		cbz	r3, .L137
1177:RT-Thread/src/ipc.c **** 
 2576              		.loc 1 1177 13 is_stmt 1 view .LVU892
1177:RT-Thread/src/ipc.c **** 
 2577              		.loc 1 1177 29 is_stmt 0 view .LVU893
 2578 005a FB69     		ldr	r3, [r7, #28]
1177:RT-Thread/src/ipc.c **** 
 2579              		.loc 1 1177 35 view .LVU894
 2580 005c 03EA0803 		and	r3, r3, r8
1177:RT-Thread/src/ipc.c **** 
 2581              		.loc 1 1177 21 view .LVU895
 2582 0060 089A     		ldr	r2, [sp, #32]
 2583 0062 1360     		str	r3, [r2]
 2584              	.L137:
ARM GAS  C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s 			page 77


1180:RT-Thread/src/ipc.c ****             event->set &= ~set;
 2585              		.loc 1 1180 9 is_stmt 1 view .LVU896
1180:RT-Thread/src/ipc.c ****             event->set &= ~set;
 2586              		.loc 1 1180 12 is_stmt 0 view .LVU897
 2587 0064 15F0040F 		tst	r5, #4
 2588 0068 E8D0     		beq	.L138
1181:RT-Thread/src/ipc.c ****     }
 2589              		.loc 1 1181 13 is_stmt 1 view .LVU898
1181:RT-Thread/src/ipc.c ****     }
 2590              		.loc 1 1181 24 is_stmt 0 view .LVU899
 2591 006a FB69     		ldr	r3, [r7, #28]
 2592 006c 23EA0803 		bic	r3, r3, r8
 2593 0070 FB61     		str	r3, [r7, #28]
 2594 0072 E3E7     		b	.L138
 2595              	.L139:
1191:RT-Thread/src/ipc.c ****         thread->event_info = option;
 2596              		.loc 1 1191 9 is_stmt 1 view .LVU900
1191:RT-Thread/src/ipc.c ****         thread->event_info = option;
 2597              		.loc 1 1191 28 is_stmt 0 view .LVU901
 2598 0074 C4F84080 		str	r8, [r4, #64]
1192:RT-Thread/src/ipc.c **** 
 2599              		.loc 1 1192 9 is_stmt 1 view .LVU902
1192:RT-Thread/src/ipc.c **** 
 2600              		.loc 1 1192 28 is_stmt 0 view .LVU903
 2601 0078 84F84450 		strb	r5, [r4, #68]
1195:RT-Thread/src/ipc.c ****                             thread,
 2602              		.loc 1 1195 9 is_stmt 1 view .LVU904
 2603 007c 07F11405 		add	r5, r7, #20
 2604 0080 97F80980 		ldrb	r8, [r7, #9]	@ zero_extendqisi2
 2605              	.LVL270:
 2606              	.LBB188:
 2607              	.LBI188:
  78:RT-Thread/src/ipc.c ****                                        struct rt_thread *thread,
 2608              		.loc 1 78 20 view .LVU905
 2609              	.LBB189:
  83:RT-Thread/src/ipc.c **** 
 2610              		.loc 1 83 5 view .LVU906
 2611 0084 2046     		mov	r0, r4
 2612              	.LVL271:
  83:RT-Thread/src/ipc.c **** 
 2613              		.loc 1 83 5 is_stmt 0 view .LVU907
 2614 0086 FFF7FEFF 		bl	rt_thread_suspend
 2615              	.LVL272:
  85:RT-Thread/src/ipc.c ****     {
 2616              		.loc 1 85 5 is_stmt 1 view .LVU908
 2617 008a B8F1000F 		cmp	r8, #0
 2618 008e 16D0     		beq	.L140
 2619 0090 B8F1010F 		cmp	r8, #1
 2620 0094 1CD0     		beq	.L141
 2621              	.L142:
 120:RT-Thread/src/ipc.c **** }
 2622              		.loc 1 120 5 view .LVU909
 2623              	.LVL273:
 120:RT-Thread/src/ipc.c **** }
 2624              		.loc 1 120 5 is_stmt 0 view .LVU910
 2625              	.LBE189:
 2626              	.LBE188:
ARM GAS  C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s 			page 78


1200:RT-Thread/src/ipc.c ****         {
 2627              		.loc 1 1200 9 is_stmt 1 view .LVU911
1200:RT-Thread/src/ipc.c ****         {
 2628              		.loc 1 1200 21 is_stmt 0 view .LVU912
 2629 0096 019B     		ldr	r3, [sp, #4]
1200:RT-Thread/src/ipc.c ****         {
 2630              		.loc 1 1200 12 view .LVU913
 2631 0098 002B     		cmp	r3, #0
 2632 009a 37DC     		bgt	.L150
 2633              	.L147:
1210:RT-Thread/src/ipc.c **** 
 2634              		.loc 1 1210 9 is_stmt 1 view .LVU914
 2635 009c 3046     		mov	r0, r6
 2636 009e FFF7FEFF 		bl	rt_hw_interrupt_enable
 2637              	.LVL274:
1213:RT-Thread/src/ipc.c **** 
 2638              		.loc 1 1213 9 view .LVU915
 2639 00a2 FFF7FEFF 		bl	rt_schedule
 2640              	.LVL275:
1215:RT-Thread/src/ipc.c ****         {
 2641              		.loc 1 1215 9 view .LVU916
1215:RT-Thread/src/ipc.c ****         {
 2642              		.loc 1 1215 19 is_stmt 0 view .LVU917
 2643 00a6 206B     		ldr	r0, [r4, #48]
1215:RT-Thread/src/ipc.c ****         {
 2644              		.loc 1 1215 12 view .LVU918
 2645 00a8 0028     		cmp	r0, #0
 2646 00aa CAD1     		bne	.L132
1222:RT-Thread/src/ipc.c **** 
 2647              		.loc 1 1222 9 is_stmt 1 view .LVU919
1222:RT-Thread/src/ipc.c **** 
 2648              		.loc 1 1222 17 is_stmt 0 view .LVU920
 2649 00ac FFF7FEFF 		bl	rt_hw_interrupt_disable
 2650              	.LVL276:
1225:RT-Thread/src/ipc.c ****             *recved = thread->event_set;
 2651              		.loc 1 1225 9 is_stmt 1 view .LVU921
1225:RT-Thread/src/ipc.c ****             *recved = thread->event_set;
 2652              		.loc 1 1225 12 is_stmt 0 view .LVU922
 2653 00b0 089B     		ldr	r3, [sp, #32]
 2654 00b2 002B     		cmp	r3, #0
 2655 00b4 C2D0     		beq	.L138
1226:RT-Thread/src/ipc.c ****     }
 2656              		.loc 1 1226 13 is_stmt 1 view .LVU923
1226:RT-Thread/src/ipc.c ****     }
 2657              		.loc 1 1226 29 is_stmt 0 view .LVU924
 2658 00b6 236C     		ldr	r3, [r4, #64]
1226:RT-Thread/src/ipc.c ****     }
 2659              		.loc 1 1226 21 view .LVU925
 2660 00b8 089A     		ldr	r2, [sp, #32]
 2661 00ba 1360     		str	r3, [r2]
 2662 00bc BEE7     		b	.L138
 2663              	.LVL277:
 2664              	.L140:
 2665              	.LBB198:
 2666              	.LBB197:
  88:RT-Thread/src/ipc.c ****         break;
 2667              		.loc 1 88 9 is_stmt 1 view .LVU926
ARM GAS  C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s 			page 79


 2668 00be 04F11403 		add	r3, r4, #20
 2669              	.LVL278:
 2670              	.LBB190:
 2671              	.LBI190:
  73:RT-Thread/include/rtservice.h **** {
 2672              		.loc 2 73 16 view .LVU927
 2673              	.LBB191:
  75:RT-Thread/include/rtservice.h ****     n->prev = l->prev;
 2674              		.loc 2 75 5 view .LVU928
  75:RT-Thread/include/rtservice.h ****     n->prev = l->prev;
 2675              		.loc 2 75 6 is_stmt 0 view .LVU929
 2676 00c2 6A68     		ldr	r2, [r5, #4]
  75:RT-Thread/include/rtservice.h ****     n->prev = l->prev;
 2677              		.loc 2 75 19 view .LVU930
 2678 00c4 1360     		str	r3, [r2]
  76:RT-Thread/include/rtservice.h **** 
 2679              		.loc 2 76 5 is_stmt 1 view .LVU931
  76:RT-Thread/include/rtservice.h **** 
 2680              		.loc 2 76 16 is_stmt 0 view .LVU932
 2681 00c6 6A68     		ldr	r2, [r5, #4]
  76:RT-Thread/include/rtservice.h **** 
 2682              		.loc 2 76 13 view .LVU933
 2683 00c8 A261     		str	r2, [r4, #24]
  78:RT-Thread/include/rtservice.h ****     n->next = l;
 2684              		.loc 2 78 5 is_stmt 1 view .LVU934
  78:RT-Thread/include/rtservice.h ****     n->next = l;
 2685              		.loc 2 78 13 is_stmt 0 view .LVU935
 2686 00ca 6B60     		str	r3, [r5, #4]
  79:RT-Thread/include/rtservice.h **** }
 2687              		.loc 2 79 5 is_stmt 1 view .LVU936
  79:RT-Thread/include/rtservice.h **** }
 2688              		.loc 2 79 13 is_stmt 0 view .LVU937
 2689 00cc 6561     		str	r5, [r4, #20]
  80:RT-Thread/include/rtservice.h **** 
 2690              		.loc 2 80 1 view .LVU938
 2691 00ce E2E7     		b	.L142
 2692              	.LVL279:
 2693              	.L141:
  80:RT-Thread/include/rtservice.h **** 
 2694              		.loc 2 80 1 view .LVU939
 2695              	.LBE191:
 2696              	.LBE190:
 2697              	.LBB192:
  93:RT-Thread/src/ipc.c ****             struct rt_thread *sthread;
 2698              		.loc 1 93 13 is_stmt 1 view .LVU940
  94:RT-Thread/src/ipc.c **** 
 2699              		.loc 1 94 13 view .LVU941
  97:RT-Thread/src/ipc.c ****             {
 2700              		.loc 1 97 13 view .LVU942
  97:RT-Thread/src/ipc.c ****             {
 2701              		.loc 1 97 20 is_stmt 0 view .LVU943
 2702 00d0 7B69     		ldr	r3, [r7, #20]
 2703              	.LVL280:
 2704              	.L143:
  97:RT-Thread/src/ipc.c ****             {
 2705              		.loc 1 97 34 is_stmt 1 view .LVU944
  97:RT-Thread/src/ipc.c ****             {
ARM GAS  C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s 			page 80


 2706              		.loc 1 97 13 is_stmt 0 view .LVU945
 2707 00d2 9D42     		cmp	r5, r3
 2708 00d4 0FD0     		beq	.L145
  99:RT-Thread/src/ipc.c **** 
 2709              		.loc 1 99 17 is_stmt 1 view .LVU946
 2710              	.LVL281:
 102:RT-Thread/src/ipc.c ****                 {
 2711              		.loc 1 102 17 view .LVU947
 102:RT-Thread/src/ipc.c ****                 {
 2712              		.loc 1 102 27 is_stmt 0 view .LVU948
 2713 00d6 94F83510 		ldrb	r1, [r4, #53]	@ zero_extendqisi2
 102:RT-Thread/src/ipc.c ****                 {
 2714              		.loc 1 102 55 view .LVU949
 2715 00da 93F82120 		ldrb	r2, [r3, #33]	@ zero_extendqisi2
 102:RT-Thread/src/ipc.c ****                 {
 2716              		.loc 1 102 20 view .LVU950
 2717 00de 9142     		cmp	r1, r2
 2718 00e0 01D3     		bcc	.L151
  97:RT-Thread/src/ipc.c ****             {
 2719              		.loc 1 97 45 is_stmt 1 view .LVU951
  97:RT-Thread/src/ipc.c ****             {
 2720              		.loc 1 97 47 is_stmt 0 view .LVU952
 2721 00e2 1B68     		ldr	r3, [r3]
 2722              	.LVL282:
  97:RT-Thread/src/ipc.c ****             {
 2723              		.loc 1 97 47 view .LVU953
 2724 00e4 F5E7     		b	.L143
 2725              	.LVL283:
 2726              	.L151:
 105:RT-Thread/src/ipc.c ****                     break;
 2727              		.loc 1 105 21 is_stmt 1 view .LVU954
 2728 00e6 04F11402 		add	r2, r4, #20
 2729              	.LVL284:
 2730              	.LBB193:
 2731              	.LBI193:
  73:RT-Thread/include/rtservice.h **** {
 2732              		.loc 2 73 16 view .LVU955
 2733              	.LBB194:
  75:RT-Thread/include/rtservice.h ****     n->prev = l->prev;
 2734              		.loc 2 75 5 view .LVU956
  75:RT-Thread/include/rtservice.h ****     n->prev = l->prev;
 2735              		.loc 2 75 6 is_stmt 0 view .LVU957
 2736 00ea 5968     		ldr	r1, [r3, #4]
  75:RT-Thread/include/rtservice.h ****     n->prev = l->prev;
 2737              		.loc 2 75 19 view .LVU958
 2738 00ec 0A60     		str	r2, [r1]
  76:RT-Thread/include/rtservice.h **** 
 2739              		.loc 2 76 5 is_stmt 1 view .LVU959
  76:RT-Thread/include/rtservice.h **** 
 2740              		.loc 2 76 16 is_stmt 0 view .LVU960
 2741 00ee 5968     		ldr	r1, [r3, #4]
  76:RT-Thread/include/rtservice.h **** 
 2742              		.loc 2 76 13 view .LVU961
 2743 00f0 A161     		str	r1, [r4, #24]
  78:RT-Thread/include/rtservice.h ****     n->next = l;
 2744              		.loc 2 78 5 is_stmt 1 view .LVU962
  78:RT-Thread/include/rtservice.h ****     n->next = l;
ARM GAS  C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s 			page 81


 2745              		.loc 2 78 13 is_stmt 0 view .LVU963
 2746 00f2 5A60     		str	r2, [r3, #4]
  79:RT-Thread/include/rtservice.h **** }
 2747              		.loc 2 79 5 is_stmt 1 view .LVU964
  79:RT-Thread/include/rtservice.h **** }
 2748              		.loc 2 79 13 is_stmt 0 view .LVU965
 2749 00f4 6361     		str	r3, [r4, #20]
 2750              	.LVL285:
 2751              	.L145:
  79:RT-Thread/include/rtservice.h **** }
 2752              		.loc 2 79 13 view .LVU966
 2753              	.LBE194:
 2754              	.LBE193:
 114:RT-Thread/src/ipc.c ****                 rt_list_insert_before(list, &(thread->tlist));
 2755              		.loc 1 114 13 is_stmt 1 view .LVU967
 114:RT-Thread/src/ipc.c ****                 rt_list_insert_before(list, &(thread->tlist));
 2756              		.loc 1 114 16 is_stmt 0 view .LVU968
 2757 00f6 9D42     		cmp	r5, r3
 2758 00f8 CDD1     		bne	.L142
 115:RT-Thread/src/ipc.c ****         }
 2759              		.loc 1 115 17 is_stmt 1 view .LVU969
 2760 00fa 04F11403 		add	r3, r4, #20
 2761              	.LVL286:
 2762              	.LBB195:
 2763              	.LBI195:
  73:RT-Thread/include/rtservice.h **** {
 2764              		.loc 2 73 16 view .LVU970
 2765              	.LBB196:
  75:RT-Thread/include/rtservice.h ****     n->prev = l->prev;
 2766              		.loc 2 75 5 view .LVU971
  75:RT-Thread/include/rtservice.h ****     n->prev = l->prev;
 2767              		.loc 2 75 6 is_stmt 0 view .LVU972
 2768 00fe 6A68     		ldr	r2, [r5, #4]
  75:RT-Thread/include/rtservice.h ****     n->prev = l->prev;
 2769              		.loc 2 75 19 view .LVU973
 2770 0100 1360     		str	r3, [r2]
  76:RT-Thread/include/rtservice.h **** 
 2771              		.loc 2 76 5 is_stmt 1 view .LVU974
  76:RT-Thread/include/rtservice.h **** 
 2772              		.loc 2 76 16 is_stmt 0 view .LVU975
 2773 0102 6A68     		ldr	r2, [r5, #4]
  76:RT-Thread/include/rtservice.h **** 
 2774              		.loc 2 76 13 view .LVU976
 2775 0104 A261     		str	r2, [r4, #24]
  78:RT-Thread/include/rtservice.h ****     n->next = l;
 2776              		.loc 2 78 5 is_stmt 1 view .LVU977
  78:RT-Thread/include/rtservice.h ****     n->next = l;
 2777              		.loc 2 78 13 is_stmt 0 view .LVU978
 2778 0106 6B60     		str	r3, [r5, #4]
  79:RT-Thread/include/rtservice.h **** }
 2779              		.loc 2 79 5 is_stmt 1 view .LVU979
  79:RT-Thread/include/rtservice.h **** }
 2780              		.loc 2 79 13 is_stmt 0 view .LVU980
 2781 0108 6561     		str	r5, [r4, #20]
  80:RT-Thread/include/rtservice.h **** 
 2782              		.loc 2 80 1 view .LVU981
 2783 010a C4E7     		b	.L142
ARM GAS  C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s 			page 82


 2784              	.LVL287:
 2785              	.L150:
  80:RT-Thread/include/rtservice.h **** 
 2786              		.loc 2 80 1 view .LVU982
 2787              	.LBE196:
 2788              	.LBE195:
 2789              	.LBE192:
 2790              	.LBE197:
 2791              	.LBE198:
1203:RT-Thread/src/ipc.c ****                              RT_TIMER_CTRL_SET_TIME,
 2792              		.loc 1 1203 13 is_stmt 1 view .LVU983
 2793 010c 04F15005 		add	r5, r4, #80
 2794 0110 01AA     		add	r2, sp, #4
 2795 0112 0021     		movs	r1, #0
 2796 0114 2846     		mov	r0, r5
 2797 0116 FFF7FEFF 		bl	rt_timer_control
 2798              	.LVL288:
1206:RT-Thread/src/ipc.c ****         }
 2799              		.loc 1 1206 13 view .LVU984
 2800 011a 2846     		mov	r0, r5
 2801 011c FFF7FEFF 		bl	rt_timer_start
 2802              	.LVL289:
 2803 0120 BCE7     		b	.L147
 2804              	.LVL290:
 2805              	.L148:
1142:RT-Thread/src/ipc.c **** 
 2806              		.loc 1 1142 16 is_stmt 0 view .LVU985
 2807 0122 4FF0FF30 		mov	r0, #-1
 2808              	.LVL291:
1142:RT-Thread/src/ipc.c **** 
 2809              		.loc 1 1142 16 view .LVU986
 2810 0126 8CE7     		b	.L132
 2811              		.cfi_endproc
 2812              	.LFE39:
 2814              		.section	.text.rt_event_control,"ax",%progbits
 2815              		.align	1
 2816              		.global	rt_event_control
 2817              		.syntax unified
 2818              		.thumb
 2819              		.thumb_func
 2820              		.fpu softvfp
 2822              	rt_event_control:
 2823              	.LVL292:
 2824              	.LFB40:
1236:RT-Thread/src/ipc.c **** RTM_EXPORT(rt_event_recv);
1237:RT-Thread/src/ipc.c **** 
1238:RT-Thread/src/ipc.c **** /**
1239:RT-Thread/src/ipc.c ****  * This function can get or set some extra attributions of an event object.
1240:RT-Thread/src/ipc.c ****  *
1241:RT-Thread/src/ipc.c ****  * @param event the event object
1242:RT-Thread/src/ipc.c ****  * @param cmd the execution command
1243:RT-Thread/src/ipc.c ****  * @param arg the execution argument
1244:RT-Thread/src/ipc.c ****  *
1245:RT-Thread/src/ipc.c ****  * @return the error code
1246:RT-Thread/src/ipc.c ****  */
1247:RT-Thread/src/ipc.c **** rt_err_t rt_event_control(rt_event_t event, int cmd, void *arg)
1248:RT-Thread/src/ipc.c **** {
ARM GAS  C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s 			page 83


 2825              		.loc 1 1248 1 is_stmt 1 view -0
 2826              		.cfi_startproc
 2827              		@ args = 0, pretend = 0, frame = 0
 2828              		@ frame_needed = 0, uses_anonymous_args = 0
1249:RT-Thread/src/ipc.c ****     rt_ubase_t level;
 2829              		.loc 1 1249 5 view .LVU988
1250:RT-Thread/src/ipc.c **** 
1251:RT-Thread/src/ipc.c ****     /* parameter check */
1252:RT-Thread/src/ipc.c ****     RT_ASSERT(event != RT_NULL);
 2830              		.loc 1 1252 32 view .LVU989
1253:RT-Thread/src/ipc.c ****     RT_ASSERT(rt_object_get_type(&event->parent.parent) == RT_Object_Class_Event);
 2831              		.loc 1 1253 82 view .LVU990
1254:RT-Thread/src/ipc.c ****     
1255:RT-Thread/src/ipc.c ****     if (cmd == RT_IPC_CMD_RESET)
 2832              		.loc 1 1255 5 view .LVU991
 2833              		.loc 1 1255 8 is_stmt 0 view .LVU992
 2834 0000 0129     		cmp	r1, #1
 2835 0002 20D1     		bne	.L156
1248:RT-Thread/src/ipc.c ****     rt_ubase_t level;
 2836              		.loc 1 1248 1 view .LVU993
 2837 0004 F8B5     		push	{r3, r4, r5, r6, r7, lr}
 2838              	.LCFI30:
 2839              		.cfi_def_cfa_offset 24
 2840              		.cfi_offset 3, -24
 2841              		.cfi_offset 4, -20
 2842              		.cfi_offset 5, -16
 2843              		.cfi_offset 6, -12
 2844              		.cfi_offset 7, -8
 2845              		.cfi_offset 14, -4
 2846 0006 0446     		mov	r4, r0
1256:RT-Thread/src/ipc.c ****     {
1257:RT-Thread/src/ipc.c ****         /* disable interrupt */
1258:RT-Thread/src/ipc.c ****         level = rt_hw_interrupt_disable();
 2847              		.loc 1 1258 9 is_stmt 1 view .LVU994
 2848              		.loc 1 1258 17 is_stmt 0 view .LVU995
 2849 0008 FFF7FEFF 		bl	rt_hw_interrupt_disable
 2850              	.LVL293:
 2851              		.loc 1 1258 17 view .LVU996
 2852 000c 0746     		mov	r7, r0
 2853              	.LVL294:
1259:RT-Thread/src/ipc.c **** 
1260:RT-Thread/src/ipc.c ****         /* resume all waiting thread */
1261:RT-Thread/src/ipc.c ****         rt_ipc_list_resume_all(&event->parent.suspend_thread);
 2854              		.loc 1 1261 9 is_stmt 1 view .LVU997
 2855 000e 04F11406 		add	r6, r4, #20
 2856              	.LVL295:
 2857              	.LBB203:
 2858              	.LBI203:
 155:RT-Thread/src/ipc.c **** {
 2859              		.loc 1 155 20 view .LVU998
 2860              	.LBB204:
 157:RT-Thread/src/ipc.c ****     register rt_ubase_t temp;
 2861              		.loc 1 157 5 view .LVU999
 158:RT-Thread/src/ipc.c **** 
 2862              		.loc 1 158 5 view .LVU1000
 161:RT-Thread/src/ipc.c ****     {
 2863              		.loc 1 161 5 view .LVU1001
ARM GAS  C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s 			page 84


 161:RT-Thread/src/ipc.c ****     {
 2864              		.loc 1 161 11 is_stmt 0 view .LVU1002
 2865 0012 0CE0     		b	.L154
 2866              	.LVL296:
 2867              	.L155:
 164:RT-Thread/src/ipc.c **** 
 2868              		.loc 1 164 9 is_stmt 1 view .LVU1003
 164:RT-Thread/src/ipc.c **** 
 2869              		.loc 1 164 16 is_stmt 0 view .LVU1004
 2870 0014 FFF7FEFF 		bl	rt_hw_interrupt_disable
 2871              	.LVL297:
 2872 0018 0546     		mov	r5, r0
 2873              	.LVL298:
 167:RT-Thread/src/ipc.c ****         /* set error code to RT_ERROR */
 2874              		.loc 1 167 9 is_stmt 1 view .LVU1005
 167:RT-Thread/src/ipc.c ****         /* set error code to RT_ERROR */
 2875              		.loc 1 167 18 is_stmt 0 view .LVU1006
 2876 001a 3068     		ldr	r0, [r6]
 2877              	.LVL299:
 169:RT-Thread/src/ipc.c **** 
 2878              		.loc 1 169 9 is_stmt 1 view .LVU1007
 169:RT-Thread/src/ipc.c **** 
 2879              		.loc 1 169 23 is_stmt 0 view .LVU1008
 2880 001c 4FF0FF33 		mov	r3, #-1
 2881 0020 C361     		str	r3, [r0, #28]
 176:RT-Thread/src/ipc.c **** 
 2882              		.loc 1 176 9 is_stmt 1 view .LVU1009
 2883 0022 1438     		subs	r0, r0, #20
 2884              	.LVL300:
 176:RT-Thread/src/ipc.c **** 
 2885              		.loc 1 176 9 is_stmt 0 view .LVU1010
 2886 0024 FFF7FEFF 		bl	rt_thread_resume
 2887              	.LVL301:
 179:RT-Thread/src/ipc.c ****     }
 2888              		.loc 1 179 9 is_stmt 1 view .LVU1011
 2889 0028 2846     		mov	r0, r5
 2890 002a FFF7FEFF 		bl	rt_hw_interrupt_enable
 2891              	.LVL302:
 2892              	.L154:
 161:RT-Thread/src/ipc.c ****     {
 2893              		.loc 1 161 11 view .LVU1012
 2894              	.LBB205:
 2895              	.LBI205:
  98:RT-Thread/include/rtservice.h **** {
 2896              		.loc 2 98 15 view .LVU1013
 2897              	.LBB206:
 2898              		.loc 2 100 5 view .LVU1014
 2899              		.loc 2 100 13 is_stmt 0 view .LVU1015
 2900 002e 3368     		ldr	r3, [r6]
 2901              	.LVL303:
 2902              		.loc 2 100 13 view .LVU1016
 2903              	.LBE206:
 2904              	.LBE205:
 161:RT-Thread/src/ipc.c ****     {
 2905              		.loc 1 161 11 view .LVU1017
 2906 0030 9E42     		cmp	r6, r3
 2907 0032 EFD1     		bne	.L155
ARM GAS  C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s 			page 85


 182:RT-Thread/src/ipc.c **** }
 2908              		.loc 1 182 5 is_stmt 1 view .LVU1018
 2909              	.LVL304:
 182:RT-Thread/src/ipc.c **** }
 2910              		.loc 1 182 5 is_stmt 0 view .LVU1019
 2911              	.LBE204:
 2912              	.LBE203:
1262:RT-Thread/src/ipc.c **** 
1263:RT-Thread/src/ipc.c ****         /* init event set */
1264:RT-Thread/src/ipc.c ****         event->set = 0;
 2913              		.loc 1 1264 9 is_stmt 1 view .LVU1020
 2914              		.loc 1 1264 20 is_stmt 0 view .LVU1021
 2915 0034 0025     		movs	r5, #0
 2916 0036 E561     		str	r5, [r4, #28]
1265:RT-Thread/src/ipc.c **** 
1266:RT-Thread/src/ipc.c ****         /* enable interrupt */
1267:RT-Thread/src/ipc.c ****         rt_hw_interrupt_enable(level);
 2917              		.loc 1 1267 9 is_stmt 1 view .LVU1022
 2918 0038 3846     		mov	r0, r7
 2919 003a FFF7FEFF 		bl	rt_hw_interrupt_enable
 2920              	.LVL305:
1268:RT-Thread/src/ipc.c **** 
1269:RT-Thread/src/ipc.c ****         rt_schedule();
 2921              		.loc 1 1269 9 view .LVU1023
 2922 003e FFF7FEFF 		bl	rt_schedule
 2923              	.LVL306:
1270:RT-Thread/src/ipc.c **** 
1271:RT-Thread/src/ipc.c ****         return RT_EOK;
 2924              		.loc 1 1271 9 view .LVU1024
 2925              		.loc 1 1271 16 is_stmt 0 view .LVU1025
 2926 0042 2846     		mov	r0, r5
1272:RT-Thread/src/ipc.c ****     }
1273:RT-Thread/src/ipc.c **** 
1274:RT-Thread/src/ipc.c ****     return -RT_ERROR;
1275:RT-Thread/src/ipc.c **** }
 2927              		.loc 1 1275 1 view .LVU1026
 2928 0044 F8BD     		pop	{r3, r4, r5, r6, r7, pc}
 2929              	.LVL307:
 2930              	.L156:
 2931              	.LCFI31:
 2932              		.cfi_def_cfa_offset 0
 2933              		.cfi_restore 3
 2934              		.cfi_restore 4
 2935              		.cfi_restore 5
 2936              		.cfi_restore 6
 2937              		.cfi_restore 7
 2938              		.cfi_restore 14
1274:RT-Thread/src/ipc.c **** }
 2939              		.loc 1 1274 12 view .LVU1027
 2940 0046 4FF0FF30 		mov	r0, #-1
 2941              	.LVL308:
 2942              		.loc 1 1275 1 view .LVU1028
 2943 004a 7047     		bx	lr
 2944              		.cfi_endproc
 2945              	.LFE40:
 2947              		.text
 2948              	.Letext0:
ARM GAS  C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s 			page 86


 2949              		.file 3 "RT-Thread/include/rtdef.h"
 2950              		.file 4 "RT-Thread/include/rthw.h"
 2951              		.file 5 "RT-Thread/include/rtthread.h"
ARM GAS  C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s 			page 87


DEFINED SYMBOLS
                            *ABS*:00000000 ipc.c
C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s:16     .text.rt_sem_init:00000000 $t
C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s:24     .text.rt_sem_init:00000000 rt_sem_init
C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s:95     .text.rt_sem_detach:00000000 $t
C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s:102    .text.rt_sem_detach:00000000 rt_sem_detach
C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s:191    .text.rt_sem_create:00000000 $t
C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s:198    .text.rt_sem_create:00000000 rt_sem_create
C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s:276    .text.rt_sem_delete:00000000 $t
C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s:283    .text.rt_sem_delete:00000000 rt_sem_delete
C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s:373    .text.rt_sem_take:00000000 $t
C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s:380    .text.rt_sem_take:00000000 rt_sem_take
C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s:658    .text.rt_sem_trytake:00000000 $t
C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s:665    .text.rt_sem_trytake:00000000 rt_sem_trytake
C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s:689    .text.rt_sem_release:00000000 $t
C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s:696    .text.rt_sem_release:00000000 rt_sem_release
C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s:804    .text.rt_sem_control:00000000 $t
C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s:811    .text.rt_sem_control:00000000 rt_sem_control
C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s:942    .text.rt_mutex_init:00000000 $t
C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s:949    .text.rt_mutex_init:00000000 rt_mutex_init
C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s:1027   .text.rt_mutex_detach:00000000 $t
C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s:1034   .text.rt_mutex_detach:00000000 rt_mutex_detach
C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s:1123   .text.rt_mutex_create:00000000 $t
C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s:1130   .text.rt_mutex_create:00000000 rt_mutex_create
C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s:1215   .text.rt_mutex_delete:00000000 $t
C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s:1222   .text.rt_mutex_delete:00000000 rt_mutex_delete
C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s:1312   .text.rt_mutex_take:00000000 $t
C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s:1319   .text.rt_mutex_take:00000000 rt_mutex_take
C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s:1666   .text.rt_mutex_release:00000000 $t
C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s:1673   .text.rt_mutex_release:00000000 rt_mutex_release
C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s:1871   .text.rt_mutex_control:00000000 $t
C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s:1878   .text.rt_mutex_control:00000000 rt_mutex_control
C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s:1898   .text.rt_event_init:00000000 $t
C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s:1905   .text.rt_event_init:00000000 rt_event_init
C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s:1973   .text.rt_event_detach:00000000 $t
C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s:1980   .text.rt_event_detach:00000000 rt_event_detach
C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s:2069   .text.rt_event_create:00000000 $t
C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s:2076   .text.rt_event_create:00000000 rt_event_create
C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s:2150   .text.rt_event_delete:00000000 $t
C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s:2157   .text.rt_event_delete:00000000 rt_event_delete
C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s:2247   .text.rt_event_send:00000000 $t
C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s:2254   .text.rt_event_send:00000000 rt_event_send
C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s:2455   .text.rt_event_recv:00000000 $t
C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s:2462   .text.rt_event_recv:00000000 rt_event_recv
C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s:2815   .text.rt_event_control:00000000 $t
C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s:2822   .text.rt_event_control:00000000 rt_event_control

UNDEFINED SYMBOLS
rt_object_init
rt_hw_interrupt_disable
rt_thread_resume
rt_hw_interrupt_enable
rt_object_detach
rt_object_allocate
rt_object_delete
rt_thread_self
rt_thread_suspend
ARM GAS  C:\Users\yzy\AppData\Local\Temp\ccG5I4LC.s 			page 88


rt_schedule
rt_timer_control
rt_timer_start
rt_thread_control
